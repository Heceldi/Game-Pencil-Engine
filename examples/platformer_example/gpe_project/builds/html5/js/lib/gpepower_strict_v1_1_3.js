var GPE_LAYER_TYPE_TILES=0,GPE_LAYER_TYPE_BACKGROUND=1,GPE_LAYER_TYPE_OBJECTS=2,GPE_LAYER_TYPE_MAX=2,GPE_DRAW_OBJECT_BOXES=!1,PI=Math.PI,pi=PI,pie=PI,degreesMultiple=-180/PI,radiansMultiple=-PI/180,fa_left=0,fa_center=1,fa_right=2,fa_top=0,fa_middle=1,fa_bottom=2,GPE_TO_RADIANS=Math.PI/180,IS_NULL=-1,isnull=-1,gpe=IS_NULL,GPE=IS_NULL,GPR=IS_NULL,newestFileData=IS_NULL,game=game||{},nwft=nwft||{},preloadedImageSRC=[],preloadedImages=[],GPE_AAC=0,GPE_MP3=1,GPE_OGG=2,GPE_WAV=3,GPE_SUPPORTED_AUDIO_FORMAT_COUNT=
4,GPE_MP4=0,GPE_WEBM=1,GPE_VIDEO_OGG=2,GPE_SUPPORTED_VIDEO_FORMAT_COUNT=3,GPE_EOT=0,GPE_TTF=1,GPE_SVG=2,GPE_WOFF=3,GPE_WOFF2=4,GPE_SUPPORTED_FONT_FORMAT_COUNT=5,GPE_AUDIO_PLAYABLE=[-1,-1,-1,-1],GPE_TempVariable=document.createElement("audio"),GPE_OtherTempVariable=GPE_TempVariable.canPlayType("audio/aac");"probably"==GPE_OtherTempVariable?GPE_AUDIO_PLAYABLE[GPE_AAC]=1:"maybe"==GPE_OtherTempVariable&&(GPE_AUDIO_PLAYABLE[GPE_AAC]=0);GPE_OtherTempVariable=GPE_TempVariable.canPlayType("audio/mpeg");
"probably"==GPE_OtherTempVariable?GPE_AUDIO_PLAYABLE[GPE_MP3]=1:"maybe"==GPE_OtherTempVariable&&(GPE_AUDIO_PLAYABLE[GPE_MP3]=0);GPE_OtherTempVariable=GPE_TempVariable.canPlayType("audio/ogg");"probably"==GPE_OtherTempVariable?GPE_AUDIO_PLAYABLE[GPE_OGG]=1:"maybe"==GPE_OtherTempVariable&&(GPE_AUDIO_PLAYABLE[GPE_OGG]=0);GPE_OtherTempVariable=GPE_TempVariable.canPlayType("audio/wav");
"probably"==GPE_OtherTempVariable?GPE_AUDIO_PLAYABLE[GPE_WAV]=1:"maybe"==GPE_OtherTempVariable&&(GPE_AUDIO_PLAYABLE[GPE_WAV]=0);var GPE_VIDEO_PLAYABLE=[-1,-1,-1,-1];GPE_TempVariable=document.createElement("video");GPE_OtherTempVariable=GPE_TempVariable.canPlayType("video/mp4");"probably"==GPE_OtherTempVariable?GPE_VIDEO_PLAYABLE[GPE_MP4]=1:"maybe"==GPE_OtherTempVariable&&(GPE_VIDEO_PLAYABLE[GPE_MP4]=0);GPE_OtherTempVariable=GPE_TempVariable.canPlayType("video/webm");
"probably"==GPE_OtherTempVariable?GPE_VIDEO_PLAYABLE[GPE_WEBM]=1:"maybe"==GPE_OtherTempVariable&&(GPE_VIDEO_PLAYABLE[GPE_WEBM]=0);GPE_OtherTempVariable=GPE_TempVariable.canPlayType("video/ogg");"probably"==GPE_OtherTempVariable?GPE_VIDEO_PLAYABLE[GPE_VIDEO_OGG]=1:"maybe"==GPE_OtherTempVariable&&(GPE_VIDEO_PLAYABLE[GPE_VIDEO_OGG]=0);var GPE_AUD_TYPE_NAME=["video/mp4","video/webm","video/ogg"];GPE_TempVariable=IS_NULL;var GPE_MASTER_COLLISION_LIST=[],GAMEPAD_SUPPORTED=!1;
navigator.getGamepads&&(GAMEPAD_SUPPORTED=!0);var inheritsFrom=function(w,x){w.prototype=Object.create(x.prototype)};function addSourceToVideo(w,x,D){var A=document.createElement("source");A.src=x;A.type=D;w.appendChild(A)}
var gc_anycontroller=-1,gc_nocontroller=-1,gc_nobutton=-1,gc_anybutton=-2,gc_joystick_left_x=0,gc_joystick_left_y=1,gc_joystick_right_x=2,gc_joystick_right_y=3,gc_joystick_dpad_x=4,gc_joystick_dpad_y=5,gc_left=0,gc_right=1,gc_up=2,gc_down=3,gc_but0=4,gc_but1=5,gc_but2=6,gc_but3=7,gc_l1=8,gc_l2=9,gc_l3=10,gc_r1=11,gc_r2=12,gc_r3=13,gc_start=14,gc_select=15,gc_home=16,gc_share=17,mb_left=0,mb_right=1,mb_middle=2,mb_center=2,kb_nokey=-1,kb_anykey=-2,kb_backspace=8,kb_tab=9,kb_enter=13,kb_pause=19,kb_caps=
20,kb_esc=27,kb_space=32,kb_page_up=33,kb_page_down=34,kb_end=35,kb_home=36,kb_left=37,kb_up=38,kb_right=39,kb_down=40,kb_insert=45,kb_delete=46,kb_0=48,kb_1=49,kb_2=50,kb_3=51,kb_4=52,kb_5=53,kb_6=54,kb_7=55,kb_8=56,kb_9=57,kb_a=65,kb_b=66,kb_c=67,kb_d=68,kb_e=69,kb_f=70,kb_g=71,kb_h=72,kb_i=73,kb_j=74,kb_k=75,kb_l=76,kb_m=77,kb_n=78,kb_o=79,kb_p=80,kb_q=81,kb_r=82,kb_s=83,kb_t=84,kb_u=85,kb_v=86,kb_w=87,kb_x=88,kb_y=89,kb_z=90,kb_np0=96,kb_np1=97,kb_np2=98,kb_np3=99,kb_np4=100,kb_np5=101,kb_np6=
102,kb_np7=103,kb_np8=104,kb_np9=105,kb_multiply=106,kb_add=107,kb_substract=109,kb_decimal=110,kb_divide=111,kb_f1=112,kb_f2=113,kb_f3=114,kb_f4=115,kb_f5=116,kb_f6=117,kb_f7=118,kb_f8=119,kb_f9=120,kb_f10=121,kb_f11=122,kb_f12=123,kb_shift=16,kb_ctrl=17,kb_alt=18,kb_plus=187,kb_comma=188,kb_minus=189,kb_period=190,kb_fslash=191,kb_gaccent=192,kb_obracket=220,kb_bslash=220,kb_cbracket=221,kb_squote=222,gp_nokey=-1,gp_anykey=-2,gp_backspace=8,gp_tab=9,gp_enter=13,gp_pause=19,gp_caps=20,gp_esc=27,
gp_space=32,gp_page_up=33,gp_page_down=34,gp_end=35,gp_home=36,gp_left=37,gp_up=38,gp_right=39,gp_down=40,gp_insert=45,gp_delete=46,gp_0=48,gp_1=49,gp_2=50,gp_3=51,gp_4=52,gp_5=53,gp_6=54,gp_7=55,gp_8=56,gp_9=57,gp_a=65,gp_b=66,gp_c=67,gp_d=68,gp_e=69,gp_f=70,gp_g=71,gp_h=72,gp_i=73,gp_j=74,gp_k=75,gp_l=76,gp_m=77,gp_n=78,gp_o=79,gp_p=80,gp_q=81,gp_r=82,gp_s=83,gp_t=84,gp_u=85,gp_v=86,gp_w=87,gp_x=88,gp_y=89,gp_z=90,gp_np0=96,gp_np1=97,gp_np2=98,gp_np3=99,gp_np4=100,gp_np5=101,gp_np6=102,gp_np7=103,
gp_np8=104,gp_np9=105,gp_multiply=106,gp_add=107,gp_substract=109,gp_decimal=110,gp_divide=111,gp_f1=112,gp_f2=113,gp_f3=114,gp_f4=115,gp_f5=116,gp_f6=117,gp_f7=118,gp_f8=119,gp_f9=120,gp_f10=121,gp_f11=122,gp_f12=123,gp_shift=16,gp_ctrl=17,gp_alt=18,gp_plus=187,gp_comma=188,gp_minus=189,gp_period=190,gp_fslash=191,gp_gaccent=192,gp_obracket=220,gp_bslash=220,gp_cbracket=221,gp_squote=222;
(function(){function w(e){y!=t.STATE_EXIT&&(y=e)}function x(e){return!e.complete||"undefined"!=typeof e.naturalWidth&&0==e.naturalWidth?!1:!0}function D(e){this.dataSource="";this.fileName=e;this.fileLines=[];this.fileType=this.fileLines[0]="";this.fileLinePos=-1;this.fileIsReady=!1;this.is_open=function(){return this.fileIsReady};this.is_good=function(){return this.fileIsReady?this.fileLinePos<this.fileLines.length?!0:!1:IS_NULL};this.get_next_line=function(){return this.fileIsReady?this.fileLinePos<
this.fileLines.length-1?(this.fileLinePos+=1,this.fileLines[this.fileLinePos]):this.fileLinePos+=1:IS_NULL};this.get_line_count=function(){return this.fileIsReady?this.fileLines.length:-1};this.get_line_pos=function(){return this.fileIsReady?this.fileLinePos:-1};this.get_remaining_lines=function(){if(this.fileIsReady)return this.fileLines.length-this.fileLinePos};this.process_file_as_text=function(){for(var a=this.dataSource.split("*nl*"),d=0;d<a.length;d++)this.fileLines[d]=a[d];this.fileIsReady=
!0};this.close_file=function(){this.fileIsReady}}function A(){this.frLoadedFiles=[];this.osFileReader=-1;this.fileObbj;this.lastFileOpened="";this.frFileCount=0;this.recognize_new_file=function(e){""!=this.lastFileOpened&&(this.frLoadedFiles[this.frFileCount]=e,e.process_file_as_text());this.lastFileOpened="";this.frFileCount+=1};this.open_file=function(e,a){if(""!=e&&3<e.length){newestFileData=new D(e,a);this.lastFileOpened=e;var d=document.createElement("script");d.type="text/javascript";d.src=
e||null;d.innerHTML=d.src||null;document.getElementsByTagName("head")[0].appendChild(d);return newestFileData}return IS_NULL};this.open_new_file=function(e,a){};this.open_write_file=function(e,a){}}function H(){this.controllerType=IS_NULL;this.deviceType=this.detectedDeviceType=this.controllerExtension="";this.systemController=IS_NULL;this.isConnected=!1;this.timestamp=this.mapping=0;this.button_count=25;this.axes_count=16;this.touch_mouse_y=this.touch_mouse_x=this.system_axes_count=0;this.prevHit=
[];this.butIsDown=[];this.butIsPressed=[];this.butIsReleased=[];this.butIsLocked=[];this.axesMap=[];this.buttonsMap=[];for(var e=0;e<this.button_count;e++)this.prevHit[e]=!1,this.butIsDown[e]=!1,this.butIsPressed[e]=!1,this.butIsReleased[e]=!1,this.butIsLocked[e]=!1,this.buttonsMap[e]=e;this.axesValues=[];for(e=0;e<this.axes_count;e++)this.axesMap[e]=e,this.axesValues[e]=0;this.map_to_ds4_chrome=function(){this.buttonsMap[gc_left]=14;this.buttonsMap[gc_right]=15;this.buttonsMap[gc_up]=12;this.buttonsMap[gc_down]=
13;this.buttonsMap[gc_but0]=0;this.buttonsMap[gc_but1]=1;this.buttonsMap[gc_but2]=2;this.buttonsMap[gc_but3]=3;this.buttonsMap[gc_l1]=4;this.buttonsMap[gc_l2]=6;this.buttonsMap[gc_l3]=10;this.buttonsMap[gc_r1]=5;this.buttonsMap[gc_r2]=7;this.buttonsMap[gc_r3]=11;this.buttonsMap[gc_home]=16;this.buttonsMap[gc_select]=9;this.buttonsMap[gc_share]=8;this.buttonsMap[gc_start]=17;this.axesMap[gc_joystick_left_x]=0;this.axesMap[gc_joystick_left_y]=1};this.map_to_ds4_firefox=function(){this.buttonsMap[gc_left]=
14;this.buttonsMap[gc_right]=15;this.buttonsMap[gc_up]=12;this.buttonsMap[gc_down]=13;this.buttonsMap[gc_but0]=1;this.buttonsMap[gc_but1]=2;this.buttonsMap[gc_but2]=0;this.buttonsMap[gc_but3]=3;this.buttonsMap[gc_l1]=4;this.buttonsMap[gc_l2]=6;this.buttonsMap[gc_l3]=10;this.buttonsMap[gc_r1]=5;this.buttonsMap[gc_r2]=7;this.buttonsMap[gc_r3]=11;this.buttonsMap[gc_home]=16;this.buttonsMap[gc_select]=9;this.buttonsMap[gc_share]=8;this.buttonsMap[gc_start]=17};this.map_to_switchpro_chrome=function(){this.buttonsMap[gc_left]=
14;this.buttonsMap[gc_right]=15;this.buttonsMap[gc_up]=12;this.buttonsMap[gc_down]=13;this.buttonsMap[gc_but0]=1;this.buttonsMap[gc_but1]=0;this.buttonsMap[gc_but2]=3;this.buttonsMap[gc_but3]=2;this.buttonsMap[gc_l1]=4;this.buttonsMap[gc_l2]=6;this.buttonsMap[gc_l3]=10;this.buttonsMap[gc_r1]=5;this.buttonsMap[gc_r2]=7;this.buttonsMap[gc_r3]=11;this.buttonsMap[gc_home]=12;this.buttonsMap[gc_select]=8;this.buttonsMap[gc_share]=13;this.buttonsMap[gc_start]=9};this.map_to_switchpro_firefox=function(){this.buttonsMap[gc_left]=
14;this.buttonsMap[gc_right]=15;this.buttonsMap[gc_up]=12;this.buttonsMap[gc_down]=13;this.buttonsMap[gc_but0]=1;this.buttonsMap[gc_but1]=0;this.buttonsMap[gc_but2]=3;this.buttonsMap[gc_but3]=2;this.buttonsMap[gc_l1]=4;this.buttonsMap[gc_l2]=6;this.buttonsMap[gc_l3]=10;this.buttonsMap[gc_r1]=5;this.buttonsMap[gc_r2]=7;this.buttonsMap[gc_r3]=11;this.buttonsMap[gc_home]=12;this.buttonsMap[gc_select]=8;this.buttonsMap[gc_share]=13;this.buttonsMap[gc_start]=9};this.map_to_ds4_chrome();this.check_connection=
function(){return this.isConnected};this.check_button=function(a){if(this.isConnected){if(0<=a&&a<this.button_count)return 0<this.butIsDown[this.buttonsMap[a]];if(a==gc_anybutton)for(a=this.button_count-1;0<=a;a--){if(0<this.butIsDown[this.buttonsMap[a]])return!0}else if(a==gc_nobutton){for(a=this.button_count-1;0<=a;a--)if(0<this.butIsDown[this.buttonsMap[a]])return!1;return!0}}return!1};this.check_button_pressed=function(a){if(this.isConnected){if(0<=a&&a<this.button_count)return 0<this.butIsPressed[this.buttonsMap[a]];
if(a==gc_anybutton)for(a=this.button_count-1;0<=a;a--){if(0<this.butIsPressed[this.buttonsMap[a]])return!0}else if(a==gc_nobutton){for(a=this.button_count-1;0<=a;a--)if(0<this.butIsPressed[this.buttonsMap[a]])return!1;return!0}}return!1};this.check_button_released=function(a){if(this.isConnected){if(0<=a&&a<this.button_count)return this.butIsReleased[this.buttonsMap[a]];if(a==gc_anybutton)for(a=this.button_count-1;0<=a;a--){if(0<this.butIsReleased[this.buttonsMap[a]])return!0}else if(a==gc_nobutton){for(a=
this.button_count-1;0<=a;a--)if(0<this.butIsReleased[this.buttonsMap[a]])return!1;return!0}}return!1};this.gamepad_get_axes_count=function(){return this.system_axes_count};this.find_gamepad_axes_mapping=function(a){return 0<=a&&a<this.axes_count?this.axesMap[a]:-1};this.find_gamepad_button_mapping=function(a){return 0<=a&&a<this.button_count?this.axesMap[a]:-1};this.gamepad_map_axes=function(a,d){return 0<=a&&a<this.axes_count&&0<=d&&d<this.axes_count?(this.buttonsMap[a]=d,!0):!1};this.gamepad_map_button=
function(a,d){return 0<=a&&a<this.button_count&&0<=d&&d<this.button_count?(this.buttonsMap[a]=d,!0):!1};this.reset_controller=function(){for(var a=0;a<this.button_count;a++)this.butIsPressed[this.buttonsMap[a]]=this.butIsDown[this.buttonsMap[a]]&&!this.prevHit[this.buttonsMap[a]],this.butIsReleased[this.buttonsMap[a]]=!this.butIsDown[this.buttonsMap[a]]&&this.prevHit[this.buttonsMap[a]]};this.pure_reset=function(){for(var a=0;a<this.button_count;a++)this.prevHit[this.buttonsMap[a]]=!1,this.butIsDown[this.buttonsMap[a]]=
!1,this.butIsPressed[this.buttonsMap[a]]=!1,this.butIsReleased[this.buttonsMap[a]]=!1,this.butIsLocked[this.buttonsMap[a]]=!1;for(a=0;a<this.axes_count;a++)this.axesValues[a]=0}}function I(){this.mouse_button_count=3;this.key_count=225;this.joy_key_count=2;this.prevHit=[];this.keyIsDown=[];this.keyIsPressed=[];this.keyIsReleased=[];this.keyIsLocked=[];this.mousePrevHit=[];this.mbIsDown=[];this.mbIsPressed=[];this.mbIsReleased=[];this.mbIsLocked=[];this.asyncKeyIsDown=[];this.asyncKeyIsPressed=[];
this.asyncKeyIsReleased=[];this.asyncKeyIsLocked=[];this.asyncMousePrevHit=[];this.asyncMbIsDown=[];this.asyncMbIsPressed=[];this.asyncMbIsReleased=[];this.asyncMbIsLocked=[];this.game_controllers=[];this.max_controllers=5;for(var e=0;e<this.key_count;e++)this.prevHit[e]=!1,this.keyIsDown[e]=!1,this.keyIsPressed[e]=!1,this.keyIsReleased[e]=!1,this.keyIsLocked[e]=!1,this.asyncKeyIsDown[e]=!1,this.asyncKeyIsPressed[e]=!1,this.asyncKeyIsReleased[e]=!1,this.asyncKeyIsLocked[e]=!1;for(e=0;e<this.mouse_button_count;e++)this.mousePrevHit[e]=
!1,this.mbIsDown[e]=!1,this.mbIsPressed[e]=!1,this.mbIsReleased[e]=!1,this.mbIsLocked[e]=!1,this.asyncMousePrevHit[e]=!1,this.asyncMbIsDown[e]=!1,this.asyncMbIsPressed[e]=!1,this.asyncMbIsReleased[e]=!1,this.asyncMbIsLocked[e]=!1;for(e=0;e<this.max_controllers;e++)this.game_controllers[e]=new H;this.gamepad_connected=function(a){return 0<=a&&a<this.max_controllers?this.game_controllers[a].isConnected:-1};this.gamepad_detected_name=function(a){return 0<=a&&a<this.max_controllers?this.game_controllers[a].detectedDeviceType:
""};this.gamepad_name=function(a){return 0<=a&&a<this.max_controllers?this.game_controllers[a].deviceType:""};this.gamepad_object=function(a){return 0<=a&&a<this.max_controllers?this.game_controllers[a]:IS_NULL};this.gamepad_get_axes_count=function(a){return 0<=a&&a<this.max_controllers?this.game_controllers[a].gamepad_get_axes_count():-1};this.find_gamepad_mapping=function(a,d){return 0<=a&&a<this.max_controllers?this.game_controllers[a].find_gamepad_mapping(a,d):-1};this.check_gamepad=function(a,
d){if(0<=a&&a<this.max_controllers)return this.game_controllers[a].check_button(d);if(a==gc_anycontroller)for(var c=this.game_controllers.length-1;0<=c;c--)if(this.game_controllers[c].check_button(d))return!0;return!1};this.check_gamepad_down=function(a,d){if(0<=a&&a<this.max_controllers)return this.game_controllers[a].check_button(d);if(a==gc_anycontroller)for(var c=this.game_controllers.length-1;0<=c;c--)if(this.game_controllers[c].check_button(d))return!0;return!1};this.check_gamepad_pressed=function(a,
d){if(0<=a&&a<this.max_controllers)return this.game_controllers[a].check_button_pressed(d);if(a==gc_anycontroller)for(var c=this.game_controllers.length-1;0<=c;c--)if(this.game_controllers[c].check_button_pressed(d))return!0;return!1};this.check_gamepad_released=function(a,d){if(0<=a&&a<this.max_controllers)return this.game_controllers[a].check_button_released(d);if(a==gc_anycontroller)for(var c=this.game_controllers.length-1;0<=c;c--)if(this.game_controllers[c].check_button_released(d))return!0;
return!1};this.find_gamepad_axes_mapping=function(a,d){return 0<=a&&a<this.max_controllers?this.game_controllers[a].find_gamepad_axes_mapping(d):IS_NULL};this.find_gamepad_button_mapping=function(a,d){return 0<=a&&a<this.max_controllers?this.game_controllers[a].find_gamepad_mapping(d):IS_NULL};this.gamepad_map_axes=function(a,d,c){if(0<=a&&a<this.max_controllers)return this.game_controllers[a].gamepad_map_axes(d,c);if(a==gc_anycontroller){a=!1;for(var g=this.game_controllers.length-1;0<=g;g--)this.game_controllers[g].gamepad_map_axes(d,
c)&&(a=!0);return a}return!1};this.gamepad_map_button=function(a,d,c){if(0<=a&&a<this.max_controllers)return this.game_controllers[a].gamepad_map_button(d,c);if(a==gc_anycontroller){a=!1;for(var g=this.game_controllers.length-1;0<=g;g--)this.game_controllers[g].gamepad_map_button(d,c)&&(a=!0);return a}return!1};this.check_keyboard_down=function(a){if(0<=a&&a<this.key_count)return this.keyIsDown[a];if(a==gp_anykey)for(a=this.key_count-1;0<=a;a--){if(0<this.keyIsDown[a])return!0}else if(a==gp_nokey){for(a=
this.key_count-1;0<=a;a--)if(0<this.keyIsDown[a])return!1;return!0}return!1};this.check_keyboard_pressed=function(a){if(0<=a&&a<this.key_count)return this.keyIsPressed[a];if(a==gp_anykey)for(a=this.key_count-1;0<=a;a--){if(0<this.keyIsPressed[a])return!0}else if(a==gp_nokey){for(a=this.key_count-1;0<=a;a--)if(0<this.keyIsPressed[a])return!1;return!0}return!1};this.check_keyboard_released=function(a){if(0<=a&&a<this.key_count)return this.keyIsReleased[a];if(a==gp_anykey)for(a=this.key_count-1;0<=a;a--){if(0<
this.keyIsReleased[a])return!0}else if(a==gp_nokey){for(a=this.key_count-1;0<=a;a--)if(0<this.keyIsReleased[a])return!1;return!0}return!1};this.check_mouse_down=function(a){return 0<=a&&a<this.mouse_button_count?this.mbIsDown[a]:!1};this.check_mouse_pressed=function(a){return 0<=a&&a<this.mouse_button_count?this.mbIsPressed[a]:!1};this.check_mouse_released=function(a){return 0<=a&&a<this.mouse_button_count?this.mbIsReleased[a]:!1};this.get_controller=function(a){for(var d=0,c=IS_NULL,g=0;g<this.max_controllers&&
!(c=this.game_controllers[g],c.isConnected&&d++,d>=a);g++);return c};this.reset_input=function(){var a;for(a=0;a<this.key_count;a++)this.keyIsPressed[a]=this.keyIsDown[a]&&!this.prevHit[a],this.keyIsReleased[a]=!this.keyIsDown[a]&&this.prevHit[a];for(a=0;a<this.mouse_button_count;a++)this.mbIsPressed[a]=this.mbIsDown[a]&&!this.mousePrevHit[a],this.mbIsReleased[a]=!this.mbIsDown[a]&&this.mousePrevHit[a];for(var d=0;d<this.max_controllers;d++)a=this.game_controllers[d],a.reset_controller();for(a=0;a<
this.key_count;a++)this.prevHit[a]=this.keyIsDown[a];for(a=0;a<this.mouse_button_count;a++)this.mousePrevHit[a]=this.mbIsDown[a]};this.handle_key_down=function(a){"undefined"==typeof a&&(a=window.event);var d=parseInt(a.keyCode?a.keyCode:a.which);d<this.key_count&&(d<gp_np0&&a.preventDefault(),this.asyncKeyIsPressed[d]=!0,this.asyncKeyIsDown[d]=!0,this.asyncKeyIsReleased[d]=!1)};this.handle_key_press=function(a){"undefined"==typeof a&&(a=window.event);var d=parseInt(a.keyCode?a.keyCode:a.which);33<
d&&(d-=32);d<this.key_count&&(d<gp_np0&&a.preventDefault(),this.asyncKeyIsPressed[d]=!0,this.asyncKeyIsDown[d]=!0,this.asyncKeyIsReleased[d]=!1)};this.handle_key_up=function(a){"undefined"==typeof a&&(a=window.event);var d=parseInt(a.which);d<this.key_count&&(d<gp_np0&&a.preventDefault(),this.asyncKeyIsPressed[d]=!1,this.asyncKeyIsDown[d]=!1,this.asyncKeyIsReleased[d]=!0)};this.handle_mouse_press=function(a){"undefined"==typeof a&&(a=window.event);a=a.button;a<this.mouse_button_count&&(this.asyncMbIsPressed[a]=
!0,this.asyncMbIsDown[a]=!0,this.asyncMbIsReleased[a]=!1)};this.handle_mouse_up=function(a){"undefined"==typeof a&&(a=window.event);a=a.button;a<this.mouse_button_count&&(this.asyncMbIsPressed[a]=!1,this.asyncMbIsDown[a]=!1,this.asyncMbIsReleased[a]=!0)};this.process_input=function(){var a;for(a=this.key_count-1;0<=a;a--)this.keyIsPressed[a]=this.asyncKeyIsPressed[a],this.keyIsDown[a]=this.asyncKeyIsDown[a],this.keyIsReleased[a]=this.asyncKeyIsReleased[a],this.asyncKeyIsPressed[a]=!1,this.asyncKeyIsReleased[a]=
!1;for(a=this.mouse_button_count-1;0<=a;a--)this.mbIsPressed[a]=this.asyncMbIsPressed[a],this.mbIsReleased[a]=this.asyncMbIsReleased[a],this.asyncMbIsPressed[a]=!1,this.asyncMbIsDown[a]=!1,this.asyncMbIsReleased[a]=!1;var d;if(GAMEPAD_SUPPORTED){a=navigator.getGamepads();for(var c,g,b=0,f=0;f<this.max_controllers&&f<a.length;f++)if(g=a[f],null!=g){c=this.game_controllers[b];if(g.connected){c.deviceType=g.id;c.system_axes_count=g.axes.length;c.isConnected||(console.log("{"+c.deviceType+"} for controller["+
f+"] connected..."),console.log("Controller detected with "+c.system_axes_count+" axes..."),c.pure_reset(),"Wireless Controller (STANDARD GAMEPAD Vendor: 054c Product: 09cc)"==c.deviceType?(c.map_to_ds4_chrome(),c.detectedDeviceType="DullShock4"):"054c-09cc-Wireless Controller"==c.deviceType&&(c.map_to_ds4_firefox(),c.detectedDeviceType="DullShock4"),"Wireless Gamepad (Vendor: 057e Product: 2009)"==c.deviceType?(c.map_to_switchpro_chrome(),c.detectedDeviceType="SwitchPro"):" 057e-2009-Wireless Gamepad"==
c.deviceType&&(c.map_to_switchpro_firefox(),c.detectedDeviceType="SwitchPro"),"Mayflash WiiU Pro Game Controller Adapter (Vendor: 0079 Product: 1800)"==c.deviceType?(c.map_to_wiiupro_mayflash_chrome(),c.detectedDeviceType="WIiUPro_MayFlash"):" 0079-1800-Mayflash WiiU Pro Game Controller Adapter"==c.deviceType&&(c.map_to_wiiupro_mayflash_firefox(),c.detectedDeviceType="WIiUPro_MayFlash"));c.isConnected=!0;c.systemController=g;c.mapping=g.mapping;c.timestamp=g.timestamp;for(d=0;d<c.axes_count&&d<g.axes.length;d++)c.axesValues[d]=
g.axes[d];for(d=0;d<c.button_count&&d<g.buttons.length;d++){var k=c.buttonsMap[d];0<=k&&k<c.button_count&&k<g.buttons.length&&(c.butIsDown[k]=c.butIsPressed[k]=g.buttons[k].pressed,g.buttons[k].pressed&&(c.butIsDown[k]=c.butIsPressed[k]=!0))}}else c.isConnected&&console.log("{"+c.deviceType+"} for controller["+f+"] disconnected..."),c.pure_reset(),c.foundController.systemController=null,c.isConnected=!1,c.deviceType="disconnected",c.mapping="disconnected",c.timestamp=0;b++}}}}function F(){this.stateName=
"LogoDisplay";this.logoImg=new Image;this.logoImg.src=GPE_SETTINGS_APP_LOGO_LOCATION;this.audioPlayed=!1;this.displayedTimes=0;this.maxTilExit=90;this.apply_logic=function(){gpe.check_image_loading_status(this.logoImg)&&(this.displayedTimes+=1,this.displayedTimes>=this.maxTilExit&&w(t.STATE_LOAD_RESOURCES))};this.render_state=function(){if("undefined"!=typeof gpe.context&&(gpe.context.fillStyle="#CCCCCC",gpe.context.fillRect(0,0,gpe.canvas.width,gpe.canvas.height),x(this.logoImg))){var e=0,a=gpe.canvas.width,
d=gpe.canvas.height,c=0;this.logoImg.width<gpe.canvas.width&&(a=this.logoImg.width,e=(gpe.canvas.width-a)/2);this.logoImg.height<gpe.canvas.height&&(d=this.logoImg.height,c=(gpe.canvas.height-d)/2);gpe.context.drawImage(this.logoImg,e,c,a,d);this.displayedTimes>=this.maxTilExit&&w(t.STATE_LOAD_RESOURCES)}}}function J(){this.sceneHeight=this.sceneWidth=0;this.stateName="MainGame";this.currentScene=gpe.gpeScenes[0];this.currentSceneId=0;this.pastSceneId=-1;this.pastSceneName="";this.sceneWasReset=!1;
gpe.play_audio(this.currentScene.startAudio,!1);gpe.loop_audio(this.currentScene.bgMusic);this.sceneToEnter=0;this.currentScene.update_tilemap();this.MOUSE_CAM_X=[];this.MOUSE_CAM_Y=[];this.MOUSE_IN_CAM=[];for(var e=0;e<this.maxCameras;e++)this.MOUSE_CAM_X[e]=0,this.MOUSE_CAM_Y[e]=0,this.MOUSE_IN_CAM[e]=!0;this.GAME_OBJECTS=[];this.GAME_OBJECTS_TO_BE_DESTROYED=[];this.GAME_OBJECTS_TO_DELETE_TYPES=[];this.needToDeleteObjects=!1;this.GAME_OBJECTS_CONTINUOUS=[];this.GAME_OBJECTS_FAMILIES=[];this.OBJECT_COUNT=
0;this.MAIN_GAME_CODE_IS_READ=!1;this.collisionSpacesInView=[];this.spatialGridIsCreated=!1;this.spatialMapHeightSize=this.spatialMapWidthSize=0;this.superDebugCollisions=!1;this.objectCollisionIsChecked={};this.collisionPairA=[];this.collisionPairB=[];this.parsed_objects=this.collisionPairsTotal=0;this.spatialGridHeightAmount=this.spatialGridWidthAmount=2;this.spatialCollisionChecks=this.objectCollisionHashesChecked=0;this.spatialGridIsCreated=!1;this.spatialMapHeightSize=this.spatialMapWidthSize=
-1;this.set_default_grid_size=function(){this.spatialGridHeightSize=this.spatialGridWidthSize=this.spatialGridBoxSize=128};this.set_default_grid_size();this.add_collision_pair=function(c,a){this.collisionPairA[this.collisionPairsTotal]=c;this.collisionPairB[this.collisionPairsTotal]=a;this.collisionPairsTotal+=1};this.add_object_to_deletion_list=function(c){if("undefined"!=typeof c&&-1!=c&&0<=c.gpeObjectType){if(this.GAME_OBJECTS_TO_BE_DESTROYED.length>c.gpeObjectType)this.GAME_OBJECTS_TO_BE_DESTROYED[c.gpeObjectType].push_back(c);
else{for(var a,b=this.GAME_OBJECTS_TO_BE_DESTROYED.length;b<=c.gpeObjectType;b++)a=[],this.GAME_OBJECTS_TO_BE_DESTROYED.push(a);this.GAME_OBJECTS_TO_BE_DESTROYED[this.GAME_OBJECTS_TO_BE_DESTROYED.length-1].push_back(c)}this.GAME_OBJECTS_TO_DELETE_TYPES.push(c.gpeObjectType);this.needToDeleteObjects=!0}};this.add_to_continuous_objects=function(c){if(-1!=c){for(var a=this.GAME_OBJECTS_CONTINUOUS.length-1;0<=a;a--)if(this.GAME_OBJECTS_CONTINUOUS[a].gpeUniqGameObjectId==c.gpeUniqGameObjectId)return!1;
this.GAME_OBJECTS_CONTINUOUS.push(c);this.add_object_to_deletion_list(c);return!0}return!1};this.add_object=function(c,a,b){"number"!=typeof b&&(b=1);a&&(b=c.sceneLayerStartPos);if("undefined"!=typeof c&&-1!=c&&0<=b&&32>b)if(0<=c.gpeObjectType&&-1!=this.currentScene){var f=this.currentScene.get_layer(b,GPE_LAYER_TYPE_OBJECTS);if(-1!=f){if(this.GAME_OBJECTS.length>c.gpeObjectType)b=this.GAME_OBJECTS[c.gpeObjectType],b.push(c),this.GAME_OBJECTS[c.gpeObjectType]=b;else{for(var k=this.GAME_OBJECTS.length;k<=
c.gpeObjectType;k++)b=[],this.GAME_OBJECTS.push_back(b);b=this.GAME_OBJECTS[this.GAME_OBJECTS.length-1];b.push(c)}-1==c.gpeUniqGameObjectId&&(this.OBJECT_COUNT+=1,c.gpeUniqGameObjectId=this.OBJECT_COUNT);c.isInit=!0;c.gpeSceneStartCodeUsed=!1;for(k=0;k<gpe.maxCameras;k++)c.isInView[k]=!0;1==c.isViewIndependent&&(f.independentObjects.push(c),c.indepedentCameraPos=f.independentObjects.length-1);f.layerObjects.push(c);a||(c.gpeSceneStartId=this.currentSceneId);this.update_object_in_map(c);c.GPE_AddedToGridSystem=
!0;this.sceneIsSpatiallyPartitioned=!1}else console.log("Unable to obtain layer from current scene with id: ["+b+"].")}else console.log("Unable to add object of type ["+c.gpeObjectType+"].");else console.log("Undefined object added...")};this.apply_game_collisions=function(){for(var c,a,b=this.collisionPairsTotal-1;0<=b;b--)c=this.collisionPairA[b],a=this.collisionPairB[b],c.collide_with(a),a.collide_with(c)};this.apply_spatial_game_objects_prelogics=function(){for(var c,a,b,f,k,h=this.currentScene.sceneLayers.length-
1;0<=h;h--){k=this.currentScene.sceneLayers[h];for(f=k.independentObjects.length-1;0<=f;f--)b=k.independentObjects[f],0==b.gpePrelogicAppliedInFrame&&b.isInit&&!b.gpeIsBeingDestroyed&&(b.perform_object_prelogic(),b.gpeHasStartLogicFunction&&b.start_frame_logic(),b.gpeHasTimedFunctions&&b.process_timed_functions(),b.process_gpe_movement(),b.gpePrelogicAppliedInFrame=!0);for(f=this.collisionSpacesInView.length-1;0<=f;f--)if(b=this.collisionSpacesInView[f],0<=b&&b<k.COLLISION_AREA_SPACES.size())for(a=
k.COLLISION_AREA_SPACES.at(b),c=a.internalArray.length-1;0<=c;c--)b=a.internalArray[c],0==b.isViewIndependent&&0==b.gpePrelogicAppliedInFrame&&b.isInit&&!b.gpeIsBeingDestroyed&&(b.perform_object_prelogic(),b.gpeHasStartLogicFunction&&b.start_frame_logic(),b.gpeHasTimedFunctions&&b.process_timed_functions(),b.process_gpe_movement(),b.gpePrelogicAppliedInFrame=!0);for(f=k.COLLISION_AREA_OUTSIDE_SCENE.internalArray.length-1;0<=f;f--)b=k.COLLISION_AREA_OUTSIDE_SCENE.internalArray[f],0==b.isViewIndependent&&
0==b.gpePrelogicAppliedInFrame&&b.isInit&&!b.gpeIsBeingDestroyed&&(b.perform_object_prelogic(),b.gpeHasStartLogicFunction&&b.start_frame_logic(),b.gpeHasTimedFunctions&&b.process_timed_functions(),b.process_gpe_movement(),b.gpePrelogicAppliedInFrame=!0)}};this.apply_spatial_game_objects_logics=function(){for(var c,a,b,f,k=this.currentScene.sceneLayers.length-1;0<=k;k--){f=this.currentScene.sceneLayers[k];for(c=f.independentObjects.length-1;0<=c;c--)b=f.independentObjects[c],b.isInit&&0==b.gpeLogicAppliedInFrame&&
0==b.gpeIsBeingDestroyed&&(0!=b.imageSpeed&&b.update_animation(),b.gpeHasLogicFunction&&b.perform_object_logic(),b.gpeLogicAppliedInFrame=!0);for(c=f.COLLISION_AREA_OUTSIDE_SCENE.internalArray.length-1;0<=c;c--)b=f.COLLISION_AREA_OUTSIDE_SCENE.internalArray[c],0==b.isViewIndependent&&b.isInit&&0==b.gpeLogicAppliedInFrame&&0==b.gpeIsBeingDestroyed&&(0!=b.imageSpeed&&b.update_animation(),b.perform_object_logic(),b.gpeLogicAppliedInFrame=!0);for(var h=this.collisionSpacesInView.length-1;0<=h;h--)for(a=
f.COLLISION_AREA_SPACES.at(this.collisionSpacesInView[h]),c=a.objectsHeld-1;0<=c;c--)b=a.internalArray[c],0==b.isViewIndependent&&b.isInit&&0==b.gpeLogicAppliedInFrame&&0==b.gpeIsBeingDestroyed&&(0!=b.imageSpeed&&b.update_animation(),b.gpeHasLogicFunction&&b.perform_object_logic(),b.gpeLogicAppliedInFrame=!0)}};this.apply_logic=function(){if(-1!=this.currentScene)for(var c=0;c<gpe.maxCameras;c++){var a=this.currentScene.sceneCamera[c];if(1==a.isVisible){var b=gpe.masterScaleY;this.MOUSE_CAM_X[c]=
gpe.MOUSE_SCALED_X+a.cameraRect.xPos-gpe.masterScaleX*a.renderRect.xPos|0;this.MOUSE_CAM_Y[c]=gpe.MOUSE_SCALED_Y+a.cameraRect.yPos-b*a.renderRect.yPos|0;0<this.MOUSE_CAM_X[c]&&0<=this.MOUSE_CAM_Y[c]?this.MOUSE_IN_CAM[c]=!0:(this.MOUSE_CAM_X[c]=0,this.MOUSE_CAM_Y[c]=0,this.MOUSE_IN_CAM[c]=!1)}else this.MOUSE_CAM_X[c]=0,this.MOUSE_CAM_Y[c]=0,this.MOUSE_IN_CAM[c]=!1}0==this.GAME_OBJECTS_FAMILIES.length&&GPE.activate_object_families();this.process_scene_movement();if(-1!=this.currentScene&&(1!=this.currentScene.sceneHasBeenActivated&&
(this.begin_spatialpartioning(this.currentScene.sceneWidth,this.currentScene.sceneHeight),this.currentScene.scene_init(),this.sceneWidth=this.currentScene.sceneWidth,this.sceneHeight=this.currentScene.sceneHeight),this.currentScene.process_scene(),this.currentScene.sceneIsProcessed&&this.currentScene.sceneResourcesAreProcessed)){this.delete_selected_objects();this.calculate_camera_spacing();this.prepare_game_frame();this.apply_spatial_game_objects_prelogics();var f,k,h;for(k=this.currentScene.sceneLayers.length-
1;0<=k;k--){var d=this.currentScene.sceneLayers[k];if(1==Game_SelfCollideLayerList[d.layerId]){for(f=this.collisionSpacesInView.length-1;0<=f;f--){var e=this.collisionSpacesInView[f];0<=e&&e<d.COLLISION_AREA_SPACES.size()&&(c=d.COLLISION_AREA_SPACES.at(e),this.find_collisions_of_spatialpartion(c))}this.find_collisions_of_spatialpartion(d.COLLISION_AREA_OUTSIDE_SCENE)}a=Game_LayerMatrix[d.layerId];for(b=a.length-1;0<=b;b--){var m=a[b];for(h=k-1;0<=h;h--){var l=this.currentScene.sceneLayers[h];if(l.layerId==
m){for(f=this.collisionSpacesInView.length-1;0<=f;f--)e=this.collisionSpacesInView[f],0<=e&&e<l.COLLISION_AREA_SPACES.size()&&(c=d.COLLISION_AREA_SPACES.at(e),e=l.COLLISION_AREA_SPACES.at(e),this.find_collisions_of_two_spatialpartions(c,e));this.find_collisions_of_two_spatialpartions(d.COLLISION_AREA_OUTSIDE_SCENE,l.COLLISION_AREA_OUTSIDE_SCENE)}}}}this.apply_game_collisions();this.apply_spatial_game_objects_logics();this.delete_selected_objects()}};this.calculate_camera_spacing=function(){this.collisionSpacesInView=
[];var c,a,b;if(this.currentScene.sceneIsProcessed&&this.currentScene.sceneResourcesAreProcessed){var f=IS_NULL;for(c=0;c<this.currentScene.sceneLayers.length;c++){var k=this.currentScene.sceneLayers[c];if(0<k.COLLISION_AREA_SPACES.length){f=k;break}}if(f!=IS_NULL)for(c=0;c<gpe.maxCameras;c++)if(k=this.currentScene.sceneCamera[c],1==k.isVisible){var h=k.cameraRect.x2Pos+this.spatialGridWidthSize;var d=k.cameraRect.y2Pos+this.spatialGridHeightSize;for(a=k.cameraRect.xPos;a<=h;a+=this.spatialGridWidthSize)for(b=
k.cameraRect.yPos;b<=d;b+=this.spatialGridHeightSize){var e=(a/this.spatialGridWidthSize|0)*this.spatialGridHeightAmount;e+=b/this.spatialGridHeightSize|0;0<=e&&e<f.COLLISION_AREA_SPACES.length&&this.collisionSpacesInView.push(e)}}}this.collisionSpacesInView=gpe.make_array_unique(this.collisionSpacesInView)};this.camera_on=function(c){return-1!=this.currentScene&&0<=c&&c<gpe.maxCameras?this.currentScene.sceneCamera[c].isVisible:IS_NULL};this.center_camera=function(c,a,b){-1!=this.currentScene&&0<=
c&&c<gpe.maxCameras&&this.currentScene.sceneCamera[c].center_camera(a,b)};this.check_collision_rect=function(c,a){var b=c.xPos,f=c.xPos+c.rectWidth,k=c.yPos,h=a.xPos,d=a.xPos+a.rectWidth,g=a.yPos+a.rectHeight;return!(c.yPos+c.rectHeight<a.yPos||k>g||f<h||b>d)};this.check_collision_with_rect=function(c,a,b,f,k){var h=new u;h.update_shape(c,a,b,f);return this.check_collision_rect(k,h)};this.disable_camera=function(c){-1!=this.currentScene&&this.currentScene.disable_camera(c)};this.delete_selected_objects=
function(){if(1==this.needToDeleteObjects){var c=IS_NULL;this.GAME_OBJECTS_TO_DELETE_TYPES=gpe.make_array_unique(this.GAME_OBJECTS_TO_DELETE_TYPES);for(var a=this.GAME_OBJECTS_TO_DELETE_TYPES.length-1;0<=a;a--){var b=this.GAME_OBJECTS_TO_DELETE_TYPES[a];var f=this.GAME_OBJECTS_TO_BE_DESTROYED[b];for(b=f.length-1;0<=b;b--){var k=f[b];var h=!1;for(iCLayers=GPR.currentScene.sceneLayers.length-1;0<=iCLayers;iCLayers--)if(c=GPR.currentScene.sceneLayers[iCLayers],c.layerId==k.sceneLayerPos){h=!0;break}if(h)for(h=
k.SPATIAL_PARTITION_LIST.length-1;0<=h;h--){var d=k.SPATIAL_PARTITION_LIST[h];d<c.COLLISION_AREA_SPACES.length&&0<=d?(d=c.COLLISION_AREA_SPACES[d],d.remove_held_object(k)):c.COLLISION_AREA_OUTSIDE_SCENE.remove_held_object(k)}}}this.GAME_OBJECTS_TO_DELETE_TYPES=[];this.GAME_OBJECTS_TO_BE_DESTROYED=[];this.needToDeleteObjects=!1}};this.enable_camera=function(c){-1!=this.currentScene&&this.currentScene.enable_camera(c)};this.find_collision_rectangle=function(c,a,b,f,k){"number"!=typeof k&&(k=c.sceneLayerPos);
if(-1!=c&&0<=k&&32>k){for(var h=IS_NULL,d=!1,g=GPR.currentScene.sceneLayers.length-1;0<=g;g--)if(h=GPR.currentScene.sceneLayers[g],h.layerId==k){d=!0;break}if(d){k=c.collisionBox.xPos;d=c.collisionBox.yPos;0<=c.spriteId&&c.spriteId<gpe.rsm.rSprites.length?(g=gpe.rsm.rSprites[c.spriteId],c.collisionBox.update_position(a+g.colX,b+g.colY)):c.collisionBox.update_position(a,b);a=[];g=h.find_spatial_at(c.collisionBox.xPos,c.collisionBox.yPos);a.push(g);g=h.find_spatial_at(c.collisionBox.x2Pos,c.collisionBox.yPos);
a.push(g);g=h.find_spatial_at(c.collisionBox.xPos,c.collisionBox.y2Pos);a.push(g);g=h.find_spatial_at(c.collisionBox.x2Pos,c.collisionBox.y2Pos);a.push(g);a=gpe.make_array_unique(a);if(0<=f&&f<GPE_MAX_OBJECT_TYPES)if(c.gpeObjectType==f)for(b=a.length-1;0<=b;b--){g=a[b];var e=0<=g||g<h.COLLISION_AREA_SPACES.length?h.COLLISION_AREA_SPACES.at(g):h.COLLISION_AREA_OUTSIDE_SCENE;-1==e&&(e=h.COLLISION_AREA_OUTSIDE_SCENE);e=e.heldObjectsArray[f];for(g=e.length-1;0<=g;g--){var l=e[g];if(-1!=l&&l.gpeUniqGameObjectId!=
c.gpeUniqGameObjectId&&gpe.check_collision_rect(c.collisionBox,l.collisionBox))return c.collisionBox.update_position(k,d),l}}else for(b=a.length-1;0<=b;b--){if(g=a[b],e=0<=g||g<h.COLLISION_AREA_SPACES.length?h.COLLISION_AREA_SPACES.at(g):h.COLLISION_AREA_OUTSIDE_SCENE,0<=f&&f<GPE_MAX_OBJECT_TYPES)for(-1==e&&(e=h.COLLISION_AREA_OUTSIDE_SCENE),e=e.heldObjectsArray[f],g=e.length-1;0<=g;g--)if(l=e[g],-1!=l&&gpe.check_collision_rect(c.collisionBox,l.collisionBox))return c.collisionBox.update_position(k,
d),l}else for(b=a.length-1;0<=b;b--)for(g=a[b],e=0<=g||g<h.COLLISION_AREA_SPACES.length?h.COLLISION_AREA_SPACES.at(g):h.COLLISION_AREA_OUTSIDE_SCENE,g=e.internalArray.length-1;0<=g;g--)if(l=e.internalArray[g],l.gpeUniqGameObjectId!=c.gpeUniqGameObjectId&&gpe.check_collision_rect(c.collisionBox,l.collisionBox))return c.collisionBox.update_position(k,d),l;c.collisionBox.update_position(k,d)}}return IS_NULL};this.touches_family=function(c,a,b,f,k){"number"!=typeof k&&(k=c.sceneLayerPos);if(-1!=c&&0<=
k&&32>k){for(var h=IS_NULL,d=!1,g=GPR.currentScene.sceneLayers.length-1;0<=g;g--)if(h=GPR.currentScene.sceneLayers[g],h.layerId==k){d=!0;break}if(d){k=this.GAME_OBJECTS_FAMILIES[f];if(0==k.length)return this.find_collision_rectangle(c,a,b,f,layerId);if(0<=f&&f<GPE_MAX_OBJECT_TYPES){f=c.collisionBox.xPos;d=c.collisionBox.yPos;0<=c.spriteId&&c.spriteId<gpe.rsm.rSprites.length?(g=gpe.rsm.rSprites[c.spriteId],c.collisionBox.update_position(a+g.colX,b+g.colY)):c.collisionBox.update_position(a,b);a=[];
g=h.find_spatial_at(c.collisionBox.xPos,c.collisionBox.yPos);a.push(g);g=h.find_spatial_at(c.collisionBox.x2Pos,c.collisionBox.yPos);a.push(g);g=h.find_spatial_at(c.collisionBox.xPos,c.collisionBox.y2Pos);a.push(g);g=h.find_spatial_at(c.collisionBox.x2Pos,c.collisionBox.y2Pos);a.push(g);a=gpe.make_array_unique(a);var e,l;for(b=a.length-1;0<=b;b--)for(g=a[b],g=0<=g||g<h.COLLISION_AREA_SPACES.length?h.COLLISION_AREA_SPACES.at(g):h.COLLISION_AREA_OUTSIDE_SCENE,-1==g&&(g=h.COLLISION_AREA_OUTSIDE_SCENE),
e=k.length-1;0<=e;e--){var q=k[e];var r=g.heldObjectsArray[q];if(c.gpeObjectType==q)for(l=r.length-1;0<=l;l--){if(q=r[l],-1!=q&&q.gpeUniqGameObjectId!=c.gpeUniqGameObjectId&&gpe.check_collision_rect(c.collisionBox,q.collisionBox))return c.collisionBox.update_position(f,d),q}else for(l=r.length-1;0<=l;l--)if(q=r[l],-1!=q&&gpe.check_collision_rect(c.collisionBox,q.collisionBox))return c.collisionBox.update_position(f,d),q}}else return this.find_collision_rectangle(c,a,b,-1,layerId)}}return IS_NULL};
this.find_collisions_of_spatialpartion=function(c){var a,b,f,d;for(a=GPE_MAX_OBJECT_TYPES-1;0<=a;a--){var h=c.heldObjectsArray[a];for(b=h.length-1;0<=b;b--){var n=h[b];for(f=n.OBJECT_COLLISION_LIST.length-1;0<=f;f--){var e=c.heldObjectsArray[n.OBJECT_COLLISION_LIST[f]];for(d=e.length-1;0<=d;d--){var m=e[d];if(n.gpeUniqGameObjectId!=m.gpeUniqGameObjectId){this.objectCollisionHashesChecked+=2;var l=n.gpeUniqGameObjectId+":"+m.gpeUniqGameObjectId;var q=m.gpeUniqGameObjectId+":"+n.gpeUniqGameObjectId;
this.objectCollisionIsChecked[l]||this.objectCollisionIsChecked[q]||(this.objectCollisionIsChecked[l]=this.objectCollisionIsChecked[q]=!0,this.spatialCollisionChecks+=1,this.check_collision_rect(n.collisionBox,m.collisionBox)&&this.add_collision_pair(n,m))}}}}}};this.find_collisions_of_two_spatialpartions=function(c,a){var b,f,d,h;for(b=c.heldObjectsArray.size()-1;0<=b;b--){var g=c.heldObjectsArray[b];for(f=g.length-1;0<=f;f--){var e=g[f];for(d=e.OBJECT_COLLISION_LIST.length-1;0<=d;d--){var m=a.heldObjectsArray[e.OBJECT_COLLISION_LIST[d]];
for(h=m.length-1;0<=h;h--){var l=m[h];if(e.gpeUniqGameObjectId!=l.gpeUniqGameObjectId){this.objectCollisionHashesChecked+=2;var q=e.gpeUniqGameObjectId+":"+l.gpeUniqGameObjectId;var r=l.gpeUniqGameObjectId+":"+e.gpeUniqGameObjectId;this.objectCollisionIsChecked[q]||this.objectCollisionIsChecked[r]||(this.objectCollisionIsChecked[q]=this.objectCollisionIsChecked[r]=!0,this.spatialCollisionChecks+=1,this.check_collision_rect(e.collisionBox,l.collisionBox)&&this.add_collision_pair(e,l))}}}}}};this.find_collisions_in_all_spatialpartions=
function(){var c;for(c=this.COLLISION_AREA_SPACES.size()-1;0<=c;c--){var a=this.COLLISION_AREA_SPACES.at(c);this.find_collisions_of_spatialpartion(a)}this.find_collisions_of_spatialpartion(this.COLLISION_AREA_OUTSIDE_SCENE)};this.find_furthest_object=function(c,a,b,f,d){"undefined"==typeof f&&(f=IS_NULL);this.find_nearest_spatial_at(a,b)>=this.COLLISION_AREA_SPACES.size()&&this.COLLISION_AREA_SPACES.size();this.COLLISION_AREA_SPACES.size();this.COLLISION_AREA_SPACES.size();var h,k=IS_NULL,g=IS_NULL,
e=this.COLLISION_AREA_SPACES.length-1;if(0<=c&&c<GPE_MAX_OBJECT_TYPES){for(;0<=e;){d=this.COLLISION_AREA_SPACES[e];if(-1!=d)for(d=d.heldObjectsArray[c],h=d.length-1;0<=h;){var l=d[h];if(-1!=l&&0==l.gpeIsBeingDestroyed&&l.gpeUniqGameObjectId!=f){var q=l.collisionBox.xCenter;var r=l.collisionBox.yMiddle;q=gpe.get_distance(a,b,q,r);q>k&&(g=l,k=q)}h--}e--}d=this.COLLISION_AREA_OUTSIDE_SCENE.heldObjectsArray[c]}else{for(;0<=e;){d=this.COLLISION_AREA_SPACES[e];if(-1!=d)for(d=d.internalArray,h=d.length-
1;0<=h;)l=d[h],-1!=l&&0==l.gpeIsBeingDestroyed&&l.gpeUniqGameObjectId!=f&&(q=l.collisionBox.xCenter,r=l.collisionBox.yMiddle,q=gpe.get_distance(a,b,q,r),q>k&&(g=l,k=q)),h--;e--}d=this.COLLISION_AREA_OUTSIDE_SCENE.internalArray}for(h=d.length-1;0<=h;)l=d[h],-1!=l&&0==l.gpeIsBeingDestroyed&&l.gpeUniqGameObjectId!=f&&(q=l.collisionBox.xCenter,r=l.collisionBox.yMiddle,q=gpe.get_distance(a,b,q,r),q>k&&(g=l,k=q)),h--;return g};this.find_last_object=function(c){return IS_NULL};this.find_nearest_object=function(c,
a,b,f,d){"undefined"==typeof f&&(f=IS_NULL);var h,k=9007199254740991,g=IS_NULL,e=this.COLLISION_AREA_SPACES.length-1;if(0<=c&&c<GPE_MAX_OBJECT_TYPES){for(;0<=e;){d=this.COLLISION_AREA_SPACES[e];if(-1!=d)for(d=d.heldObjectsArray[c],h=d.length-1;0<=h;){var l=d[h];if(-1!=l&&0==l.gpeIsBeingDestroyed&&l.gpeUniqGameObjectId!=f){var q=l.collisionBox.xCenter;var r=l.collisionBox.yMiddle;q=gpe.get_distance(a,b,q,r);q<k&&(g=l,k=q)}h--}e--}d=this.COLLISION_AREA_OUTSIDE_SCENE.heldObjectsArray[c]}else{for(;0<=
e;){d=this.COLLISION_AREA_SPACES[e];if(-1!=d)for(d=d.internalArray,h=d.length-1;0<=h;)l=d[h],-1!=l&&0==l.gpeIsBeingDestroyed&&l.gpeUniqGameObjectId!=f&&(q=l.collisionBox.xCenter,r=l.collisionBox.yMiddle,q=gpe.get_distance(a,b,q,r),q<k&&(g=l,k=q)),h--;e--}d=this.COLLISION_AREA_OUTSIDE_SCENE.internalArray}for(h=d.length-1;0<=h;)l=d[h],-1!=l&&0==l.gpeIsBeingDestroyed&&l.gpeUniqGameObjectId!=f&&(q=l.collisionBox.xCenter,r=l.collisionBox.yMiddle,q=gpe.get_distance(a,b,q,r),q<k&&(g=l,k=q)),h--;return g};
this.find_newest_object=function(c){return IS_NULL};this.find_object_collision=function(c,a,b,f){};this.find_tile=function(c,a,b){return this.currentScene.find_tile(c,a,b)};this.find_tile_in_box=function(c,a,b,f,d){return this.currentScene.find_tile_in_box(c,a,b,f,d)};this.find_matching_tile=function(c,a,b,f){return this.currentScene.find_matching_tile(c,a,b,f)};this.find_matching_tile_in_box=function(c,a,b,f,d,h){return this.currentScene.find_tile_in_box(c,a,b,f,d,h)};this.game_reset=function(){};
this.get_camera_info=function(c){"number"!=typeof c&&(c=0);return-1!=this.currentScene&&0<=c&&c<gpe.maxCameras?(c=this.currentScene.sceneCamera[c],{x:c.cameraRect.get_x(),y:c.cameraRect.get_x(),w:c.cameraRect.get_width(),h:c.cameraRect.get_height(),sx:c.renderRect.get_x(),sy:c.renderRect.get_x(),sw:c.renderRect.get_width(),sh:c.renderRect.get_height()}):IS_NULL};this.get_camera_height=function(c){"number"!=typeof c&&(c=0);return-1!=this.currentScene&&0<=c&&c<gpe.maxCameras?this.currentScene.sceneCamera[c].cameraRect.get_height():
IS_NULL};this.get_camera_width=function(c){"number"!=typeof c&&(c=0);return-1!=this.currentScene&&0<=c&&c<gpe.maxCameras?this.currentScene.sceneCamera[c].cameraRect.get_width():IS_NULL};this.get_camera_x=function(c){"number"!=typeof c&&(c=0);return-1!=this.currentScene&&0<=c&&c<gpe.maxCameras?this.currentScene.sceneCamera[c].cameraRect.get_x():IS_NULL};this.get_camera_y=function(c){"number"!=typeof c&&(c=0);return-1!=this.currentScene&&0<=c&&c<gpe.maxCameras?this.currentScene.sceneCamera[c].cameraRect.get_y():
IS_NULL};this.get_camera_mouse_x=function(c){return 0<=c&&c<gpe.maxCameras?this.MOUSE_CAM_X[c]:this.MOUSE_CAM_X[0]};this.get_camera_mouse_y=function(c){return 0<=c&&c<gpe.maxCameras?this.MOUSE_CAM_Y[c]:this.MOUSE_CAM_Y[0]};this.get_camera_screen_height=function(c){"number"!=typeof c&&(c=0);return-1!=this.currentScene&&0<=c&&c<gpe.maxCameras?this.currentScene.sceneCamera[c].renderRect.get_height():IS_NULL};this.get_camera_screen_width=function(c){"number"!=typeof c&&(c=0);return-1!=this.currentScene&&
0<=c&&c<gpe.maxCameras?this.currentScene.sceneCamera[c].renderRect.get_width():IS_NULL};this.get_camera_screen_x=function(c){"number"!=typeof c&&(c=0);return-1!=this.currentScene&&0<=c&&c<gpe.maxCameras?this.currentScene.sceneCamera[c].renderRect.get_x():IS_NULL};this.get_camera_screen_y=function(c){"number"!=typeof c&&(c=0);return-1!=this.currentScene&&0<=c&&c<gpe.maxCameras?this.currentScene.sceneCamera[c].renderRect.get_y():IS_NULL};this.get_font_family=function(c){return"undefined"!=typeof fontIdIn&&
0<textToRender.length&&0<=fontIdIn&&fontIdIn<gpe.rsm.rFonts.length&&(c=gpe.rsm.rFonts[fontIdIn],-1!=c)?c.get_family():""};this.get_font_width=function(c,a){if("undefined"!=typeof fontIdIn&&0<textToRender.length&&0<=fontIdIn&&fontIdIn<gpe.rsm.rFonts.length){var b=gpe.rsm.rFonts[fontIdIn];if(-1!=b)return b.get_text_width(a)}return 0};this.get_font_height=function(c,a){if("undefined"!=typeof fontIdIn&&0<textToRender.length&&0<=fontIdIn&&fontIdIn<gpe.rsm.rFonts.length){var b=gpe.rsm.rFonts[fontIdIn];
if(-1!=b)return b.get_text_height(a)}return 0};this.get_font_size=function(c){return"undefined"!=typeof fontIdIn&&0<textToRender.length&&0<=fontIdIn&&fontIdIn<gpe.rsm.rFonts.length&&(c=gpe.rsm.rFonts[fontIdIn],-1!=c)?c.fontSize:-1};this.font_is_monospaced=function(c){return"undefined"!=typeof fontIdIn&&0<textToRender.length&&0<=fontIdIn&&fontIdIn<gpe.rsm.rFonts.length&&(c=gpe.rsm.rFonts[fontIdIn],-1!=c)?c.isMonoSpacedFont:!1};this.get_object_count=function(c){return 0<=c&&c<this.GAME_OBJECTS.length?
this.GAME_OBJECTS[c].length:0};this.get_object_count_all=function(c){if(0<=c&&c<GPE_MAX_OBJECT_TYPES){if(0==GPE.GAME_OBJECTS_FAMILIES[c].length)return this.GAME_OBJECTS[c].length;var a=0;for(c=this.GAME_OBJECTS[c].length-1;0<=c;c--)a+=gpe.GAME_OBJECTS[gpe.GAME_OBJECTS_FAMILIES[c]].length;return a}return 0};this.get_object_in_view_count=function(c){if(0<=c&&c<GPE_MAX_OBJECT_TYPES)for(c=this.collisionSpacesInView.length-1;0<=c;c--);return 0};this.position_open=function(c,a,b,f){"number"!=typeof f&&
(f=1);if(-1!=objOne&&0<=f&&32>f){for(var d=IS_NULL,h=!1,g=GPR.currentScene.sceneLayers.length-1;0<=g;g--)if(d=GPR.currentScene.sceneLayers[g],d.layerId==f){h=!0;break}if(h)if(h=d.find_spatial_at(c,a),f=IS_NULL,f=0>h||f>=d.COLLISION_AREA_SPACES.length?d.COLLISION_AREA_OUTSIDE_SCENE:d.COLLISION_AREA_SPACES.at(h),0<b&&b<GPE_MAX_OBJECT_TYPES)for(f=f.heldObjectsArray[b],b=f.length-1;0<=b;b--){if(d=f[b],-1!=d&&gpe.point_within(c,a,d.collisionBox.xPos,d.collisionBox.yPos,d.collisionBox.x2Pos,d.collisionBox.y2Pos))return d}else for(b=
f.internalArray.length-1;0<=b;b--)if(d=f.internalArray[b],gpe.point_within(c,a,d.collisionBox.xPos,d.collisionBox.yPos,d.collisionBox.x2Pos,d.collisionBox.y2Pos))return d}return IS_NULL};this.find_nearest_spatial_at=function(c,a){0>c&&(c=0);0>a&&(a=0);c>=this.currentScene.sceneWidth&&(c=this.currentScene.sceneWidth-1);a>=this.currentScene.sceneHeight&&(a=this.currentScene.sceneHeight-1);var b=(c/this.spatialGridWidthSize|0)*this.spatialGridHeightAmount;b+=a/this.spatialGridHeightSize|0;0>b&&(b=0);
b>=this.COLLISION_AREA_SPACES.length&&(b=this.COLLISION_AREA_SPACES.length-1);return b};this.find_spatial_at=function(c,a){var b=-1;0<=c&&0<=a&&c<this.currentScene.sceneWidth&&a<this.currentScene.sceneHeight&&(b=(c/this.spatialGridWidthSize|0)*this.spatialGridHeightAmount,b+=a/this.spatialGridHeightSize|0,0>b||b>=this.COLLISION_AREA_SPACES.length)&&(b=-1);return b};this.render_state=function(){if(-1!=this.currentScene&&0==this.sceneWasReset&&this.currentScene.sceneHasBeenActivated){if(gpe.context.font=
"bold 16pt Calibri",gpe.context.textAlign="left",gpe.context.fillStyle="#FFF",gpe.GPE_Current_Context=gpe.preGuiContext,gpe.preGuiContext.clearRect(0,0,gpe.preGuiCanvas.width,gpe.preGuiCanvas.height),this.currentScene.scene_is_ready()?this.currentScene.sceneIsProcessed&&this.currentScene.sceneResourcesAreProcessed&&(this.currentScene.render_scene(gpe.GPE_Current_Context,this),gpe.context.drawImage(gpe.preGuiCanvas,0,0,gpe.preGuiCanvas.width,gpe.preGuiCanvas.height,0,0,gpe.canvas.width,gpe.canvas.height)):
(gpe.context.fillStyle="#FFF",gpe.context.fillText("Loading...",40,gpe.canvas.height-64)),gpe.GPE_Current_Context=gpe.context,GPE_SETTINGS_IS_DEBUGGING){gpe.GPE_Current_Context.font="bold 16pt Calibri";gpe.GPE_Current_Context.textAlign="left";gpe.GPE_Current_Context.textAlign="left";gpe.GPE_Current_Context.fillStyle="red";for(var c="",a=0;a<this.collisionSpacesInView.length;a++)c=c+this.collisionSpacesInView[a]+", ";gpe.GPE_Current_Context.fillText(c,32,32);for(a=0;a<gpe.maxCameras;a++)c=this.currentScene.sceneCamera[a],
c.isVisible&&gpe.GPE_Current_Context.fillText("["+a+"] ("+c.cameraRect.xPos+","+c.cameraRect.yPos+") , ("+c.cameraRect.x2Pos+","+c.cameraRect.y2Pos+").",32,64+32*a)}}else gpe.context.fillStyle=this.currentScene.bgColor,gpe.context.fillRect(0,0,gpe.canvas.width,gpe.canvas.height)};this.begin_spatialpartioning=function(c,a){this.sceneWidth=c;this.sceneHeight=a;this.spatialGridWidthAmount=Math.ceil(c/this.spatialGridWidthSize);2>this.spatialGridWidthAmount&&(this.spatialGridWidthSize=c/2,this.spatialGridWidthAmount=
2);this.spatialGridHeightAmount=Math.ceil(a/this.spatialGridHeightSize);2>this.spatialGridHeightAmount&&(this.spatialGridHeightSize=a/2,this.spatialGridHeightAmount=2);for(var b=this.currentScene.sceneLayers.length-1;0<=b;b--)this.currentScene.sceneLayers[b].begin_spatialpartioning(c,a)};this.prepare_game_frame=function(){this.parsing_objects_begun=!0;this.spatialCollisionChecks=this.objectCollisionHashesChecked=this.colisionObjectLoops=this.collisionsCheckedCount=0;this.objectCollisionIsChecked=
{};this.collisionPairA=[];this.collisionPairB=[];this.collisionPairsTotal=0;this.parsed_objects=0;for(var c,a,b=gpe.maxCameras-1,f,d=this.currentScene.sceneLayers.length-1;0<=d;d--)for(f=this.currentScene.sceneLayers[d],c=f.layerObjects.length-1;0<=c;c--){var h=f.layerObjects[c];h.collisionBeingChecked=!0;h.isOutsideScene=!1;h.gpeLogicAppliedInFrame=!1;h.gpePrelogicAppliedInFrame=!1;for(a=b;0<=a;a--)h.prerenderedInFrame[a]=!1,h.renderedInFrame[a]=!1;h.gpeAddedToRenderList=!1;h.gpeAddedToContinuousList=
!1}this.superDebugCollisions=!1;this.currentScene.sceneIsSpatiallyPartitioned=!0};this.get_scene_width=function(c){return this.currentScene.get_scene_width()};this.get_scene_height=function(c){return this.currentScene.get_scene_height()};this.get_past_scene=function(){return pastSceneId};this.get_past_scene_name=function(){return pastSceneName};this.get_scene_id=function(){return this.currentScene.sceneId};this.get_scene_name=function(){return this.currentScene.sceneName};this.process_scene_movement=
function(){var c=this.sceneToEnter;if(this.currentSceneId!=c&&0<=c&&c<gpe.gpeScenes.length){GPE_SETTINGS_IS_DEBUGGING&&console.log("Attempting to visit scene ID #"+c+".");this.pastSceneId=this.currentScene;this.pastSceneName=this.currentScene.sceneName;var a,b;0==this.currentScene.sceneIsContinuous&&this.currentScene.reset_scene_meta();this.GAME_OBJECTS_CONTINUOUS=[];this.currentScene.persistentObjects=[];for(a=this.GAME_OBJECTS.length-1;0<=a;a--){var f=this.GAME_OBJECTS[a];for(b=f.length-1;0<=b;b--){var d=
f[b];0==d.gpeIsBeingDestroyed&&(d.scene_end(),d.gpeIsContinuousObject?this.add_to_continuous_objects(d):this.currentScene.sceneIsContinuous&&this.currentScene.add_to_persistent_objects(d))}}this.delete_selected_objects();this.scene_restart_object_info();this.currentScene.sceneIsContinuous?this.currentScene.sceneWasVisitedBefore=!0:this.currentScene.reset_scene_meta();this.currentScene.clear_layers_data();-1!=this.currentScene&&(gpe.stop_audio(this.currentScene.startAudio),gpe.stop_audio(this.currentScene.bgMusic),
gpe.play_audio(this.currentScene.endAudio,!1));this.currentScene.sceneHasBeenActivated=!1;this.currentScene=gpe.gpeScenes[c];this.currentSceneId=this.sceneToEnter=c;GPE_SETTINGS_IS_DEBUGGING&&console.log(this.currentScene);this.currentScene.update_tilemap();this.currentScene.sceneHasBeenActivated=!1;gpe.loop_audio(this.currentScene.bgMusic);gpe.play_audio(this.currentScene.startAudio,!1)}else if(this.sceneWasReset){this.GAME_OBJECTS_CONTINUOUS=[];this.currentScene.persistentObjects=[];-1!=this.currentScene&&
(gpe.stop_audio(this.currentScene.startAudio),gpe.stop_audio(this.currentScene.bgMusic),gpe.play_audio(this.currentScene.endAudio,!1));this.currentScene.reset_scene_meta();this.currentScene.clear_layers_data();if(this.sceneWasHardReset)for(a=this.GAME_OBJECTS.length-1;0<=a;a--)for(f=this.GAME_OBJECTS[a],b=f.length-1;0<=b;b--)d=f[b],0==d.gpeIsBeingDestroyed&&d.scene_end();else for(a=this.GAME_OBJECTS.length-1;0<=a;a--)for(f=this.GAME_OBJECTS[a],b=f.length-1;0<=b;b--)d=f[b],0==d.gpeIsBeingDestroyed&&
(d.scene_end(),d.gpeIsContinuousObject&&d.gpeSceneStartId!=this.currentSceneId&&this.add_to_continuous_objects(d));this.delete_selected_objects();this.scene_restart_object_info();this.currentScene.reset_scene_meta();this.currentScene.sceneHasBeenActivated=!1;this.currentScene.sceneIsContinuous&&(this.currentScene.sceneWasVisitedBefore=!0);this.currentScene.update_tilemap();gpe.loop_audio(this.currentScene.bgMusic);gpe.play_audio(this.currentScene.startAudio,!1);this.sceneWasHardReset=this.sceneWasReset=
!1}};this.scene_restart_object_info=function(){this.GAME_OBJECTS_TO_BE_DESTROYED=[];this.collisionSpacesInView=[];this.spatialGridIsCreated=!1;this.spatialMapHeightSize=this.spatialMapWidthSize=0;this.objectCollisionIsChecked={};this.GAME_OBJECTS=[];this.COLLISION_CHECK_ARRAY=new gpe.SuperVector;for(var c,a=0;a<GPE_MAX_OBJECT_TYPES;a+=1){c=new gpe.SuperVector;for(var b=0;b<GPE_MAX_OBJECT_TYPES;b+=1)c.push_back(!1);this.COLLISION_CHECK_ARRAY.push_back(c);this.GAME_OBJECTS.push_back([])}this.COLLISION_AREA_SPACES=
[];this.COLLISION_AREA_OUTSIDE_SCENE=new gpe.SuperSpatialPartition;this.superDebugCollisions=!1;this.collisionPairA=[];this.collisionPairB=[];this.parsed_objects=this.collisionPairsTotal=0;this.set_default_grid_size();this.spaitalGridHeightAmount=this.spatialGridWidthAmount=2;this.spatialCollisionChecks=this.objectCollisionHashesChecked=0;this.spatialGridIsCreated=!1;this.spatialMapHeightSize=this.spatialMapWidthSize=-1};this.scene_enter=function(c){return this.sceneToEnter==this.currentSceneId&&
0<=c&&c<gpe.gpeScenes.length?(this.sceneToEnter=c,!0):!1};this.scene_enter_previous=function(){if(this.sceneToEnter==this.currentSceneId&&0<this.currentSceneId)return this.sceneToEnter=this.currentSceneId-1,!0};this.scene_enter_next=function(){return this.sceneToEnter==this.currentSceneId&&this.currentSceneId<gpe.gpeScenes.length-1?(this.sceneToEnter=this.currentSceneId+1,!0):!1};this.scene_reset=function(c){0==this.sceneWasReset&&(this.sceneWasHardReset=c?!0:!1,this.sceneWasReset=!0)};this.setup_camera=
function(c,a,b,f,d){-1!=this.currentScene&&0<=c&&c<gpe.maxCameras&&this.currentScene.sceneCamera[c].setup_camera(a,b,f,d)};this.split_screen=function(c,a,b){if(1<=c&&8>=c){console.log("Setting up "+c+" cameras...");var f;for(f=0;f<c;f++)this.enable_camera(f);for(f=c;f<gpe.maxCameras;f++)this.disable_camera(f);"boolean"==typeof a&&(a=!1);"boolean"==typeof b&&(b=!1);1==c?this.setup_camera(0,0,0,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT):2==c?a?(this.setup_camera(0,0,0,GPE_SETTINGS_SCREEN_WIDTH/
2,GPE_SETTINGS_SCREEN_HEIGHT),this.setup_camera(1,GPE_SETTINGS_SCREEN_WIDTH/2,0,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT)):(this.setup_camera(0,0,0,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(1,0,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT/2)):3==c?a?(this.setup_camera(0,0,0,GPE_SETTINGS_SCREEN_WIDTH/3,GPE_SETTINGS_SCREEN_HEIGHT),this.setup_camera(1,GPE_SETTINGS_SCREEN_WIDTH/3,0,GPE_SETTINGS_SCREEN_WIDTH/3,GPE_SETTINGS_SCREEN_HEIGHT),
this.setup_camera(2,2*GPE_SETTINGS_SCREEN_WIDTH/3,0,GPE_SETTINGS_SCREEN_WIDTH/3,GPE_SETTINGS_SCREEN_HEIGHT)):b?(this.setup_camera(0,0,0,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(1,GPE_SETTINGS_SCREEN_WIDTH/2,0,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(2,0,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2)):(this.setup_camera(0,0,0,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(1,
0,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(2,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT/2)):4==c?(this.setup_camera(0,0,0,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(1,GPE_SETTINGS_SCREEN_WIDTH/2,0,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(2,0,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/
2),this.setup_camera(3,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT/2)):5!=c&&(6==c?(this.setup_camera(0,0,0,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(1,GPE_SETTINGS_SCREEN_WIDTH/2,0,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(2,GPE_SETTINGS_SCREEN_WIDTH/2,0,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(3,0,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH/
2,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(4,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(5,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT/2)):7!=c&&8==c&&(this.setup_camera(0,0,0,GPE_SETTINGS_SCREEN_WIDTH/4,GPE_SETTINGS_SCREEN_HEIGHT/4),this.setup_camera(1,GPE_SETTINGS_SCREEN_WIDTH/2,0,GPE_SETTINGS_SCREEN_WIDTH/4,GPE_SETTINGS_SCREEN_HEIGHT/4),
this.setup_camera(2,GPE_SETTINGS_SCREEN_WIDTH/2,0,GPE_SETTINGS_SCREEN_WIDTH/4,GPE_SETTINGS_SCREEN_HEIGHT/4),this.setup_camera(3,GPE_SETTINGS_SCREEN_WIDTH/2,0,GPE_SETTINGS_SCREEN_WIDTH/4,GPE_SETTINGS_SCREEN_HEIGHT/4),this.setup_camera(4,0,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH/4,GPE_SETTINGS_SCREEN_HEIGHT/4),this.setup_camera(5,0,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH/4,GPE_SETTINGS_SCREEN_HEIGHT/4),this.setup_camera(6,0,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH/
4,GPE_SETTINGS_SCREEN_HEIGHT/4),this.setup_camera(7,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/4,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT/4)));return!0}gpe.enable_camera(0);gpe.setup_camera(0,0,0,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT);return 0};this.update_object_in_map=function(c){if(-1!=typeof c){for(var a=IS_NULL,b=!1,f=c.sceneLayerPos,d=GPR.currentScene.sceneLayers.length-1;0<=d;d--)if(a=GPR.currentScene.sceneLayers[d],a.layerId==f){b=!0;break}if(b){b=[-1,
-1,-1,-1];b[0]=-1;b[1]=-1;b[2]=-1;b[3]=-1;f=c.collisionBox.xPos;d=c.collisionBox.yPos;var h=c.collisionBox.x2Pos;var e=c.collisionBox.y2Pos;0>f||0>d||f>this.sceneWidth||d>this.sceneHeight?b[0]=-1:(b[0]=(f/a.spatialGridWidthSize|0)*a.spatialGridHeightAmount,b[0]+=d/a.spatialGridHeightSize|0);0>h||0>d||h>this.sceneWidth||d>this.sceneHeight?b[1]=-1:(b[1]=(h/a.spatialGridWidthSize|0)*a.spatialGridHeightAmount,b[1]+=d/a.spatialGridHeightSize|0);0>f||0>e||f>this.sceneWidth||e>this.sceneHeight?b[2]=-1:(b[2]=
(f/a.spatialGridWidthSize|0)*a.spatialGridHeightAmount,b[2]+=e/a.spatialGridHeightSize|0);0>h||0>e||h>this.sceneWidth||e>this.sceneHeight?b[3]=-1:(b[3]=(h/a.spatialGridWidthSize|0)*a.spatialGridHeightAmount,b[3]+=e/a.spatialGridHeightSize|0);b=gpe.make_array_unique(b);if(1==c.GPE_AddedToGridSystem){for(f=c.SPATIAL_PARTITION_LIST.length-1;0<=f;f--){h=c.SPATIAL_PARTITION_LIST[f];e=!1;for(d=b.length-1;0<=d;d--)if(h==b[d]){e=!0;break}e||(0>h||h>=a.COLLISION_AREA_SPACES.length?a.COLLISION_AREA_OUTSIDE_SCENE.remove_held_object(c):
(d=a.COLLISION_AREA_SPACES[h],d.remove_held_object(c)))}for(f=b.length-1;0<=f;f--){h=b[f];e=!1;for(d=c.SPATIAL_PARTITION_LIST.length-1;0<=d;d--)if(h==c.SPATIAL_PARTITION_LIST[d]){e=!0;break}e||(0>h||h>=a.COLLISION_AREA_SPACES.size()?0==c.isOutsideScene&&(a.COLLISION_AREA_OUTSIDE_SCENE.add_object(c),c.isOutsideScene=!0):(d=a.COLLISION_AREA_SPACES.at(h),d.add_object(c)))}}else for(f=b.length-1;0<=f;f--)h=b[f],0>h||h>=a.COLLISION_AREA_SPACES.size()?0==c.isOutsideScene&&(a.COLLISION_AREA_OUTSIDE_SCENE.add_object(c),
c.isOutsideScene=!0):(d=a.COLLISION_AREA_SPACES.at(h),d.add_object(c));c.SPATIAL_PARTITION_LIST=b}else console.log("Unable to find matching layer in map for ["+f+"] layer...")}};this.replace_background=function(c,a,b){this.currentScene.replace_background(c,a,b)};this.replace_all_backgrounds=function(c,a){this.currentScene.replace_all_backgrounds(c,a)};this.set_background=function(c,a,b){this.currentScene.replace_background(c,a,b)};this.GAME_OBJECTS[0]=[];this.COLLISION_CHECK_ARRAY=new gpe.SuperVector;
for(var a=0;a<this.GAME_OBJECTS.length;a+=1){e=new gpe.SuperVector;for(var d=0;d<this.GAME_OBJECTS;d+=1)e.push_back([]);this.COLLISION_CHECK_ARRAY.push_back(e)}}function K(){this.html5AudioSource=new Audio;this.audioIsLoaded=!1;this.audioId=this.audioCouldBePlayed=-1;this.audioFileName=[];this.actualAudioFileName="";this.audioName="unnamed";this.audioGroupName="";this.audioLoopsAround=!1;this.defaultVolume=100;this.isBeingLooped=this.audioLoadedInMemory=this.audioWasPaused=this.audioWasStopped=!1;
for(var e=0;e<GPE_SUPPORTED_AUDIO_FORMAT_COUNT;e++)this.audioFileName[e]="";this.check_audio_state=function(){for(var a=0;a<GPE_SUPPORTED_AUDIO_FORMAT_COUNT;a++);0==this.audioShouldLoad&&(this.audioIsLoaded=!0);1!=this.audioIsLoaded&&2<=this.html5AudioSource.readyState?this.audioLoadedInMemory=this.audioIsLoaded=!0:this.html5AudioSource.error&&(this.audioIsLoaded=!0,this.audioLoadedInMemory=!1,console.log("Error loading "+this.audioName+"."));return this.audioIsLoaded};this.check_is_playing=function(){return-1!=
this.html5AudioSource?!this.html5AudioSource.paused:!1};this.load_audio=function(){-1==this.html5AudioSource&&(this.html5AudioSource=new Audio,this.html5AudioSource.volume=this.defaultVolume);if(0==this.audioIsLoaded){this.actualAudioFileName="";var a=!1;this.audioCouldBePlayed=-1;for(var d=0;d<GPE_SUPPORTED_AUDIO_FORMAT_COUNT;d++)GPE_AUDIO_PLAYABLE[d]>this.audioCouldBePlayed&&3<this.audioFileName[d].length&&(this.actualAudioFileName=this.audioFileName[d],this.audioCouldBePlayed=GPE_AUDIO_PLAYABLE[d],
a=!0);0==a&&(this.audioIsLoaded=!0);3<this.actualAudioFileName.length&&(this.html5AudioSource.addEventListener("canplaythrough",function(){this.audioLoadedInMemory=this.audioIsLoaded=!0}),this.html5AudioSource.src=this.actualAudioFileName)}};this.pause_audio=function(){gpe.lastLoopedTrack==this.audioId&&(gpe.lastLoopedTrack=-1);this.isBeingLooped=!1;-1!=this.html5AudioSource&&1==this.audioLoadedInMemory&&(this.html5AudioSource.oncanplaythrough=function(){},this.html5AudioSource.pause(),this.audioWasPaused=
!0,this.audioWasStopped=!1)};this.play_audio=function(a){"undefined"==typeof a&&(a=!1);-1!=this.html5AudioSource&&(1==this.audioIsLoaded&&1==this.audioLoadedInMemory?(this.html5AudioSource.paused?this.html5AudioSource.ended&&(this.html5AudioSource.currentTime=0):this.html5AudioSource.currentTime=.5,this.html5AudioSource.play()):2<=this.html5AudioSource.readyState?(this.audioIsLoaded=!0,this.html5AudioSource.play()):this.html5AudioSource.oncanplaythrough=function(){this.play(a)},this.audioWasStopped=
this.audioWasPaused=!1,a?(GPE_SETTINGS_IS_DEBUGGING&&console.log("Playing Audio"+this.audioId+" that loops"),gpe.lastLoopedTrack=this.audioId,this.isBeingLooped=!0):(GPE_SETTINGS_IS_DEBUGGING&&console.log("Playing Audio"+this.audioId+" that doesnt loop"),this.isBeingLooped=!1))};this.stop_audio=function(){gpe.lastLoopedTrack==this.audioId&&(gpe.lastLoopedTrack=-1);this.isBeingLooped=!1;GPE_SETTINGS_IS_DEBUGGING&&console.log("Stopping audio track: ["+this.audioId+"].");-1!=this.html5AudioSource&&(this.html5AudioSource.oncanplaythrough=
function(){},this.html5AudioSource.currentTime=0,this.html5AudioSource.pause(),this.audioWasPaused=!1,this.audioWasStopped=!0)}}function L(){this.fontId=-1;this.fontFileName=[];this.fontFamilyName="";this.fontName="unnamed";this.fontCanvasInfo="";this.fontSize=12;this.isMonoSpacedFont=!1;for(var e=0;e<GPE_SUPPORTED_FONT_FORMAT_COUNT;e++)this.fontFileName[e]="";this.load_font=function(){var a=!1;this.fontCanvasInfo=""+this.fontSize+"pt ";if(0<this.fontFamilyName.length)this.fontCanvasInfo+=this.fontFamilyName;
else{for(var d=0;d<GPE_SUPPORTED_FONT_FORMAT_COUNT;d++)if(this.fontFileName[d],0<this.fontFileName[d].length&&0==a){this.fontCanvasInfo+=this.fontFileName[d];a=!0;break}0==a&&(this.fontCanvasInfo+="Arial")}};this.get_text_width=function(a){if(0<a.length){if(isMonoSpacedFont)return a.length*fontWidth}else return gpe.GPE_Current_Context.font=fFont.fontCanvasInfo,gpe.GPE_Current_Context.fillStyle=fontRenderColor,gpe.GPE_Current_Context.textBaseline="top",gpe.GPE_Current_Context.textAlign="left",metrics=
gpe.GPE_Current_Context.measureText(a),metrics.width};this.get_text_height=function(a){if(0<a.length){if(isMonoSpacedFont)return a.length*fontHeight}else return gpe.GPE_Current_Context.font=fFont.fontCanvasInfo,gpe.GPE_Current_Context.fillStyle=fontRenderColor,gpe.GPE_Current_Context.textBaseline="top",gpe.GPE_Current_Context.textAlign="left",metrics=gpe.GPE_Current_Context.measureText("M"),metrics.width*a.length};this.get_family=function(){return this.fontFamilyName};this.get_name=function(){return this.fontName};
this.get_size=function(a){return this.fontSize};this.is_mono_spaced=function(){return this.isMonoSpacedFont}}function M(){this.html5VideoSource=document.createElement("video");this.html5VideoSource.controls=!1;document.body.appendChild(this.html5VideoSource);this.videoIsLoaded=!1;this.videoId=this.videoCouldBePlayed=-1;this.videoFileName=[];this.actualVideoFileName="";this.videoName="unnamed";this.videoGroupName="";this.videoLoopsAround=!1;this.previousVolume=this.defaultVolume=100;this.videoLoadedInMemory=
this.videoWasPaused=this.videoWasStopped=!1;for(var e=0;e<GPE_SUPPORTED_VIDEO_FORMAT_COUNT;e++)this.videoFileName[e]="";this.check_video_state=function(){for(var a=!1,d=0;d<GPE_SUPPORTED_VIDEO_FORMAT_COUNT;d++)0<=GPE_AUDIO_PLAYABLE[d]&&3<this.videoFileName[d].length&&(a=!0);0==a&&(this.videoIsLoaded=!0);1!=this.videoIsLoaded&&2<=this.html5VideoSource.readyState&&(this.videoLoadedInMemory=this.videoIsLoaded=!0);return this.videoIsLoaded};this.check_is_playing=function(){return-1!=this.html5VideoSource?
!this.html5VideoSource.paused:!1};this.load_video=function(){-1==this.html5VideoSource&&(this.html5VideoSource=new Video,this.html5VideoSource.volume=this.defaultVolume);if(0==this.videoIsLoaded){this.actualVideoFileName="";var a=!1;this.videoCouldBePlayed=-1;for(var d=0;d<GPE_SUPPORTED_VIDEO_FORMAT_COUNT;d++)GPE_VIDEO_PLAYABLE[d]>this.videoCouldBePlayed&&3<this.videoFileName[d].length&&(this.actualVideoFileName=this.videoFileName[d],this.videoCouldBePlayed=GPE_VIDEO_PLAYABLE[d],addSourceToVideo(this.html5VideoSource,
this.videoFileName[d],GPE_AUD_TYPE_NAME[d]),a=!0);0==a&&(this.videoIsLoaded=!0);3<this.actualVideoFileName.length&&(this.html5VideoSource.addEventListener("canplaythrough",function(){this.videoLoadedInMemory=this.videoIsLoaded=!0}),this.html5VideoSource.src=this.actualVideoFileName)}};this.pause_video=function(){-1!=this.html5VideoSource&&1==this.videoLoadedInMemory&&(this.html5VideoSource.pause(),this.videoWasPaused=!0,this.videoWasStopped=!1);gpe.lastLoopedVideo==this.videoId&&(gpe.lastLoopedVideo=
-1)};this.play_video=function(a,d){this.load_video();"undefined"==typeof a&&(a=!1);"undefined"==typeof videoPlayingIsSkippable&&(d=!0);-1!=this.html5VideoSource&&(gpe.currentVideoPlaying=this.videoId,gpe.isPlayingVideo=!0,gpe.videoPlayingIsSkippable=d,1==this.videoIsLoaded&&1==this.videoLoadedInMemory?(this.html5VideoSource.paused?this.html5VideoSource.ended&&(this.html5VideoSource.currentTime=0):this.html5VideoSource.currentTime=.5,this.html5VideoSource.play()):2<=this.html5VideoSource.readyState?
(this.videoIsLoaded=!0,this.html5VideoSource.play()):this.html5VideoSource.oncanplay=function(){this.play()},this.videoWasStopped=this.videoWasPaused=!1,a?(GPE_SETTINGS_IS_DEBUGGING&&console.log("Playing Video["+this.videoId+"[ that loops"),gpe.lastLoopedVideo=this.videoId,this.html5VideoSource.addEventListener("ended",gpe.loop_last_video,!1)):(GPE_SETTINGS_IS_DEBUGGING&&console.log("Playing Video["+this.videoId+"] that doesnt loop"),this.html5VideoSource.addEventListener("ended",gpe.stop_last_video,
!1)))};this.process_playing_video=function(){if(-1!=this.html5VideoSource)if(this.videoWasStopped)gpe.exit_video_view_mode(),this.stop_video();else{if(this.html5VideoSource.ended||this.html5VideoSource.error)gpe.exit_video_view_mode(),this.stop_video()}else gpe.exit_video_view_mode()};this.render_video=function(a,d,c,e){-1!=this.html5VideoSource&&gpe.context.drawImage(this.html5VideoSource,0,0,this.html5VideoSource.videoWidth,this.html5VideoSource.videoHeight,a,d,c,e)};this.stop_video=function(){-1!=
this.html5VideoSource&&(this.html5VideoSource.currentTime=0,this.html5VideoSource.pause(),this.videoWasPaused=!1,this.videoWasStopped=!0);gpe.lastLoopedVideo==this.videoId&&(gpe.lastLoopedVideo=-1)}}function N(){this.randomVariableOn=IS_NULL;this.rAllImages=[];this.rTextures=[];this.rTilesheets=[];this.rAudio=[];this.rSprites=[];this.rBackgrounds=[];this.rFonts=[];this.rVideos=[];this.nameBackgrounds=[];this.SPRITE_COUNT=0;this.RESOURCES_ADDED=!1;this.spritesLoadedCount=this.texturesLoadedCount=0;
this.spritePercentage=50;this.percentLoaded=9;this.latestLoadMessage="";this.audioLoadedCount=0;this.audioIsReadyForLoading=!1;this.audioIsAllLoaded=this.texturesIsAlLoaded=this.spritesIsAllLoaded=0;this.check_resources_state=function(){if(-1!=this.RESOURCES_ADDED){var e;if(this.texturesLoadedCount!=this.rTextures.length)for(e=this.texturesLoadedCount=0;e<this.rTextures.length;e++){var a=this.rTextures[e];-1!=a&&"undefined"!=typeof a?a.check_texture_state()&&this.texturesLoadedCount++:this.texturesLoadedCount++}if(this.spritesLoadedCount!=
this.SPRITE_COUNT)for(e=this.spritesLoadedCount=0;e<z;e++)a=this.rSprites[e],-1!=a&&"undefined"!=typeof a&&-1!=a.imageObj&&"undefined"!=typeof a.imageObj&&(x(a.imageObj)?(a.imageObj.alt="true",this.spritesLoadedCount++,this.percentLoaded+=1/this.SPRITE_COUNT*this.spritePercentage):"failed"==a.imageObj.alt&&(a.imageObj.alt="failed",this.spritesLoadedCount++,this.percentLoaded+=1/this.SPRITE_COUNT*this.spritePercentage,console.log("Error loading sprite")));if(1==this.audioIsReadyForLoading&&this.audioLoadedCount!=
this.rAudio.length&&(this.audioLoadedCount=0,this.audioIsReadyForLoading))for(e=0;e<this.rAudio.length;e++)1==this.rAudio[e].check_audio_state()&&this.audioLoadedCount++;this.spritesLoadedCount==this.SPRITE_COUNT&&(this.spritesIsAllLoaded=1);this.texturesLoadedCount==this.rTextures.length&&(this.texturesIsAlLoaded=1);1==this.audioIsReadyForLoading&&this.audioLoadedCount==this.rAudio.length&&(this.audioIsAllLoaded=1);1==this.spritesIsAllLoaded&&1==this.texturesIsAlLoaded&&1==this.audioIsAllLoaded&&
(this.RESOURCES_ADDED=!0)}};this.sprite_add=function(e,a,d,c,g){};this.sprite_add_collision=function(e,a,d,c,g,b,f,k,h){};this.add_audio=function(e,a,d,c,g,b,f,k,h){var n=new K;n.id=e;n.audioId=e;0<a.length&&(n.audioName=a);n.audioFileName[GPE_AAC]=d;n.audioFileName[GPE_MP3]=c;n.audioFileName[GPE_OGG]=g;n.audioFileName[GPE_WAV]=b;n.audioType=f;n.audioGroupName=k;n.defaultVolume=h;n.load_audio();this.rAudio.push(n);return this.rAudio.length-1};this.add_font=function(e,a,d,c,g,b,f,k,h,n,p){var m=new L;
m.id=e;0<a.length&&(m.fontFamilyName=a);m.fontFileName[GPE_EOT]=d;m.fontFileName[GPE_SVG]=c;m.fontFileName[GPE_TTF]=g;m.fontFileName[GPE_WOFF]=b;m.fontFileName[GPE_WOFF2]=f;m.fontSize=k;m.estimatedWidth=h;m.estimatedHeight=n;m.isMonoSpacedFont=p;m.load_font();this.rFonts.push(m);return this.rFonts.length-1};this.add_sprite_empty=function(){this.rSprites.push(IS_NULL);this.SPRITE_COUNT+=1;return this.rSprites.length-1};this.add_sprite=function(e,a,d,c,g,b,f,k,h,n,p,m){var l=this.get_sprite(d);return l==
IS_NULL?(l=new O,l.maxSpriteFrames=a,l.spriteName=d,l.spriteWidth=b,l.spriteHeight=f,l.id=e,l.setId=e,4<d.length&&(e=this.load_new_image(d),l.update_sprite_data(e,c,g,b,f)),l.colX=h,l.colY=n,l.colShape=k,1==k?(l.colRadius=p,l.colWidth=p,l.colHeight=p):(l.colWidth=p,l.colHeight=m),this.rSprites.push(l),this.SPRITE_COUNT+=1,this.rSprites.length-1):l};this.add_spritesheet=function(e,a,d,c,g,b,f,k,h,n,p,m){return this.add_sprite(e,a,d,c,g,b,f,k,h,n,p,m)};this.add_video=function(e,a,d,c,g,b,f){var k=new M;
k.id=e;k.videoId=e;0<a.length&&(k.audioName=a);k.videoFileName[GPE_WEBM]=c;k.videoFileName[GPE_MP4]=d;k.videoFileName[GPE_VIDEO_OGG]=g;k.videoGroupName=b;k.defaultVolume=f;this.rVideos.push(k);return this.rVideos.length-1};this.edit_collision_box=function(e,a,d,c,g){};this.load_new_image=function(e){var a=this.get_game_image(e);-1==a&&(a=new Image,a.src=e,this.rAllImages.push(a));return a};this.load_new_texture=function(e,a){var d=this.get_texture(e);d==IS_NULL&&(d=new G,d.texId=a,d.imageSource=new Image,
d.imageSource.src=e,d.fileLocation=e,d.texId=a,0==this.rTextures.length?this.rTextures[0]=d:this.rTextures.push_back(d),this.texturesLoadedCount=0);return d};this.add_texture=function(e,a){var d=this.get_texture(a);return d==IS_NULL?(d=new G,d.imageSource=this.load_new_image(a),d.check_texture_state(),d.texId=e,d.fileLocation=a,this.rTextures.push(d),this.rTextures.length-1):d};this.add_tilesheet=function(e,a,d,c,g,b,f,k){var h=new P;h.id=e;h.tex=this.load_new_image(a);h.fileLocation=a;h.tWidth=d;
h.tHeight=c;h.hOff=g;h.vOff=b;h.hSep=f;h.vSep=k;h.update_tex_specs();this.rTilesheets.push(h);return this.rTilesheets.length-1};this.get_game_image=function(e){var a;if("number"==typeof e){if(0<=e&&e<this.rAllImages.length)return this.rAllImages[e];for(a=0;a<this.rAllImages.length;a++){var d=this.rAllImages[a];if(d.texId==e)return d}}else if("string"==typeof e)for(a=0;a<this.rAllImages.length;a++)if(d=this.rAllImages[a],d.id==e)return d;console.log("Unable to find: ["+e+"].");return IS_NULL};this.get_audio=
function(e){var a;if("number"==typeof idIn){if(0<=idIn&&idIn<this.rAudio.length)return idIn;for(a=this.rAudio.length-1;0<=a;a--)if(e=this.rAudio[a],e.audioId==idIn)return a}else if("string"==typeof idIn)for(a=this.rAudio.length-1;0<=a;a--)if(e=this.rAudio[a],e.audioName==idIn)return a;return IS_NULL};this.get_texture=function(e){var a;if("number"==typeof e){if(0<=e&&e<this.rTextures.length)return e;for(a=this.rTextures.length-1;0<=a;a--){var d=this.rTextures[a];if(d.texId==e)return a}}else if("string"==
typeof e)for(a=this.rTextures.length-1;0<=a;a--)if(d=this.rTextures[a],d.fileLocation==e||d.name==e)return a;return IS_NULL};this.get_tilesheet=function(e){var a;if("number"==typeof e){if(0<=e&&e<this.rTilesheets.length)return e;for(a=this.rTilesheets.length-1;0<=a;a--){var d=this.rTilesheets[a];if(d.texId==e)return a}}else if("string"==typeof e)for(a=this.rTilesheets.length-1;0<=a;a--)if(d=this.rTilesheets[a],d.fileLocation==e||d.name==e)return a;return IS_NULL};this.get_sprite=function(e){var a;
if("number"==typeof e){if(0<=e&&e<this.rSprites.length)return e;for(a=this.rSprites.length-1;0<=a;a--){var d=this.rSprites[a];if(d.texId==e)return a}}else if("string"==typeof e)for(a=this.rSprites.length-1;0<=a;a--)if(d=this.rSprites[a],d.fileLocation==e||d.name==e)return a;return IS_NULL};this.load_files=function(){};this.clean_up=function(){}}function Q(){this.stateName="ResourceLoader";this.imagesLoaded=0;this.spritesLoaded=this.audioLoaded=!1;this.percentLoaded=0;this.latestLoadMessage="";this.imagePercentage=
100;this.postLoadPauseTick=this.spritesPercentage=this.musicPercentage=0;this.postLoadPauseMax=5;this.loadingBegan=!1;this.imageStartLoadPos=0;this.gpeAppOpend=!1;this.apply_logic=function(){if(gpe.preload_completed())this.postLoadPauseTick+=1,this.postLoadPauseTick>=this.postLoadPauseMax&&(0==this.gpeAppOpend?(gpe.fileReader.open_file("js/gpe_app.js"),this.gpeAppOpend=!0):1==gpe.rsm.audioIsReadyForLoading&&w(t.STATE_MAINGAME));else{if(0==this.loadingBegan){z=GPE_PreloadImageResource.length;this.postLoadPauseTick+=
1;if(this.postLoadPauseTick>=this.postLoadPauseMax){this.postLoadPauseTick=0;var e=IS_NULL;0<=this.imageStartLoadPos&&this.imageStartLoadPos<z&&(e=new Image,e.onerror=function(){this.alt="failed";console.log("Failed to load image["+this.src+"]...")},e.src=GPE_PreloadImageResource[this.imageStartLoadPos],e.id=GPE_PreloadImageResource[this.imageStartLoadPos],e.alt="false",preloadedImages.push(e));this.imageStartLoadPos++}this.imageStartLoadPos>=z&&(this.loadingBegan=!0)}for(v=0;v<preloadedImages.length;v++)"false"==
preloadedImages[v].alt?x(preloadedImages[v])&&(preloadedImages[v].alt="true",this.imagesLoaded++,this.percentLoaded+=1/z*this.imagePercentage,gpe.rsm.rAllImages.push(preloadedImages[v])):"failed"==preloadedImages[v].alt&&(console.log("Failed to load ["+GPE_PreloadImageResource[v]+"] image."),preloadedImages[v].alt="failed",this.imagesLoaded++,this.percentLoaded+=1/z*this.imagePercentage,gpe.rsm.rAllImages.push(preloadedImages[v]));this.imagesLoaded==z&&(gpe.PRELOAD_COMPLETE=1)}};this.render_state=
function(){gpe.context.fillStyle="#333";gpe.context.fillRect(0,0,gpe.canvas.width,gpe.canvas.height);gpe.preload_completed()?(gpe.context.font="bold 24pt Calibri",gpe.context.textAlign="center",gpe.context.textBaseline="middle",gpe.context.fillStyle="#FFF",gpe.context.fillText("Starting Game...",gpe.canvas.width/2,gpe.canvas.height/2)):(gpe.context.font="bold 12pt Calibri",gpe.context.textAlign="center",gpe.context.textBaseline="top",gpe.context.fillStyle="#FFF",gpe.context.fillText("Now loading...["+
(this.percentLoaded|0)+"%]",gpe.canvas.width/2,gpe.canvas.height/2+32),0<z?(gpe.render_rectangle(0,gpe.canvas.height/2-32,this.percentLoaded/100*gpe.canvas.width,gpe.canvas.height/2,"blue",!1,4,!0),gpe.render_rectangle(0,gpe.canvas.height/2-32,this.percentLoaded/100*gpe.canvas.width,gpe.canvas.height/2,"white",!0,4,!0)):(gpe.context.font="bold 24pt Calibri",gpe.context.textAlign="center",gpe.context.textBaseline="middle",gpe.context.fillText("Loading...",gpe.canvas.width/2,gpe.canvas.height/2)))}}
function R(){this.optionName="";this.isUnlocked=!1}function S(){this.stateName="MainMenu";this.menuFont="bold 32pt Calibri";this.menuFooterFont="bold 18pt Calibri";this.naviSound=new Audio;this.naviSelectSound=new Audio;this.menuIcon;this.menuBackground=preloadedImages[2];this.menuSelectPos=2;this.menuFontColor="#FFF";this.menuHighLightFontColor="blue";this.menuLockedColor="rgb(128, 128, 128)";this.menuLockedHighLightColor="maroon";this.menuChoices=[];this.add_menu_option=function(e,a){var d=new R;
d.optionName=e;d.isUnlocked=a;this.menuChoices.push(d)};this.apply_logic=function(){var e=gpe.inputController.get_controller(1);-1!=e&&(e.check_button_released(gpe.cbi.UP_BUT)&&--this.menuSelectPos,e.check_button_released(gpe.cbi.DOWN_BUT)&&(this.menuSelectPos+=1));gpe.inputController.keyIsReleased[gp_w]&&--this.menuSelectPos;gpe.inputController.keyIsReleased[gp_s]&&(this.menuSelectPos+=1);gpe.inputController.keyIsReleased[gp_enter]&&w(t.STATE_MAINGAME);0>this.menuSelectPos&&(this.menuSelectPos=0);
this.menuSelectPos>=this.menuChoices.length&&(this.menuSelectPos=this.menuChoices.length-1)};this.render_state=function(){gpe.context.fillStyle="#333";gpe.context.fillRect(0,0,gpe.canvas.width,gpe.canvas.height);gpe.preload_completed()&&gpe.context.drawImage(this.menuBackground,0,0,gpe.canvas.width,gpe.canvas.height);gpe.context.font=this.menuFont;gpe.context.textAlign="center";for(var e,a=this.menuChoices.length-1;0<=a;a--)e=this.menuChoices[a],gpe.context.fillStyle=e.isUnlocked?this.menuSelectPos==
a?this.menuHighLightFontColor:this.menuFontColor:this.menuSelectPos==a?this.menuLockedHighLightColor:this.menuLockedColor,gpe.context.fillText(e.optionName,gpe.SCREEN_WIDTH/2,gpe.SCREEN_HEIGHT-64+64*(a-this.menuChoices.length));gpe.context.font=this.menuFooterFont;gpe.context.textAlign="right";gpe.context.fillStyle="#FFF";gpe.context.fillText("Version "+gpe.GPE_APP_VERSION_NUMBER.toFixed(1),gpe.SCREEN_WIDTH-32,gpe.SCREEN_HEIGHT-32);gpe.context.textAlign="center";gpe.context.fillText("Published By "+
gpe.GPE_APP_PUBLISHER,gpe.SCREEN_WIDTH/2,gpe.SCREEN_HEIGHT-48);gpe.context.fillText("Developed By "+gpe.GPE_APP_DEVELOPER,gpe.SCREEN_WIDTH/2,gpe.SCREEN_HEIGHT-16)};this.add_menu_option("Continue",0);this.add_menu_option("New Game",1);this.add_menu_option("Options",1);this.add_menu_option("Multiplayer",1);this.add_menu_option("Extras",0)}function T(e,a,d,c,g){this.OUT_OF_SIGHT_OUT_OF_PROCESSING=!0;this.GPE_APP_VERSION_NUMBER=this.GPE_VERSION_NUMBER=1;this.GPE_APP_DEVELOPER=GPE_GAME_DEVELOPER;this.GPE_APP_PUBLISHER=
GPE_GAME_PUBLISHER;this.SCREEN_WIDTH=e;this.SCREEN_HEIGHT=a;this.SCREEN2_WIDTH=d;this.SCREEN2_HEIGHT=c;this.originalScreenWidth=e;this.originalScreenHeight=a;this.screenScale=1;this.isInFullScreenMode=!1;this.fullScreenScale="aspect";this.fps=30;this.maxCameras=8;this.deviceType=g;this.currentState=this.MOUSE_SCALED_Y=this.MOUSE_SCALED_X=this.MOUSE_Y=this.MOUSE_X=0;this.canvasIsEnabled=!0;this.PRELOAD_COMPLETE=this.OBJECT_RENDER_CALLS=this.OBJECT_RENDER_CHECKS=0;this.EXTRA_CANVASES=[];this.EXTRA_CONTEXTS=
[];this.LEVEL_CURRENT_NAME="";this.exPlugins=[];this.EX_PLUGIN_COUNT=0;this.context=this.canvas=IS_NULL;this.currentCameraInView=0;this.CURRENT_VIEW=this.fileReader=this.rsm=this.inputController=this.preGuiContext=this.preGuiCanvas=this.mapContext=this.mapCanvas=this.GPE_Current_Context=IS_NULL;this.CURRENT_VIEW_BOX={xPos:0,yPos:0};this.currentVideoPlaying=this.lastLoopedVideo=this.lastLoopedTrack=-1;this.isPlayingVideo=!1;this.videoPlayingIsSkippable=!0;this.cbi={LEFT_BUT:0,RIGHT_BUT:1,UP_BUT:2,
DOWN_BUT:3,A_BUT:4,B_BUT:5,X_BUT:6,Y_BUT:7,START_BUT:8,SELECT_BUT:9,L_BUT:10,R_BUT:11,ZL_BUT:12,ZR_BUT:13,L2_BUT:14,L3_BUT:15,R2_BUT:16,R3_BUT:17,HOME_BUT:18,SHARE_BUT:19,EXT1_BUT:20,EXT2_BUT:21,EXT3_BUT:22,EXT4_BUT:23,EXT5_BUT:24};this.gpeScenes=[];this.gpeScenePos=0;this.cosValues=[];this.sinValues=[];this.tanValues=[];this.arcCosValues=[];this.arcSinValues=[];this.tarcTanValues=[];this.gamePaths=[];this.GPE_GamePath=function(b,c){function a(b,c){this.pathId=b;this.isClosedPath=c;this.pathPoints=
[];this.pathOriginalPoints=[];this.originalPathLength=this.pathLength=0}a.prototype.add_original_point=function(b,c,a){"number"!=typeof b&&(b=0);"number"!=typeof c&&(c=0);"number"==typeof a?0>=a&&(a=.1):a=1;b={pointX:b,pointY:c,pointRSpeed:a};this.pathOriginalPoints.push(b);this.pathPoints.push(b);this.originalPathLength++;this.pathLength++;return b};a.prototype.add_new_point=function(b,c,a){"number"!=typeof b&&(b=0);"number"!=typeof c&&(c=0);"number"==typeof a?0>=a&&(a=.1):a=1;b={pointX:b,pointY:c,
pointRSpeed:a};this.pathPoints.push(b);this.pathLength++;return b};a.prototype.insert_new_point=function(b,c,a,f){return"number"==typeof b&&0<=b&&b<this.pathLength?("number"!=typeof c&&(c=0),"number"!=typeof a&&(a=0),"number"==typeof f?0>=f&&(f=.1):f=1,c={pointX:c,pointY:a,pointRSpeed:f},this.pathPoints.insert(b,c),this.pathLength++,c):this.add_new_point(c,a,f)};a.prototype.get_point=function(b){return"number"==typeof b&&0<=b&&b<this.pathLength?this.pathPoints[b]:IS_NULL};a.prototype.get_size=function(){return this.pathLength};
a.prototype.restore_path=function(){this.pathPoints=[];for(var b=this.pathLength=0;b<this.originalPathLength;b++);this.pathLength=this.originalPathLength};return a}();this.add_path=function(b,c){var a=new gpe.GPE_GamePath(b,c);this.gamePaths.push(a);return a};this.create_path=function(b,c){if(c){var a=new gpe.GPE_GamePath(this.gamePaths.length,b);this.gamePaths.push(a)}else a=new gpe.GPE_GamePath(-1,b);return a};this.get_path=function(b){return"number"==typeof b&&0<=b&&b<this.gamePaths.length?this.gamePaths[b]:
IS_NULL};this.get_path_length=function(b){return"number"==typeof b&&0<=b&&b<this.gamePaths.length?this.gamePaths[b].pathLength:IS_NULL};this.get_path_original_length=function(b){return"number"==typeof b&&0<=b&&b<this.gamePaths.length?this.gamePaths[b].originalPathLength:IS_NULL};this.restore_path=function(b){"number"==typeof b&&0<=b&&b<this.gamePaths.length&&this.gamePaths[b].restore_path()};for(e=0;360>=e;e++)this.cosValues[e]=Math.cos(e*radiansMultiple),this.sinValues[e]=Math.sin(e*radiansMultiple),
this.tanValues[e]=Math.tan(e*radiansMultiple);this.abs=function(b){return"number"===typeof b?(0>b&&(b*=-1),b):0};this.bound_number=function(b,c,a){b<c?b=c:b>a&&(b=a);return b};this.cos=function(b){if(0>b)for(b*=-1;0>b;)b+=360;else if(360<b)for(;360<b;)b-=360;return this.cosValues[b|0]};this.degree=function(b){b*=degreesMultiple;return b+180};this.get_direction=function(b,c,a,d){return angle=Math.atan2(c-d,b-a)};this.get_distance=function(b,c,a,d){return b==a&&c==d?0:Math.sqrt(Math.pow(a-b,2)+Math.pow(d-
c,2))};this.get_random=function(b,c){return Math.random()*(c-b+1)+b|0};this.round=function(b){return b|0};this.sin=function(b){if(0>b)for(b*=-1;0>b;)b+=360;else if(360<b)for(;360<b;)b-=360;return this.sinValues[b|0]};this.tan=function(b){if(0>b)for(b*=-1;0>b;)b+=360;else if(360<b)for(;360<b;)b-=360;return 0<=b&360>=b?this.tanValues[b|0]:0};this.radian=function(b){return b=(b-180)*radiansMultiple};this.sign=function(b){return"number"===typeof b?b?0>b?-1:1:b===b?0:NaN:NaN};this.add_canvas=function(b,
c,a){var f=document.createElement("canvas");f.width=c;f.height=a;f.id=b;document.body.appendChild(f);return f};this.add_plugin=function(b){"undefined"!=typeof b&&(this.exPlugins[this.EX_PLUGIN_COUNT]=b,this.EX_PLUGIN_COUNT+=1)};this.apply_plugins_logics=function(){for(var b,c=0;c<gpe.exPlugins.size();c++)b=gpe.exPlugins.at(c),-1!=b&&b.process_plugin()};this.add_gamescene=function(b,c){var a=new U(b,c);this.gpeScenes.push(a);return a};this.audio_loop=function(b){this.play_audio(b,!0)};this.audio_play=
function(b,c){this.play_audio(b,c)};this.audio_playing=function(b){return this.is_audio_playing(b)};this.audio_stop_all=function(){this.stop_all_audio()};this.camera_on=function(b){return GPR.camera_on(b)};this.center_camera=function(b,c,a){GPR.center_camera(b,c,a)};this.check_collision_rect=function(b,c){var a=b.xPos,f=b.xPos+b.rectWidth,d=b.yPos,e=c.xPos,g=c.xPos+c.rectWidth,l=c.yPos+c.rectHeight;return!(b.yPos+b.rectHeight<=c.yPos||d>=l||f<=e||a>=g)};this.check_collision_with_rect=function(b,c,
a,d,e){var f=new u;f.update_shape(b,c,a,d);return this.check_collision_rect(e,f)};this.check_image_loading_status=function(b){return!b.complete||"undefined"!=typeof b.naturalWidth&&0==b.naturalWidth?!1:!0};this.gamepad_connected=function(b){return this.inputController.gamepad_connected(b)};this.gamepad_object=function(b){return this.inputController.gamepad_object(b)};this.gamepad_name=function(b){return this.inputController.gamepad_name(b)};this.find_gamepad_mapping=function(b,c){return this.inputController.gamepad_mapping(b,
c)};this.check_gamepad=function(b,c){return this.inputController.check_gamepad_down(b,c)};this.check_gamepad_down=function(b,c){return this.inputController.check_gamepad_down(b,c)};this.check_gamepad_pressed=function(b,c){return this.inputController.check_gamepad_pressed(b,c)};this.check_gamepad_released=function(b,c){return this.inputController.check_gamepad_released(b,c)};this.check_keyboard=function(b){return this.inputController.check_keyboard_down(b)};this.check_keyboard_down=function(b){return this.inputController.check_keyboard_down(b)};
this.check_keyboard_pressed=function(b){return this.inputController.check_keyboard_pressed(b)};this.check_keyboard_released=function(b){return this.inputController.check_keyboard_released(b)};this.check_mouse=function(b){return this.inputController.check_mouse_down(b)};this.check_mouse_down=function(b){return this.inputController.check_mouse_down(b)};this.check_mouse_pressed=function(b){return this.inputController.check_mouse_pressed(b)};this.check_mouse_released=function(b){return this.inputController.check_mouse_released(b)};
this.disable_camera=function(b){GPR.disable_camera(b)};this.disable_canvas=function(){this.canvasIsEnabled=!1;this.canvas.className="hide"};this.disable_outofsightmode=function(){this.OUT_OF_SIGHT_OUT_OF_PROCESSING=!1};this.enable_outofsightmode=function(){this.OUT_OF_SIGHT_OUT_OF_PROCESSING=!0};this.enable_camera=function(b){GPR.enable_camera(b)};this.enable_canvas=function(){this.canvasIsEnabled=!0;this.canvas.className="show"};this.enter_render=function(){gpe.GPE_Current_Context=gpe.context;0==
gpe.isPlayingVideo&&0!=gpe.currentState&&gpe.currentState.render_state();this.render_top_hud();C=window.countFPS()};this.erase_data=function(b,c){"undefined"!==typeof Storage&&localStorage.removeItem(b+"_"+c)};this.exit_video_view_mode=function(){gpe.isPlayingVideo=!1;gpe.currentVideoPlaying=-1};this.find_furthest_object=function(b,c,a,d){return GPR.find_furthest_object(b,c,a,d)};this.find_nearest_object=function(b,c,a,d){return GPR.find_nearest_object(b,c,a,d)};this.get_camera_height=function(b){return GPR.get_camera_height(b)};
this.get_camera_info=function(b){return GPR.get_camera_info(b)};this.get_camera_width=function(b){return GPR.get_camera_width(b)};this.get_camera_x=function(b){return GPR.get_camera_x(b)};this.get_camera_y=function(b){return GPR.get_camera_y(b)};this.get_camera_mouse_x=function(b){return GPR.get_camera_mouse_x(b)};this.get_camera_mouse_y=function(b){return GPR.get_camera_mouse_y(b)};this.get_camera_screen_height=function(b){return GPR.get_camera_screen_height(b)};this.get_camera_screen_width=function(b){return GPR.get_camera_screen_width(b)};
this.get_camera_screen_x=function(b){return GPR.get_camera_screen_x(b)};this.get_camera_screen_y=function(b){return GPR.get_camera_screen_y(b)};this.get_current_camera=function(){return this.currentCameraInView};this.get_current_camera_id=function(){return this.currentCameraInView};this.handle_canvas_size=function(){gpe.canvasIsEnabled?E==t.STATE_MAINGAME?1==GPE_GAME_SCALING_SETTING?(gpe.canvas.width=GPE_SETTINGS_SCREEN_WIDTH/2,gpe.canvas.height=GPE_SETTINGS_SCREEN_HEIGHT/2,gpe.masterScaleX=.5,gpe.masterScaleY=
.5):2==GPE_GAME_SCALING_SETTING?(gpe.canvas.width=2*GPE_SETTINGS_SCREEN_WIDTH,gpe.canvas.height=2*GPE_SETTINGS_SCREEN_HEIGHT,gpe.masterScaleX=2,gpe.masterScaleY=2):3==GPE_GAME_SCALING_SETTING?(gpe.canvas.height=window.innerHeight,gpe.canvas.width=GPE_SETTINGS_SCREEN_WIDTH/GPE_SETTINGS_SCREEN_HEIGHT*window.innerHeight,gpe.masterScaleX=gpe.canvas.width/GPE_SETTINGS_SCREEN_WIDTH,gpe.masterScaleY=gpe.canvas.height/GPE_SETTINGS_SCREEN_HEIGHT):4==GPE_GAME_SCALING_SETTING?(gpe.canvas.height=window.innerHeight,
gpe.canvas.width=window.innerWidth,gpe.masterScaleX=gpe.canvas.width/GPE_SETTINGS_SCREEN_WIDTH,gpe.masterScaleY=gpe.canvas.height/GPE_SETTINGS_SCREEN_HEIGHT):(gpe.canvas.height=GPE_SETTINGS_SCREEN_HEIGHT,gpe.canvas.width=GPE_SETTINGS_SCREEN_WIDTH,gpe.masterScaleX=1,gpe.masterScaleY=1):(gpe.canvas.height=window.innerHeight,gpe.canvas.width=window.innerWidth,gpe.masterScaleX=gpe.canvas.width/GPE_SETTINGS_SCREEN_WIDTH,gpe.masterScaleY=gpe.canvas.height/GPE_SETTINGS_SCREEN_HEIGHT):(gpe.canvas.height=
0,gpe.canvas.width=0,gpe.masterScaleX=1,gpe.masterScaleY=1)};this.load_data=function(b,c){if("undefined"!==typeof Storage){var a=localStorage.getItem(b+"_"+c);return null==a?IS_NULL:a}return IS_NULL};this.GPE_GameObject=function(b,c,a){function f(b,c,a){this.foundPathObject=this.pathId=-1;this.pathTargetPosition=this.pathTargetY=this.pathTargetX=this.pathRelativeY=this.pathRelativeX=this.pathPosition=0;this.pathReplayOnEnd=!0;this.pathCurrentDirection=this.pathCurrentSpeed=this.pathSpeed=0;this.pathGoingForward=
!0;this.sceneLayerStartPos=this.sceneLayerPos=a;this.customComponents={};this.spriteId=this.gpeSceneStartId=IS_NULL;this.outlineTestColor="lime";this.gpeObjectType=this.objectDepthPosition=this.prevObjectDepth=this.objectDepth=0;this.gpeUniqGameObjectId=-1;this.hasPreRenderFunction=this.gpeAddedToContinuousList=this.gpeAddedToRenderList=this.gpePrelogicAppliedInFrame=this.gpeLogicAppliedInFrame=this.GPE_AddedToGridSystem=!1;this.hasRenderFunction=!0;this.gpeSceneStartCodeUsed=this.gpeHasLogicFunction=
this.gpeHasStartLogicFunction=this.hasHudRenderFunction=this.gpeHasTimedFunctions=this.hasPostRenderFunction=!1;this.prerenderedInFrame=[];this.renderedInFrame=[];this.renderedAboveInFrame=[];this.hudrenderedInFrame=[];for(a=0;a<gpe.maxCameras;a++)this.prerenderedInFrame[a]=!1,this.renderedInFrame[a]=!1,this.renderedAboveInFrame[a]=!1,this.hudrenderedInFrame[a]=!1;this.collisionBox=new u;this.collisionBox.update_shape(b,c,32,32);this.isOutsideScene=!1;this.lastCollisionObjId=-1;this.applyGravity=
!0;this.gravityDirection=270;this.imageSpeed=this.spriteFrame=this.gravityEffect=0;this.isVisible=this.animationEnded=!1;this.xPos=this.xBegin=b;this.x2Pos=b+32;this.yPos=this.yBegin=c;this.y2Pos=c+32;this.animationDuration=this.defaultSpeed=this.speed=this.direction=this.yspeed=this.xspeed=this.y2Past=this.yPast=this.x2Past=this.xPast=this.yVel=this.xVel=this.yEnd=this.xEnd=0;this.gpeIsBeingDestroyed=!1;this.isInit=!0;this.isViewIndependent=!1;this.isInView=[];this.timeToCheckForInView=[];for(b=
b=0;b<gpe.maxCameras;b++)this.isInView[b]=!1,this.timeToCheckForInView[b]=0;this.functionTimer=[];for(b=0;10>=b;b++)this.functionTimer[b]=0;this.timedFunction0=function(){};this.timedFunction1=function(){};this.timedFunction2=function(){};this.timedFunction3=function(){};this.timedFunction4=function(){};this.timedFunction5=function(){};this.timedFunction6=function(){};this.timedFunction7=function(){};this.timedFunction8=function(){};this.timedFunction9=function(){};this.timedFunction10=function(){};
this.OBJECT_COLLISION_LIST=[];this.SPATIAL_PARTITION_LIST=[];this.GPE_SearchForCollisionBegin=0;this.under_mouse=function(b){if("undefined"==typeof b)b=0;else if(0>b||b>=gpe.maxCameras)b=0;return GPR.MOUSE_CAM_X[b]>=this.xPos&&GPR.MOUSE_CAM_X[b]<=this.x2Pos&&GPR.MOUSE_CAM_Y[b]>=this.yPos&&GPR.MOUSE_CAM_Y[b]<=this.y2Pos?!0:!1}}f.prototype.add_object=function(b,c,a){return GPE.add_new_object(b,c,a,this.sceneLayerStartPos)};f.prototype.bounce_from=function(b){};f.prototype.collide_with=function(b){};
f.prototype.initialize=function(){this.default_load()};f.prototype.equals=function(b){return"undefined"!=typeof b?b.gpeObjectType==this.gpeObjectType&&b.gpeUniqGameObjectId==this.gpeUniqGameObjectId?!0:!1:-1};f.prototype.default_load=function(){this.lastCollisionObjId=this.spriteId=IS_NULL;this.applyGravity=!0;this.gravityDirection=270;this.imageSpeed=this.spriteFrame=this.gravityEffect=0;this.isVisible=this.animationEnded=!1;this.animationDuration=this.defaultSpeed=this.speed=this.direction=this.yspeed=
this.xspeed=this.y2Past=this.x2Past=this.yPast=this.xPast=this.yVel=this.xVel=this.yEnd=this.xEnd=0;this.gpeUniqGameObjectId=-1;this.SPATIAL_PARTITION_LIST=[]};f.prototype.get_component=function(b){b=this.customComponents[b];return"undefined"!=typeof b?b:IS_NULL};f.prototype.gpe_constructor=function(){this.default_load()};f.prototype.get_depth=function(){return this.objectDepth};f.prototype.get_collision_height=function(){return this.collisionBox.rectHeight};f.prototype.get_collision_width=function(){return this.collisionBox.rectWidth};
f.prototype.get_my_direction=function(b,c){return gpe.get_direction(this.collisionBox.xPos,this.collisionBox.yPos,b,c)};f.prototype.get_my_distance=function(b,c){return gpe.get_distance(this.collisionBox.xPos,this.collisionBox.yPos,b,c)};f.prototype.get_sprite=function(){return this.spriteId};f.prototype.getx=function(){return this.xPos};f.prototype.getx2=function(){return this.x2Pos};f.prototype.gety=function(){return this.yPos};f.prototype.gety2=function(){return this.y2Pos};f.prototype.end_frame_logic=
function(){};f.prototype.gravity_use=function(){if(0!=this.gravityEffect||0!=this.vspd)270==this.gravityDirection?this.yspeed+=this.gravityEffect:90==this.gravityDirection?this.yspeed-=this.gravityEffect:(this.xspeed+=Math.cos(this.gravityDirection)*this.gravityEffect,this.yspeed+=Math.sin(this.gravityDirection)*this.gravityEffect,this.move_right(this.xspeed)),this.move_down(this.yspeed)};f.prototype.init_sprite=function(b){"number"==typeof b&&(this.spriteId=b,this.spriteFrame=0,0<=this.spriteId&&
this.spriteId<gpe.rsm.rSprites.length?(b=gpe.rsm.rSprites[this.spriteId],this.collisionBox.update_shape(this.xPos+b.colX,this.yPos+b.colY,b.colWidth,b.colHeight),this.x2Pos=this.xPos+b.colX+b.colWidth,this.y2Pos=this.yPos+b.colY+b.colHeight):(this.collisionBox.update_shape(this.xPos,this.yPos,32,32),this.x2Pos=this.xPos+32,this.y2Pos=this.yPos+32),this.x2Past=this.x2Pos,this.y2Past=this.y2Pos)};f.prototype.make_view_dependent=function(){if(this.isViewIndependent){this.isViewIndependent=!1;var b=this.currentScene.get_layer(this.sceneLayerPos,
GPE_LAYER_TYPE_OBJECTS);if(-1!=b)for(var c=b.independentObjects.length-1;0<=c;c--){var a=b.independentObjects[c];a.gpeUniqGameObjectId==this.gpeUniqGameObjectId&&b.independentObjects.splce(c)}}};f.prototype.make_view_independent=function(){if(!this.isViewIndependent){this.isViewIndependent=!0;var b=this.currentScene.get_layer(this.sceneLayerPos,GPE_LAYER_TYPE_OBJECTS);-1!=b&&b.independentObjects.push(this)}};f.prototype.move_left=function(b){this.collisionBox.add_x(-b);this.xPos-=b;this.x2Pos-=b;
GPR.update_object_in_map(this)};f.prototype.move_right=function(b){this.collisionBox.add_x(b);this.xPos+=b;this.x2Pos+=b;GPR.update_object_in_map(this)};f.prototype.move_up=function(b){this.collisionBox.add_y(-b);this.yPos-=b;this.y2Pos-=b;GPR.update_object_in_map(this)};f.prototype.move_down=function(b){this.collisionBox.add_y(b);this.yPos+=b;this.y2Pos+=b;GPR.update_object_in_map(this)};f.prototype.move_towards=function(b,c,a){"number"==typeof b&&"number"==typeof c&&"number"==typeof a?(this.direction=
this.get_my_direction(b,c),this.speed=a):this.direction=this.speed=0};f.prototype.path_begin=function(b,c,a,f){var d=IS_NULL;"number"==typeof b?d=GPE.get_path(b):"Object"==typeof b&&(d=b);"number"!=typeof c&&(c=1);"bool"!=typeof a&&(a=!0);"bool"!=typeof f&&(f=!1);d!=IS_NULL&&(this.pathId=d.pathId,this.foundPathObject=d,this.pathRelativeY=this.pathRelativeX=this.pathPosition=0,this.pathSpeed=Math.abs(c),this.pathCurrentSpeed=Math.abs(c),this.pathReplayOnEnd=a,1<d.pathPoints.length?f?(this.pathRelativeX=
d.pathPoints[0].pointX-this.collisionBox.xCenter,this.pathRelativeY=d.pathPoints[0].pointY-this.collisionBox.yMiddle,0<=c?(this.pathPosition=d.pathPoints.length-1,this.path_move_towards_point(1),this.pathGoingForward=!0):(this.path_move_towards_point(d.pathPoints.length-1),this.pathGoingForward=!1)):0<=c?(this.pathPosition=d.pathPoints.length-1,this.path_move_towards_point(0),this.pathGoingForward=!0):(this.path_move_towards_point(d.pathPoints.length-1),this.pathGoingForward=!1):console.log("Path does not have enough points to begin..."))};
f.prototype.path_start=function(b,c,a,f){this.path_begin(b,c,a,f)};f.prototype.path_move_along=function(){return!1};f.prototype.path_move_towards_point=function(b){if(this.foundPathObject!=IS_NULL&&"number"==typeof b&&0<=b&&b<this.foundPathObject.pathPoints.length)return this.pathTargetX=this.foundPathObject.pathPoints[b].pointX-this.pathRelativeX,this.pathTargetY=this.foundPathObject.pathPoints[b].pointY-this.pathRelativeY,this.pathCurrentDirection=this.get_my_direction(this.pathTargetX,this.pathTargetY),
this.pathCurrentSpeed=this.foundPathObject.pathPoints[b].pointRSpeed*this.pathSpeed,this.pathTargetPosition=b,!0;this.pathCurrentDirection=this.pathCurrentSpeed=this.pathTargetPosition=this.pathPosition=0;return!1};f.prototype.path_end=function(){this.pathId=-1;this.foundPathObject=IS_NULL;this.pathRelativeY=this.pathRelativeX=this.pathPosition=0;this.pathReplayOnEnd=!0;this.pathTargetY=this.pathTargetX=this.pathCurrentSpeed=this.pathSpeed=0};f.prototype.path_stop=function(){this.pathId=-1;this.foundPathObject=
IS_NULL;this.pathRelativeY=this.pathRelativeX=this.pathPosition=0;this.pathReplayOnEnd=!0;this.pathTargetY=this.pathTargetX=this.pathCurrentSpeed=this.pathSpeed=0};f.prototype.using_path=function(){return-1!=this.pathId&&this.foundPathObject!=IS_NULL?!0:!1};f.prototype.get_path_id=function(){return this.pathId};f.prototype.get_path_object=function(){return this.foundPathObject};f.prototype.get_path_targetx=function(){return this.pathTargetX};f.prototype.get_path_targety=function(){return this.pathTargetY};
f.prototype.get_path_position=function(){return this.pathPosition};f.prototype.get_path_original_size=function(){this.foundPathObject!=IS_NULL&&this.foundPathObject.originalPathLength;return-1};f.prototype.get_path_size=function(){this.foundPathObject!=IS_NULL&&this.foundPathObject.pathLength;return-1};f.prototype.perform_object_logic=function(){};f.prototype.perform_object_prelogic=function(){this.xPast=this.collisionBox.xPos;this.yPast=this.collisionBox.yPos;this.x2Past=this.collisionBox.x2Pos;
this.y2Past=this.collisionBox.y2Pos;this.gpeLogicAppliedInFrame=!1;for(var b=gpe.maxCameras-1;0<=b;b--)this.prerenderedInFrame[b]=!1,this.renderedInFrame[b]=!1,this.hudrenderedInFrame[b]=!1;this.gpeAddedToRenderList=!1};f.prototype.process_gpe_movement=function(){if("number"==typeof this.pathCurrentSpeed&&0<this.pathCurrentSpeed)this.get_my_distance(this.pathTargetX,this.pathTargetY)>2*this.pathCurrentSpeed?(this.move_left(Math.cos(this.pathCurrentDirection)*this.pathCurrentSpeed),this.move_up(Math.sin(this.pathCurrentDirection)*
this.pathCurrentSpeed)):this.pathGoingForward?(this.pathPosition=this.pathTargetPosition,this.pathTargetPosition+1<this.foundPathObject.pathPoints.length-1?this.path_move_towards_point(this.pathTargetPosition+1):this.pathReplayOnEnd?this.foundPathObject.isClosedPath?this.path_move_towards_point(0):(this.path_move_towards_point(this.foundPathObject.pathPoints.length-1),this.pathGoingForward=!1):this.path_end()):0<=this.pathTargetPosition-1&&this.pathTargetPosition-1<this.foundPathObject.pathPoints.length-
1?this.path_move_towards_point(this.pathTargetPosition-1):this.pathReplayOnEnd?this.foundPathObject.isClosedPath?this.path_move_towards_point(this.foundPathObject.pathPoints.length-1):(this.path_move_towards_point(0),this.pathGoingForward=!0):this.path_end();else if("number"==typeof this.speed&&0!=this.speed){this.xspeed=Math.cos(this.direction)*this.speed;this.yspeed=Math.sin(this.direction)*this.speed;this.move_left(this.xspeed);this.move_up(this.yspeed);return}this.speed=0};f.prototype.process_timed_functions=
function(){0<this.functionTimer[0]&&0>=--this.functionTimer[0]&&(this.functionTimer[0]=-1,this.timedFunction0());0<this.functionTimer[1]&&0>=--this.functionTimer[1]&&(this.functionTimer[1]=-1,this.timedFunction1());0<this.functionTimer[2]&&0>=--this.functionTimer[2]&&(this.functionTimer[2]=-1,this.timedFunction2());0<this.functionTimer[3]&&0>=--this.functionTimer[3]&&(this.functionTimer[3]=-1,this.timedFunction3());0<this.functionTimer[4]&&0>=--this.functionTimer[4]&&(this.functionTimer[4]=-1,this.timedFunction4());
0<this.functionTimer[5]&&0>=--this.functionTimer[5]&&(this.functionTimer[5]=-1,this.timedFunction5());0<this.functionTimer[6]&&0>=--this.functionTimer[6]&&(this.functionTimer[6]=-1,this.timedFunction6());0<this.functionTimer[7]&&0>=--this.functionTimer[7]&&(this.functionTimer[7]=-1,this.timedFunction7());0<this.functionTimer[8]&&0>=--this.functionTimer[8]&&(this.functionTimer[8]=-1,this.timedFunction8());0<this.functionTimer[9]&&0>=--this.functionTimer[9]&&(this.functionTimer[9]=-1,this.timedFunction9());
0<this.functionTimer[10]&&0>=--this.functionTimer[10]&&(this.functionTimer[10]=-1,this.timedFunction10())};f.prototype.render_above=function(){};f.prototype.render_under=function(){};f.prototype.render_hud=function(){};f.prototype.render_self=function(){gpe.preload_completed()&&0<=this.spriteId?(gpe.OBJECT_RENDER_CALLS+=1,gpe.render_sprite(this.spriteId,this.spriteFrame,this.xPos,this.yPos,1,1)):GPE_DRAW_OBJECT_BOXES&&gpe.render_rectangle(this.collisionBox.xPos,this.collisionBox.yPos,this.collisionBox.x2Pos,
this.collisionBox.y2Pos,"blue",!0,1);gpe.render_calls++};f.prototype.scene_end=function(){};f.prototype.scene_start=function(){};f.prototype.self_destruct=function(){if(0==this.gpeIsBeingDestroyed){this.self_obliterate();this.gpeIsBeingDestroyed=!0;GPR.add_object_to_deletion_list(this);var b=GPR.GAME_OBJECTS[this.gpeObjectType];var c=IS_NULL;for(var a=!1,f=GPR.currentScene.sceneLayers.length-1;0<=f;f--)if(c=GPR.currentScene.sceneLayers[f],c.layerId==this.sceneLayerPos){a=!0;break}a?c.remove_object(this):
console.log("unable to find matching layer to delete from...");for(a=b.length-1;0<=a;a--)if(c=b[a],c.gpeUniqGameObjectId==this.gpeUniqGameObjectId){b.splice(a,1);break}}};f.prototype.set_depth=function(b){};f.prototype.self_obliterate=function(){};f.prototype.set_sprite=function(b){"number"==typeof this.spriteId&&this.spriteId!=b&&(this.spriteId=b,this.spriteFrame=0,0<=this.spriteId&&this.spriteId<gpe.rsm.rSprites.length?(b=gpe.rsm.rSprites[this.spriteId],this.collisionBox.update_shape(this.xPos+
b.colX,this.yPos+b.colY,b.colWidth,b.colHeight),this.x2Pos=this.xPos+b.colX+b.colWidth,this.y2Pos=this.yPos+b.colY+b.colHeight):(this.collisionBox.update_shape(this.xPos,this.yPos,32,32),this.x2Pos=this.xPos+32,this.y2Pos=this.yPos+32),this.x2Past=this.x2Pos,this.y2Past=this.y2Pos,GPR.update_object_in_map(this))};f.prototype.setx=function(b){if(0<=this.spriteId&&this.spriteId<gpe.rsm.rSprites.length){var c=gpe.rsm.rSprites[this.spriteId];this.collisionBox.set_x(b+c.colX);this.x2Pos=this.xPos+c.colX+
c.colWidth}else this.collisionBox.set_x(b);this.xPos=b;this.x2Pos=b+32;GPR.update_object_in_map(this)};f.prototype.sety=function(b){if(0<=this.spriteId&&this.spriteId<gpe.rsm.rSprites.length){var c=gpe.rsm.rSprites[this.spriteId];this.collisionBox.set_y(newX+c.colY);this.y2Pos=this.yPos+c.colY+c.colHeight}else this.collisionBox.set_y(b),this.y2Pos=b+32;this.yPos=b;GPR.update_object_in_map(this)};f.prototype.speed_move=function(){};f.prototype.set_velocity=function(b,c){-0==b&&(b=0);"number"==typeof b&&
(this.direction=b,"number"==typeof c&&(this.speed=c))};f.prototype.start_countdown=function(b,c){0<=b&&10>=b&&"number"==typeof c&&(this.functionTimer[b]=c)};f.prototype.set_countdown=function(b,c){0<=b&&10>=b&&"number"==typeof c&&(this.functionTimer[b]=c)};f.prototype.start_frame_logic=function(){};f.prototype.set_timer=function(b,c){0<=b&&10>=b&&"number"==typeof c&&(this.functionTimer[b]=60*c)};f.prototype.start_timer=function(b,c){0<=b&&10>=b&&"number"==typeof c&&(this.functionTimer[b]=60*c)};f.prototype.update_animation=
function(b){0<=this.spriteId&&this.spriteId<gpe.rsm.rSprites.length&&(b=gpe.rsm.rSprites[this.spriteId],1<b.frameCount&&(this.spriteFrame+=this.imageSpeed,this.spriteFrame>=b.frameCount-1&&(this.spriteFrame=0),0>this.spriteFrame&&(this.spriteFrame=b.frameCount-2)))};f.prototype.under_mouse=function(b){};f.prototype.update_cords=function(b,c){this.xPos=b;this.yPos=c;if(0<=this.spriteId&&this.spriteId<gpe.rsm.rSprites.length){var a=gpe.rsm.rSprites[this.spriteId];this.collisionBox.update_position(b+
a.colX,c+a.colY);this.collisionBox.update_size(a.colWidth,a.colHeight);this.x2Pos=this.xPos+a.colX+a.colWidth;this.y2Pos=this.yPos+a.colY+a.colHeight}else this.collisionBox.update_position(b,c),this.collisionBox.update_position(32,32),this.x2Pos=b+32,this.y2Pos=c+32;GPR.update_object_in_map(this)};f.prototype.touches_tile=function(b){return GPR.find_tile_in_box(b,this.xPos,this.yPos,this.x2Pos,this.y2Pos)};f.prototype.touches_certain_tile=function(b,c){return GPR.find_matching_tile_in_box(b,this.xPos,
this.yPos,this.x2Pos,this.y2Pos,c)};return f}();this.SuperSpatialPartition=function(){function b(){this.internalArray=[];this.heldObjectsArray=[];this.objectsHeld=0;this.boxArea=new u;this.spaceName="CAS_X2015_";for(var b=0;b<GPE_MAX_OBJECT_TYPES;b++)this.heldObjectsArray[b]=[]}b.prototype.add_object=function(b){this.internalArray[this.objectsHeld]=b;this.heldObjectsArray[b.gpeObjectType].push_back(b);this.objectsHeld+=1};b.prototype.empty_list=function(){for(var b=this.objectsHeld=this.internalArray.length=
0;b<GPE_MAX_OBJECT_TYPES;b++)this.heldObjectsArray[b]=[]};b.prototype.remove_held_object=function(b){if("undefined"!=typeof b){for(var c,a=this.internalArray.length-1;0<=a;a--)c=this.internalArray[a],c.gpeUniqGameObjectId==b.gpeUniqGameObjectId&&(this.internalArray.splice(a,1),--this.objectsHeld);a=this.heldObjectsArray[b.gpeObjectType];for(var f=a.length-1;0<=f;f--)c=a[f],c.gpeUniqGameObjectId==b.gpeUniqGameObjectId&&this.heldObjectsArray[b.gpeObjectType].splice(f,1)}};b.prototype.set_space=function(b,
c,a,d){this.boxArea.update_shape(b,c,a,d)};return b}();this.find_last_object=function(b){return GPR.find_last_object(b)};this.getfps=function(){return C};this.get_fps=function(){return C};this.get_mouse_x=function(){return this.MOUSE_SCALED_X};this.get_mouse_y=function(){return this.MOUSE_SCALED_Y};this.get_object_count=function(b){return GPR.get_object_count(b)};this.get_object_in_view_count=function(b){return 0<=b&&b<GPE_MAX_OBJECT_TYPES?GPR.get_object_in_view_count(b):0};this.find_tile=function(b,
c,a){return GPR.find_tile(b,c,a)};this.find_tile_in_box=function(b,c,a,d,e){return GPR.find_tile_in_box(b,c,a,d,e)};this.find_matching_tile=function(b,c,a,d){return GPR.find_matching_tile(b,c,a,d)};this.find_matching_tile_in_box=function(b,c,a,d,e,g){return GPR.find_tile_in_box(b,c,a,d,e,g)};this.get_current_scene_id=function(){return GPR.currentSceneId};this.get_current_scene_name=function(){return this.get_scene_name(GPR.currentSceneId)};this.get_scene_height=function(b){return"number"===typeof b&&
0<=b&&b<this.gpeScenes.length?this.gpeScenes[sceneIdNumber].sceneHeight:GPR.get_scene_height()};this.get_scene_name=function(b){return"number"===typeof b&&0<=b&&b<this.gpeScenes.length?this.gpeScenes[sceneIdNumber].sceneName:this.get_current_scene_name()};this.get_scene_width=function(b){return"number"===typeof b&&0<=b&&b<this.gpeScenes.length?this.gpeScenes[sceneIdNumber].sceneWidth:GPR.get_scene_width()};this.scene_enter_named=function(b){for(var c=this.gpeScenes.length-1;0<=c;c--)if(this.gpeScenes[c].sceneName==
b)return GPR.scene_enter(c),!0;return!1};this.scene_enter=function(b){return GPR.scene_enter(b)};this.scene_enter_next=function(){return GPR.scene_enter_next()};this.scene_enter_previous=function(){return GPR.scene_emter_previous()};this.scene_reset=function(b){GPR.scene_reset(b)};this.get_sprite_width=function(b){return"number"==typeof b&&(b|=0,0<=b&&b<gpe.rsm.rSprites.length)?gpe.rsm.rSprites[b].spriteWidth:0};this.get_sprite_height=function(b){return"number"==typeof b&&(b|=0,0<=b&&b<gpe.rsm.rSprites.length)?
gpe.rsm.rSprites[b].spriteHeight:0};this.get_sprite_length=function(b){return"number"==typeof b&&(b|=0,0<=b&&b<gpe.rsm.rSprites.length)?gpe.rsm.rSprites[b].frameCount:0};this.get_sprite_object=function(b){return"number"==typeof b&&(b|=0,0<=b&&b<gpe.rsm.rSprites.length)?gpe.rsm.rSprites[b]:IS_NULL};this.get_texture_width=function(b){return"number"==typeof b&&(b|=0,0<=b&&b<gpe.rsm.rSprites.length)?gpe.rsm.rTextures[b].texWid:0};this.get_texture_height=function(b){return"number"==typeof b&&(b|=0,0<=
b&&b<gpe.rsm.rSprites.length)?gpe.rsm.rTextures[b].texHeight:0};this.find_newest_object=function(b){return GPR.find_newest_object(b)};this.find_collision_rectangle=function(b,c,a,d,e){return GPR.find_collision_rectangle(b,c,a,d,e)};this.game_reset=function(){GPR.game_reset();location.reload()};this.is_audio_playing=function(b){if("undefined"!=typeof b)return 0<=b&&b<this.rsm.rAudio.length&&(b=this.rsm.rAudio[b|0],-1!=b)?b.check_is_playing():!1};this.is_video_playing=function(b){if("undefined"!=typeof b)return 0<=
b&&b<this.rsm.rVideos.length&&(b=this.rsm.rVideos[b],-1!=b)?b.check_is_playing():!1};this.loop_last_track=function(){gpe.play_audio(gpe.lastLoopedTrack,!0)};this.loop_last_video=function(){gpe.play_video(gpe.lastLoopedVideo,!0)};this.make_array_unique=function(b){return b.reduce(function(b,c){0>b.indexOf(c)&&b.push(c);return b},[])};this.move_camera=function(b,c,a){GPR.move_camera(b,c,a)};this.pause_audio=function(b){"undefined"!=typeof b&&0<=b&&b<this.rsm.rAudio.length&&(b=this.rsm.rAudio[b|0],-1!=
b&&b.pause_audio())};this.pause_all_audio=function(){for(var b=this.rsm.rAudio.length-1;0<=b;b--){var c=this.rsm.rAudio[b];-1!=c&&c.pause_audio()}};this.loop_audio=function(b){"undefined"!=typeof b&&0<=b&&b<this.rsm.rAudio.length&&(b=this.rsm.rAudio[b|0],-1!=b&&b.play_audio(!0))};this.play_audio=function(b,c){"undefined"==typeof c&&(c=!1);if("undefined"!=typeof b&&0<=b&&b<this.rsm.rAudio.length){var a=this.rsm.rAudio[b|0];-1!=a&&a.play_audio(c)}};this.pause_audio_group=function(b){if("undefined"!=
typeof b)for(var c=this.rsm.rAudio.length-1;0<=c;c--){var a=this.rsm.rAudio[c];-1!=a&&a.audioGroupName==b&&a.pause_audio()}};this.pause_video=function(b){"undefined"!=typeof b&&0<=b&&b<this.rsm.rVideos.length&&(b=this.rsm.rVideos[b|0],-1!=b&&b.pause_video())};this.pause_all_video=function(){for(var b=this.rsm.rVideos.length-1;0<=b;b--){var c=this.rsm.rVideos[b];-1!=c&&c.pause_video()}};this.play_video=function(b,c,a){"undefined"==typeof c&&(c=!1);"undefined"!=typeof b&&0<=b&&b<this.rsm.rVideos.length&&
(b=this.rsm.rVideos[b|0],-1!=b&&b.play_video(c,a))};this.pause_video_group=function(b){if("undefined"!=typeof b)for(var c=this.rsm.rVideos.length-1;0<=c;c--){var a=this.rsm.rVideos[c];-1!=a&&a.videoGroupName==b&&a.pause_video()}};this.position_collides=function(b,c,a,d,e){return GPR.find_collision_rectangle(b,c,a,d,e)};this.position_open=function(b,c,a,d){return GPR.position_open(b,c,a,d)};this.point_between=function(b,c,a,d,e,g){var f=Math.max(a,e),h=Math.min(d,g);d=Math.max(d,g);return b>Math.min(a,
e)&&b<f&&c>h&&c<d?!0:!1};this.point_within=function(b,c,a,d,e,g){var f=Math.max(a,e),h=Math.min(d,g);d=Math.max(d,g);return b>=Math.min(a,e)&&b<=f&&c>=h&&c<=d?!0:!1};this.preload_completed=function(){return this.PRELOAD_COMPLETE};this.render_circle=function(b,c,a,d,e,g,m){b-=gpe.CURRENT_VIEW_BOX.xPos;c-=gpe.CURRENT_VIEW_BOX.yPos;0<a&&(0>a&&(a*=-1),gpe.GPE_Current_Context.beginPath(),gpe.GPE_Current_Context.arc(b,c,a,0,2*Math.PI,!1),1==e?(gpe.GPE_Current_Context.lineWidth=g,gpe.GPE_Current_Context.strokeStyle=
d,gpe.GPE_Current_Context.stroke()):(gpe.GPE_Current_Context.fillStyle=d,gpe.GPE_Current_Context.fill()),gpe.GPE_Current_Context.closePath())};this.render_current_video=function(){if(0<=this.currentVideoPlaying&&this.currentVideoPlaying<this.rsm.rVideos.length){var b=this.rsm.rVideos[this.currentVideoPlaying];-1!=b&&b.render_video(0,0,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT)}};this.render_line=function(b,c,a,d,e,g,m){b-=gpe.CURRENT_VIEW_BOX.xPos;c-=gpe.CURRENT_VIEW_BOX.yPos;a-=gpe.CURRENT_VIEW_BOX.xPos;
d-=gpe.CURRENT_VIEW_BOX.yPos;"number"!=typeof g&&(g=1);0!=g&&(0>g&&(g*=-1),gpe.GPE_Current_Context.beginPath(),gpe.GPE_Current_Context.moveTo(b,c),gpe.GPE_Current_Context.lineTo(a,d),gpe.GPE_Current_Context.lineWidth=g,gpe.GPE_Current_Context.strokeStyle=e,gpe.GPE_Current_Context.stroke())};this.render_rect=function(b,c,a,d,e){"undefined"==typeof b&&this.render_rectangle(b.xPos,b.yPos,b.x2Pos,rectin.y2Pos,c,a,d)};this.render_rectangle=function(b,c,a,d,e,g,m,l){l=Math.min(b,a)-gpe.CURRENT_VIEW_BOX.xPos;
var f=Math.min(c,d)-gpe.CURRENT_VIEW_BOX.yPos;b=Math.abs(b-a);c=Math.abs(c-d);g?(gpe.GPE_Current_Context.beginPath(),gpe.GPE_Current_Context.rect(l,f,b,c),gpe.GPE_Current_Context.lineWidth=m,gpe.GPE_Current_Context.strokeStyle=e,gpe.GPE_Current_Context.stroke()):(gpe.GPE_Current_Context.fillStyle=e,gpe.GPE_Current_Context.fillRect(l,f,b,c))};this.render_sprite=function(b,c,a,d,e,g){"number"==typeof b&&(b|=0,0<=b&&b<gpe.rsm.rSprites.length&&gpe.rsm.rSprites[b].render_to_context(gpe.GPE_Current_Context,
c,a|0,d|0,e,g))};this.render_sprite_rotated=function(b,c,a,d,e,g,m){b&&0<=b&&b<gpe.rsm.rSprites.length&&(b=gpe.rsm.rSprites[b|0],-1!=b&&(0<e&&360>e?(gpe.GPE_Current_Context.save(),gpe.GPE_Current_Context.translate(a,d),gpe.GPE_Current_Context.rotate(e*GPE_TO_RADIANS),b.render_to_context(gpe.GPE_Current_Context,c,-(b.get_width()/2),-(b.get_height()/2),g,m),gpe.GPE_Current_Context.restore()):b.render_to_context(gpe.GPE_Current_Context,c,a,d,g,m)))};this.render_square=function(b,c,a,d,e,g,m){c-=gpe.CURRENT_VIEW_BOX.xPos;
b-=gpe.CURRENT_VIEW_BOX.yPos;0!=a&&(0>a&&(c-=a,b-=a,a*=-1),e?(gpe.GPE_Current_Context.beginPath(),gpe.GPE_Current_Context.rect(c,b,a,a),gpe.GPE_Current_Context.lineWidth=g,gpe.GPE_Current_Context.strokeStyle=d,gpe.GPE_Current_Context.stroke()):(gpe.GPE_Current_Context.fillStyle=d,gpe.GPE_Current_Context.fillRect(c|0,b|0,a,a)))};this.render_text=function(b,c,a,d,e,g,m){d=""+d;if(0<d.length){c-=gpe.CURRENT_VIEW_BOX.xPos;a-=gpe.CURRENT_VIEW_BOX.yPos;var f=!1;"undefined"!=typeof b&&0<=b&&b<gpe.rsm.rFonts.length&&
(b=gpe.rsm.rFonts[b|0],-1!=b&&(gpe.GPE_Current_Context.font=b.fontCanvasInfo,f=!0));0==f&&(gpe.GPE_Current_Context.font="20px Arial");gpe.GPE_Current_Context.textAlign=g==fa_right?"right":g==fa_center?"center":"left";gpe.GPE_Current_Context.textBaseline=m==fa_bottom?"bottom":m==fa_middle?"middle":"top";gpe.GPE_Current_Context.fillStyle=e;gpe.GPE_Current_Context.fillText(d,c|0,a|0)}};this.render_texture=function(b,c,a){"undefined"!=typeof b&&0<=b&&b<gpe.rsm.rTextures.length&&(b=gpe.rsm.rTextures[b|
0],-1!=b&&b.render_to_context(gpe.GPE_Current_Context,c|0,a|0))};this.render_texture_scaled=function(b,c,a,d,e){"undefined"!=typeof b&&0<=b&&b<gpe.rsm.rTextures.length&&(b=gpe.rsm.rTextures[b|0],-1!=b&&b.render_tex_scaled(gpe.GPE_Current_Context,c|0,a|0))};this.render_texture_clipped=function(b,c,a,d){"undefined"!=typeof b&&0<=b&&b<gpe.rsm.rTextures.length&&(b=gpe.rsm.rTextures[b|0],-1!=b&&b.render_tex_clipped(gpe.GPE_Current_Context,c|0,a|0,d))};this.render_top_hud=function(){gpe.isPlayingVideo&&
this.render_current_video();GPE_SETTINGS_IS_DEBUGGING&&(gpe.context.font="bold 16pt Calibri",gpe.context.textAlign="left",gpe.context.textAlign="left",gpe.context.fillStyle="red",gpe.GPE_Current_Context.fillText(C+" fps ||| Checking "+this.colisionObjectLoops+"times with "+GPR.spatialCollisionChecks+" collision checks",40,gpe.SCREEN_HEIGHT-32))};this.render_triangle=function(b,c,a,d,e,g,m,l,q,r){b-=gpe.CURRENT_VIEW_BOX.xPos;c-=gpe.CURRENT_VIEW_BOX.yPos;a-=gpe.CURRENT_VIEW_BOX.xPos;d-=gpe.CURRENT_VIEW_BOX.yPos;
e-=gpe.CURRENT_VIEW_BOX.xPos;g-=gpe.CURRENT_VIEW_BOX.yPos;gpe.GPE_Current_Context.beginPath();gpe.GPE_Current_Context.moveTo(b,c);gpe.GPE_Current_Context.lineTo(a,d);gpe.GPE_Current_Context.lineTo(e,g);gpe.GPE_Current_Context.closePath();l?("undefined"==typeof q&&(q=5),gpe.GPE_Current_Context.lineWidth=q,gpe.GPE_Current_Context.lineJoin="round",gpe.GPE_Current_Context.strokeStyle=m,gpe.GPE_Current_Context.stroke()):(gpe.GPE_Current_Context.fillStyle=m,gpe.GPE_Current_Context.fill())};this.render_wrapped_text=
function(b,c,a,d,e,g,m){if("undefined"!=typeof b&&0<d.length)if(0<=b&&b<gpe.rsm.rFonts.length){var f=gpe.rsm.rFonts[b];if(-1!=f){c-=gpe.CURRENT_VIEW_BOX.xPos;a-=gpe.CURRENT_VIEW_BOX.yPos;gpe.GPE_Current_Context.font=f.fontCanvasInfo;gpe.GPE_Current_Context.fillStyle=e;gpe.GPE_Current_Context.textBaseline="top";gpe.GPE_Current_Context.textAlign="left";b="";e=d.split(" ");for(f=0;f<e.length;f++){d=b+e[f]+" ";var h=gpe.GPE_Current_Context.measureText(d);h=h.width;h>g&&0<f?(gpe.GPE_Current_Context.fillText(b,
c,a),b=e[f]+" ",a+=m):b=d}gpe.GPE_Current_Context.fillText(b,c,a)}else console.log("Unable to render fontId ["+b+"].")}else console.log("FontId ["+b+"] out of range.");else console.log("Unable to render wrapped text ["+d+"] with font ["+b+"].")};this.save_data=function(b,c,a){"undefined"!==typeof Storage&&localStorage.setItem(b+"_"+c,a)};this.replace_background=function(b,c,a){GPR.replace_background(b,c,a)};this.replace_all_backgrounds=function(b,c){GPR.replace_all_backgrounds(b,c)};this.set_background=
function(b,c,a){GPR.replace_background(b,c,a)};this.setup_camera=function(b,c,a,d,e){GPR.setup_camera(b,c,a,d,e)};this.split_screen=function(b,c,a){return GPR.split_screen(b,c,a)};this.set_render_alpha=function(b){gpe.GPE_Current_Context.globalAlpha=0<b&&255>b?b/255:0==b?0:1};this.SuperString=function(){return function(b){this.lastAteString=this.lastAteInt=-1;this.str="";"string"==typeof b?(this.str=b,this.length=this.str.length):this.length=IS_NULL;this.j_str=function(){return this.str};this.js_str=
function(){return this.str};this.empty=function(){return 0==this.str.length?!0:!1};this.update_string=function(b){"string"==typeof b?(this.str=b,this.length=this.str.length):this.str=""};this.size=function(){return length}}}();this.SuperVector=function(){function b(){this.internalArray=[];this.vectorLength=0}b.prototype.assign=function(b,c){b<this.internalArray.length&&(this.internalArray[b]=c)};b.prototype.at=function(b){return b<this.vectorLength?this.internalArray[b]:-1};b.prototype.back=function(){return 0<
this.vectorLength?this.internalArray[this.vectorLength-1]:-1};b.prototype.clear=function(){this.internalArray.length=0};b.prototype.insert=function(b,c){this.internalArray.insert(b,c);this.vectorLength++};b.prototype.makeLowercase=function(){for(var b=0;b<this.vectorLength;b++)"string"===typeof this.internalArray[b]&&(this.internalArray[b]=this.internalArray[b].toLowerCase())};b.prototype.makeUppercase=function(){for(var b=0;b<this.vectorLength;b++)"string"===typeof this.internalArray[b]&&(this.internalArray[b]=
this.internalArray[b].toUpperCase())};b.prototype.floorValues=function(){for(var b=0;b<this.vectorLength;b++)"number"===typeof this.internalArray[b]&&(this.internalArray[b]|=0)};b.prototype.roundValues=function(){for(var b=0;b<this.vectorLength;b++)"number"===typeof this.internalArray[b]&&(this.internalArray[b]=Math.round(this.internalArray[b]))};b.prototype.roundByDecimals=function(b){b=Math.floor(b);if(0<=b){var c=Math.pow(10,b);for(var a=0;a<this.vectorLength;a++)"number"===typeof this.internalArray[a]&&
(this.internalArray[a]=Math.round(this.internalArray[a]/c)*c)}else for(a=0;a<this.length;a++)c=Math.pow(10,-1*b),"number"===typeof this[a]&&(this[a]=roundedBeforeDecimal+Math.round(this[a]*c)/c)};b.prototype.ceilValues=function(){for(var b=0;b<this.vectorLength;b++)"number"===typeof this.internalArray[b]&&(this.internalArray[b]=Math.ceil(this.internalArray[b]))};b.prototype.size=function(){return this.vectorLength};b.prototype.push_back=function(b){this.internalArray.push(b);this.vectorLength=this.internalArray.length};
b.prototype.pop_back=function(){var b=this.internalArray.pop();this.vectorLength=this.internalArray.length;return b};return b}();this.stop_all_audio=function(){for(var b=this.rsm.rAudio.length-1;0<=b;b--){var c=this.rsm.rAudio[b];-1!=c&&c.stop_audio()}};this.stop_audio_group=function(b){if("undefined"!=typeof b)for(var c=this.rsm.rAudio.length-1;0<=c;c--){var a=this.rsm.rAudio[c];-1!=a&&a.audioGroupName==b&&a.stop_audio()}};this.stop_audio=function(b){"undefined"!=typeof b&&0<=b&&b<this.rsm.rAudio.length&&
(b=this.rsm.rAudio[b|0],-1!=b&&b.stop_audio())};this.stop_all_video=function(){for(var b=this.rsm.rVideos.length-1;0<=b;b--){var c=this.rsm.rVideos[b];-1!=c&&c.stop_video()}};this.stop_video_group=function(b){if("undefined"!=typeof b)for(var c=this.rsm.rVideos.length-1;0<=c;c--){var a=this.rsm.rVideos[c];-1!=a&&a.videoGroupName==b&&a.stop_video()}};this.stop_last_video=function(){this.isPlayingVideo=!1};this.stop_video=function(b){"undefined"!=typeof b&&0<=b&&b<this.rsm.rVideos.length&&(b=this.rsm.rVideos[b|
0],-1!=b&&b.stop_video())};this.to_bool=function(b){if("undefined"!=typeof b)if("string"==typeof b){if("true"==b||"yes"==b||"1"==b)return!0}else if("number"==typeof b&&1==b)return!0;return!1};this.touches_object=function(b,c,a,d,e){return GPR.find_collision_rectangle(b,c,a,d,e)};this.touches_family=function(b,c,a,d,e){return GPR.touches_family(b,c,a,d,e)};this.handle_key_down=function(b){"undefined"==typeof b&&(b=window.event);gpe.inputController.handle_key_down(b)};this.handle_key_press=function(b){"undefined"==
typeof b&&(b=window.event);gpe.inputController.handle_key_press(b)};this.handle_key_up=function(b){"undefined"==typeof b&&(b=window.event);gpe.inputController.handle_key_up(b)};this.update_mouse_down=function(b){"undefined"==typeof b&&(b=window.event);gpe.inputController.handle_mouse_press(b)};this.update_game_mouse=function(b){"undefined"==typeof b&&console.log("undefined event for mouse....");var c=gpe.canvas.getBoundingClientRect();gpe.MOUSE_X=(b.clientX-c.left)/(c.right-c.left)*(gpe.canvas.width+
2);gpe.MOUSE_Y=(b.clientY-c.top)/(c.bottom-c.top)*(gpe.canvas.height+2);0==gpe.masterScaleX&&(gpe.masterScaleX=1);0==gpe.masterScaleY&&(gpe.masterScaleY=1);gpe.MOUSE_SCALED_X=1>=GPE.masterScaleX?1/gpe.masterScaleX*gpe.MOUSE_X:0!=GPE.MOUSE_X?gpe.MOUSE_X/gpe.masterScaleX:0;gpe.MOUSE_SCALED_Y=1>=GPE.masterScaleY?1/gpe.masterScaleY*gpe.MOUSE_Y:0!=GPE.MOUSE_Y?gpe.MOUSE_Y/gpe.masterScaleY:0;gpe.MOUSE_X=Math.round(gpe.MOUSE_X);gpe.MOUSE_Y=Math.round(gpe.MOUSE_Y)};this.reset_game_mouse=function(b){gpe.MOUSE_X=
0;gpe.MOUSE_Y=0;gpe.MOUSE_SCALED_X=0;gpe.MOUSE_SCALED_Y=0};this.update_mouse_down=function(b){"undefined"==typeof b&&(b=window.event);gpe.inputController.handle_mouse_press(b)};this.update_mouse_up=function(b){"undefined"==typeof b&&(b=window.event);gpe.inputController.handle_mouse_up(b)};this.video_loop=function(b){this.play_video(b,!0)};this.video_play=function(b,c){this.play_video(b,c)};this.video_playing=function(b){return this.is_video_playing(b)};this.video_stop_all=function(){this.stop_all_video()};
this.gameloop_logic=function(){-1!=gpe.rsm&&gpe.rsm.check_resources_state();-1!=gpe.inputController&&gpe.inputController.process_input();gpe.apply_plugins_logics();if(gpe.isPlayingVideo)if(0<=gpe.currentVideoPlaying&&gpe.currentVideoPlaying<gpe.rsm.rVideos.length){var b=gpe.rsm.rVideos[gpe.currentVideoPlaying];-1!=b?(gpe.videoPlayingIsSkippable&&(gpe.check_keyboard(gp_esc)||gpe.check_keyboard(gp_enter))&&(b.stop_video(),gpe.exit_video_view_mode()),b.process_playing_video()):gpe.exit_video_view_mode()}else gpe.exit_video_view_mode();
else if(0!=gpe.currentState){for(var c=gpe.rsm.rAudio.length-1;0<=c;c--)b=gpe.rsm.rAudio[c],-1!=b&&b.isBeingLooped&&-1!=b.html5AudioSource&&b.html5AudioSource.ended&&b.play_audio(!0);gpe.currentState.apply_logic()}-1!=gpe.inputController&&gpe.inputController.reset_input();gpe.apply_plugins_logics()};this.gameloop_render=function(){gpe.canvasIsEnabled&&(GPE_FPS_UNCAPPED||GPE_STANDARD_DELTA>GPE_STANDARD_INTERVAL)&&(gpe.OBJECT_RENDER_CHECKS=0,gpe.OBJECT_RENDER_CALLS=0,GPE_STANDARD_THEN=GPE_STANDARD_NOW-
GPE_STANDARD_DELTA%GPE_STANDARD_INTERVAL,gpe.enter_render())};this.gameloop=function(){GPE_STANDARD_NOW=Date.now();GPE_STANDARD_DELTA=GPE_STANDARD_NOW-GPE_STANDARD_THEN;gpe.gameloop_logic();if(y!=t.STATE_NULL){y!=t.STATE_EXIT&&(gpe.currentState=IS_NULL);switch(y){case t.STATE_LOGO_DISPLAY:gpe.currentState=new F;break;case t.STATE_LOAD_RESOURCES:gpe.currentState=new Q;break;case t.STATE_MAINMENU:gpe.currentState=new S;break;case t.STATE_MAINGAME:gpe.currentState=new J}GPR=gpe.currentState;E=y;y=t.STATE_NULL;
gpe.handle_canvas_size()}gpe.gameloop_render();window.requestAnimationFrame(gpe.gameloop)};this.colisionObjectLoops=this.collisionsCheckedCount=0}function u(){this.y2Pos=this.x2Pos=this.rectHeight=this.rectWidth=this.yMiddle=this.xCenter=this.yPos=this.xPos=0;this.add_x=function(e){this.xPos+=e;this.x2Pos+=e;this.xCenter+=e};this.add_y=function(e){this.yPos+=e;this.y2Pos+=e;this.yMiddle+=e};this.get_center=function(){return this.xCenter};this.get_height=function(){return this.rectHeight};this.get_middle=
function(){return this.yMiddle};this.get_width=function(){return this.rectWidth};this.get_x=function(){return this.xPos};this.get_x2=function(){return this.x2Pos};this.get_y=function(){return this.yPos};this.get_y2=function(){return this.y2Pos};this.set_x=function(e){this.xPos=e;this.x2Pos=this.xPos+this.rectWidth;this.xCenter=this.xPos+this.rectWidth/2};this.set_y=function(e){this.yPos=e;this.y2Pos=this.yPos+this.rectHeight;this.yMiddle=this.yPos+this.rectHeight/2};this.update_position=function(e,
a){this.xPos=e;this.yPos=a;this.x2Pos=this.xPos+this.rectWidth;this.y2Pos=this.yPos+this.rectHeight;this.xCenter=this.xPos+this.rectWidth/2;this.yMiddle=this.yPos+this.rectHeight/2};this.update_box=function(e,a,d,c){this.update_shape(e,a,d,c)};this.update_shape=function(e,a,d,c){"number"==typeof e&&"number"==typeof a&&"number"==typeof d&&"number"==typeof c&&(this.xPos=e,this.yPos=a,this.rectWidth=d,this.rectHeight=c,0>d&&(this.xPos=e-d,this.rectWidth=Math.abs(d),GPE_SETTINGS_IS_DEBUGGING&&console.log(this.rectWidth)),
0>c&&(this.yPos=a-c,this.rectHeight=Math.abs(c),GPE_SETTINGS_IS_DEBUGGING&&console.log(this.rectHeigh)),this.x2Pos=this.xPos+this.rectWidth,this.y2Pos=this.yPos+this.rectHeight,this.xCenter=this.xPos+this.rectWidth/2,this.yMiddle=this.yPos+this.rectHeight/2)};this.update_size=function(e,a){this.rectWidth=e;this.rectHeight=a;0>e&&(this.xPos=xNew-e,this.rectWidth=Math.abs(e));0>a&&(this.yPos=yNew-a,this.rectHeight=Math.abs(a));this.x2Pos=this.xPos+this.rectWidth;this.y2Pos=this.yPos+this.rectHeight;
this.xCenter=this.xPos+this.rectWidth/2;this.yMiddle=this.yPos+this.rectHeight/2}}function O(){this.imageObj;this.maxSpriteFrames=this.frameCount=0;this.spriteName="";this.gpeId=this.setId=-1;this.yOrg=this.xOrg=0;this.spriteHeight=this.spriteWidth=1;this.colY=this.colX=0;this.colRadius=this.colHeight=this.colWidth=1;this.imageHeight=this.imageWidth=this.colShape=0;this.frameRect=[];this.get_height=function(){return this.spriteHeight};this.get_width=function(){return this.spriteWidth};this.update_sprite_data=
function(e,a,d,c,g){this.imageWidth=e.naturalWidth;this.imageHeight=e.naturalHeight;GPE_SETTINGS_IS_DEBUGGING&&console.log("["+this.setId+"]Size: "+this.imageWidth+" , "+this.imageHeight+".");var b=0;this.spriteWidth=this.colWidth=c;this.spriteHeight=this.colHeight=g;this.frameCount=0;this.imageObj=e;var f,k;for(f=d;f<this.imageHeight;f+=g)for(k=a;k<this.imageWidth;k+=c)if(this.frameCount<this.maxSpriteFrames||0>=this.maxSpriteFrames){var h=new u;e=c;d=g;k+c>this.imageWidth&&(e=this.imageWidth-k);
f+g>this.imageHeight&&(d=this.imageHeight-d);h.update_shape(k,f,e,d);this.frameRect[b]=h;b+=1;this.frameCount+=1}};this.render_to_context=function(e,a,d,c,g,b){d-=gpe.CURRENT_VIEW_BOX.xPos;c-=gpe.CURRENT_VIEW_BOX.yPos;"undefined"==typeof g&&(g=1);"undefined"==typeof b&&(b=1);if(0<=a&&a<this.frameRect.length)if(a=this.frameRect[a|0],1==g&&1==b)e.drawImage(this.imageObj,a.get_x(),a.get_y(),a.rectWidth,a.rectHeight,d,c,a.rectWidth,a.rectHeight);else if(0>g||0>b){var f=1,k=1;0>g&&(g*=-1,f=-1);0>b&&(k=
-1,b*=-1);e.save();e.translate(d,c);d=a.rectWidth/2;c=a.rectHeight/2;e.translate(d,c);e.scale(f,k);e.drawImage(this.imageObj,a.get_x(),a.get_y(),a.rectWidth,a.rectHeight,-d,-c,a.rectWidth*g,a.rectHeight*b);e.restore()}else e.drawImage(this.imageObj,a.get_x(),a.get_y(),a.rectWidth,a.rectHeight,d*f,c*k,a.rectWidth*g,a.rectHeight*b)}}function P(){this.id=this.tex=IS_NULL;this.tAmountY=this.tAmountX=0;this.tHeight=this.tWidth=32;this.vSep=this.hSep=this.vOff=this.hOff=0;this.tileEndPos=this.tileStartPos=
1;this.tilesetIsProcessed=this.texIsLoaded=!1;this.load_tilesheet_texture=function(e,a){this.tex=gpe.rsm.load_new_texture(e,a)};this.pixel_from_xpos=function(e){return this.hOff+e*(this.tWidth+this.hSep)};this.pixel_from_ypos=function(e){return this.vOff+e*(this.tHeight+this.vSep)};this.get_xpos_at=function(e){var a=0;0<this.tAmountX&&e>=this.tAmountX&&0<e?a=this.hOff+Math.abs(e%this.tAmountX)*(this.tWidth+this.hSep):0<=e&&(a=this.hOff+e*(this.tWidth+this.hSep));return a};this.get_ypos_at=function(e){var a=
0;0!=this.tAmountX&&e>=this.tAmountX&&0<e?a=this.vOff+(e/this.tAmountX|0)*(this.tHeight+this.vSep):0==e&&(a=this.vOff);return a};this.get_tile_width=function(){return this.tWidth};this.get_tile_height=function(){return this.tHeight};this.update_tex_specs=function(){this.tAmountY=this.tAmountX=0;var e=this.hOff,a=this.vOff;this.tileEndPos=this.tileStartPos;if(-1!=this.tex){for(;e<this.tex.naturalWidth;)e+=this.tWidth+this.hSep,this.tAmountX+=1;for(;a<this.tex.naturalHeight;)a+=this.tHeight+this.vSep,
this.tAmountY+=1}this.tileEndPos+=this.tAmountX*this.tAmountY};this.init_tilesheet=function(){0==this.texIsLoaded&&-1!=this.tex&&(this.texIsLoaded=this.tex.check_texture_state());return this.texIsLoaded}}function G(){this.imageSource=IS_NULL;this.texHeight=this.texWid=0;this.name=this.fileLocation="";this.texId=IS_NULL;this.textureFailedToLoad=this.textureIsFullyLoaded=!1;this.get_id=function(){return texId};this.check_texture_state=function(){-1!=this.imageSource?0==this.textureIsFullyLoaded&&((this.textureIsFullyLoaded=
x(this.imageSource))?(this.texWid=this.imageSource.naturalWidth,this.texHeight=this.imageSource.naturalHeight):"failed"==this.imageSource.alt&&(this.texHeight=this.textWid=0,this.textureFailedToLoad=this.textureIsFullyLoaded=!0)):this.textureIsFullyLoaded=!1;return this.textureIsFullyLoaded};this.change_texture=function(e){this.imageSource=e};this.get_width=function(){return this.texWid};this.get_height=function(){return this.texHeight};this.render_tex=function(e,a,d){-1!=this.imageSource&&0==this.textureFailedToLoad&&
-1!=e&&this.textureIsFullyLoaded&&e.drawImage(this.imageSource,a,d)};this.render_tex_scaled=function(e,a,d,c,g){if(-1!=this.imageSource&&0==this.textureFailedToLoad&&-1!=e&&this.textureIsFullyLoaded)if(0<c&&0<g)e.drawImage(this.imageSource,a,d,c,g);else if(0>c||0>g){d=a=1;0>c&&(c*=-1,a=-1);0>scaleY&&(d=-1,g*=-1);e.save();e.translate(xOn,yOn);var b=c/2,f=g/2;e.translate(b,f);e.scale(a,d);e.drawImage(this.imageObj,-b,-f,c,g);e.restore()}};this.render_tex_clipped=function(e,a,d,c){-1!=this.imageSource&&
-1!=e&&this.textureIsFullyLoaded&&0==this.textureFailedToLoad&&"undefined"!=typeof c&&e.drawImage(this.imageSource,c.get_x(),c.get_y(),c.get_width(),c.get_height(),a,d,c.get_width(),c.get_height())}}function V(){this.backgroundTexture=IS_NULL;this.bgYSpeed=this.bgXSpeed=this.bgYOffset=this.bgXOffset=0;this.bgId=this.fileLocation=IS_NULL;this.bgColor="black";this.loopBGVert=this.loopBGHori=this.renderBgSpeed=!1;this.get_scene_background_color=function(){return this.bgColor};this.set_background=function(e){0<=
e&&e<gpe.rsm.rTextures.length?(e.bgId=e,e.backgroundTexture=gpe.rsm.rTextures[e]):(e.bgId=IS_NULL,e.backgroundTexture=IS_NULL)};this.set_background_color=function(e){this.bgColor=e};this.set_bgoffsets=function(e,a){this.bgXOffset=e;this.bgYOffset=a};this.set_bgspeed=function(e,a){this.bgXSpeed=e;this.bgYSpeed=a};this.scroll_bg=function(){-1!=this.backgroundTexture&&0==this.stretchBG&&(this.bgXOffset+=this.bgXSpeed,this.bgYOffset+=this.bgYSpeed,this.loopBGHori&&(this.bgXOffset<=-this.backgroundTexture.get_width()&&
(this.bgXOffset=0),this.bgXOffset>=this.backgroundTexture.get_width()&&(this.bgXOffset=0)),this.loopBGVert&&(this.bgYOffset<=-this.backgroundTexture.get_height()&&(this.bgYOffset=0),this.bgYOffset>=this.backgroundTexture.get_height()&&(this.bgYOffset=0)))};this.render_bg_speed=function(e,a,d,c,g){this.backgroundTexture.render_tex(d,1*e-c.xPos,1*a-c.yPos,1*this.backgroundTexture.get_width(),1*this.backgroundTexture.get_height())};this.render_bg=function(e,a,d,c,g){if(-1!=this.backgroundTexture&&this.backgroundTexture.textureIsFullyLoaded)if(this.loopBGHori)if(this.loopBGVert)for(var b=
this.bgXOffset-this.backgroundTexture.get_width();b<=c+this.backgroundTexture.get_width();b+=this.backgroundTexture.get_width())for(var f=this.bgYOffset-this.backgroundTexture.get_height();f<=g+this.backgroundTexture.get_height();f+=this.backgroundTexture.get_height())this.render_bg_speed(b,f,e,a,d);else for(b=this.bgXOffset-this.backgroundTexture.get_width();b<=c+this.bgXOffset+this.backgroundTexture.get_width();b+=this.backgroundTexture.get_width())this.render_bg_speed(b,this.bgYOffset,e,a,d);else if(this.loopBGVert)for(f=
this.bgYOffset-this.backgroundTexture.get_height();f<=g;f+=this.backgroundTexture.get_height())this.render_bg_speed(this.bgXOffset,f,e,a,d);else this.render_bg_speed(this.bgXOffset,this.bgYOffset,e,a,d)}}function W(){this.tileIdNumb=this.tset=IS_NULL;this.tSetPos=-1;this.yCoord=this.xCoord=0;this.tileLayer=-1;this.tileType=0;this.drewBefore=this.isSolid=!1;this.tileBox=new u;this.tileBox.update_shape(0,0,32,32);this.get_type=function(){return this.tileType};this.update_box=function(e,a,d,c){this.tileBox.update_shape(e,
a,d,c)};this.render_self=function(e,a){if(0<=this.tset&&this.tset<gpe.rsm.rTilesheets.length){var d=gpe.rsm.rTilesheets[this.tset];-1!=d&&(d=d.tex,-1!=d&&e.drawImage(d,this.tileBox.get_x(),this.tileBox.get_y(),this.tileBox.get_width(),this.tileBox.get_height(),this.xCoord-a.xPos,this.yCoord-a.yPos,this.tileBox.get_width(),this.tileBox.get_height()))}};this.render_self_auto=function(e){if(0<=this.tset&&this.tset<gpe.rsm.rTilesheets.length){var a=gpe.rsm.rTilesheets[this.tset];-1!=a&&(a=a.tex,e.drawImage(a,
this.tileBox.get_x(),this.tileBox.get_y(),this.tileBox.get_width(),this.tileBox.get_height(),this.xCoord,this.yCoord,this.tileBox.get_width(),this.tileBox.get_height()))}}}function X(e,a,d){this.spatialGridHeightSize=this.spatialGridWidthSize=this.spatialGridBoxSize=128;this.spatialGridHeightAmount=this.spatialGridWidthAmount=2;this.layerType=e;this.layerObjects=[];this.independentObjects=[];this.layerBackgrounds=[];this.scnStartBackgrounds=[];this.scnStartObjects=[];this.scnStartTiles=[];this.tileAmountY=
this.tileAmountX=IS_NULL;this.layerId=a;this.layerAlpha=d;this.layerName="";this.prevTileAmountY=this.prevTileAmountX=IS_NULL;this.layerTiles=[];this.collisionSpacesInView=[];this.spatialGridIsCreated=!1;this.spatialMapHeightSize=this.spatialMapWidthSize=0;this.COLLISION_AREA_SPACES=[];this.COLLISION_AREA_OUTSIDE_SCENE=new gpe.SuperSpatialPartition;this.superDebugCollisions=!1;this.objectCollisionIsChecked={};this.collisionPairA=[];this.collisionPairB=[];this.parsed_objects=this.collisionPairsTotal=
0;this.prerenderObjectRenderList=[];this.regularObjectRenderList=[];this.renderAboveObjectRenderList=[];this.renderHudObjectRenderList=[];this.set_default_grid_size=function(){this.spatialGridHeightSize=this.spatialGridWidthSize=this.spatialGridBoxSize=128};this.set_default_grid_size();this.spatialGridHeightAmount=this.spatialGridWidthAmount=2;this.spatialCollisionChecks=this.objectCollisionHashesChecked=0;this.spatialGridIsCreated=!1;this.spatialMapHeightSize=this.spatialMapWidthSize=-1;this.add_collision_pair=
function(c,a){this.collisionPairA[this.collisionPairsTotal]=c;this.collisionPairB[this.collisionPairsTotal]=a;this.collisionPairsTotal+=1};this.begin_spatialpartioning=function(c,a){if(this.spatialGridIsCreated&&this.spatialMapWidthSize==c&&this.spatialMapHeightSize==a)console.log("Not overwriting scene grid...");else if(this.COLLISION_AREA_OUTSIDE_SCENE.empty_list(),this.set_default_grid_size(),"undefined"!=typeof c&&"undefined"!=typeof a)if(this.COLLISION_AREA_SPACES.clear(),0<c&&0<a){this.spatialMapWidthSize=
c;this.spatialMapHeightSize=a;this.spatialGridWidthAmount=Math.ceil(c/this.spatialGridWidthSize);2>this.spatialGridWidthAmount&&(this.spatialGridWidthSize=c/2,this.spatialGridWidthAmount=2);this.spatialGridHeightAmount=Math.ceil(a/this.spatialGridHeightSize);2>this.spatialGridHeightAmount&&(this.spatialGridHeightSize=a/2,this.spatialGridHeightAmount=2);var b,d,e=0,g=0;for(b=0;b<this.spatialGridWidthAmount;b+=1){for(d=0;d<this.spatialGridHeightAmount;d+=1){var n=new gpe.SuperSpatialPartition;n.set_space(e,
g,this.spatialGridWidthSize,this.spatialGridHeightSize);g+=this.spatialGridHeightSize;n.spaceName+="testrun_"+b+"_"+d+"_test";this.COLLISION_AREA_SPACES.push_back(n)}g=0;e+=this.spatialGridWidthSize}this.spatialGridIsCreated=!0}else console.log("Negative dimensions given for spatial partitioning...");else console.log("Invalid dimensions given for spatial partitioning...")};this.begin_render=function(c){this.prerenderObjectRenderList=[];this.regularObjectRenderList=[];this.renderAboveObjectRenderList=
[];this.renderHudObjectRenderList=[];var a;for(jLoop=this.independentObjects.length-1;0<=jLoop;jLoop--){var b=this.independentObjects[jLoop];b.isInit&&b.isVisible&&!b.gpeIsBeingDestroyed&&(b.hasPreRenderFunction&&this.prerenderObjectRenderList.push(b),this.regularObjectRenderList.push(b),b.hasPostRenderFunction&&this.renderAboveObjectRenderList.push(b),b.hasHudRenderFunction&&this.renderHudObjectRenderList.push(b),b.gpeAddedToRenderList=!0)}var d=this.COLLISION_AREA_SPACES.size();for(jLoop=c.length-
1;0<=jLoop;jLoop--)if(foundCollisionSpaceId=c[jLoop],0<=foundCollisionSpaceId&&foundCollisionSpaceId<d)for(currentSpace=this.COLLISION_AREA_SPACES[foundCollisionSpaceId],a=currentSpace.internalArray.length-1;0<=a;a--)b=currentSpace.internalArray[a],!b.gpeAddedToRenderList&&b.isInit&&b.isVisible&&!b.gpeIsBeingDestroyed&&(b.hasPreRenderFunction&&this.prerenderObjectRenderList.push(b),this.regularObjectRenderList.push(b),b.hasPostRenderFunction&&this.renderAboveObjectRenderList.push(b),b.hasHudRenderFunction&&
this.renderHudObjectRenderList.push(b),b.gpeAddedToRenderList=!0)};this.get_tile_at=function(c,a){var b=c+a*this.tileAmountX;return 0<=b&&b<this.layerTiles.length?this.layerTiles[b]:IS_NULL};this.clear_dynamic_data=function(){this.independentObjects=[];this.layerObjects=[];this.layerBackgrounds=[];for(var c=this.COLLISION_AREA_SPACES.length-1;0<=c;c--)this.COLLISION_AREA_SPACES[c].empty_list();this.COLLISION_AREA_OUTSIDE_SCENE.empty_list()};this.create_new_map=function(c,a){this.tileAmountX=c;this.tileAmountY=
a;var b=this.tileAmountX*this.tileAmountY,d;this.layerTiles=[];for(d=0;d<b;d++)this.layerTiles[d]=new W,this.layerTiles[d].tileType=0};this.get_map_size=function(){return this.layerTiles.length};this.remove_object=function(c){for(var a,b=this.layerObjects.length-1;0<=b;b--)a=this.layerObjects[b],a.gpeUniqGameObjectId==c.gpeUniqGameObjectId&&this.layerObjects.splice(b,1)};this.find_spatial_at=function(c,a){var b=-1;0<=c&&0<=a&&(b=(c/this.spatialGridWidthSize|0)*this.spatialGridHeightAmount,b+=a/this.spatialGridHeightSize|
0,0>b||b>=this.COLLISION_AREA_SPACES.length)&&(b=-1);return b};this.render_objects=function(){var c;for(c=this.prerenderObjectRenderList.length-1;0<=c;c--){var a=this.prerenderObjectRenderList[c];a.render_under()}gpe.set_render_alpha(255);for(c=this.regularObjectRenderList.length-1;0<=c;c--)a=this.regularObjectRenderList[c],a.render_self();gpe.set_render_alpha(255);for(c=this.renderAboveObjectRenderList.length-1;0<=c;c--)a=this.renderAboveObjectRenderList[c],a.render_above();gpe.set_render_alpha(255)};
this.render_hud_objects=function(){var c;for(c=this.renderHudObjectRenderList.length-1;0<=c;c--){var a=this.renderHudObjectRenderList[c];a.render_hud()}};this.scroll_backgrounds=function(){for(var c=this.layerBackgrounds.length-1;0<=c;c--)-1!=this.layerBackgrounds[c]&&this.layerBackgrounds[c].scroll_bg()};this.replace_all_backgrounds=function(c,a){for(var b=this.layerBackgrounds.length;0<=b;b--)this.layerBackgrounds[b].bgId==c&&this.layerBackgrounds[b].set_background(a)};this.set_background=function(c,
a,b){0<=c&&c<this.layerBackgrounds.length&&this.layerBackgrounds[c].set_background(b)}}function Y(e,a,d,c,g){this.cameraRect=new u;this.cameraBoundaries=new u;this.cameraRect.update_shape(e,a,d,c);this.renderRect=new u;this.scaledRect=new u;this.scaledRect.update_shape(e,a,d,c);this.vertBorder=this.horiBorder=this.viewTarget=IS_NULL;this.vSpeed=this.hSpeed=0;this.isVisible=!1;this.cSceneHeight=this.cSceneWidth=this.maxYTilesInView=this.maxXTilesInView=0;this.center_camera=function(b,c){this.cameraRect.update_position(b-
this.cameraRect.rectWidth/2,c-this.cameraRect.rectHeight/2);this.cameraRect.get_x2()>this.cameraBoundaries.get_width()&&this.cameraRect.set_x(this.cameraBoundaries.get_width()-this.cameraRect.get_width());this.cameraRect.get_y2()>this.cameraBoundaries.get_height()&&this.cameraRect.set_y(this.cameraBoundaries.get_height()-this.cameraRect.get_height());0>this.cameraRect.get_x()&&this.cameraRect.set_x(0);0>this.cameraRect.get_y()&&this.cameraRect.set_y(0)};this.move_hori=function(b){0>b?this.cameraBoundaries.get_x()<
this.cameraRect.get_x()+b?this.cameraRect.add_x(b):this.cameraRect.set_x(0):this.cameraBoundaries.x2Pos>this.cameraRect.x2Pos+b&&this.cameraRect.add_x(b)};this.move_vert=function(b){0>b?this.cameraBoundaries.get_y()<this.cameraRect.get_y()+b?this.cameraRect.add_y(b):this.cameraRect.set_y(0):this.cameraBoundaries.y2Pos>this.cameraRect.y2Pos+b&&this.cameraRect.add_y(b)};this.setup_camera=function(b,c,a,d){this.isVisible=!0;console.log("Updaing Camera with ("+b+", "+c+", "+a+", "+d+") dimensions...");
this.renderRect.update_shape(b,c,a,d);this.cameraRect.update_shape(b,c,a,d)};this.update_tile_size=function(b,c){this.maxXTilesInView=b;this.maxYTilesInView=c};this.update_screen_space=function(b,c,a,d){this.renderRect.update_shape(b,c,a,d)};this.update_view_space=function(b,c,a,d){this.cameraRect.update_shape(b,c,a,d)}}function U(e,a){"number"!=typeof e&&(e=-1);"string"!=typeof a&&(a="");this.sceneName=a;this.sceneId=e;this.sceneHasBeenActivated=!1;this.sceneHeight=this.sceneWidth=1024;gpe.sceneWidth=
1024;gpe.sceneHeight=1024;this.sceneWasVisitedBefore=this.sceneIsContinuous=!1;this.defaultLayerName="game - layer";this.tileAmountY=this.tileAmountX=0;this.tileHeight=this.tileWidth=32;this.mapTextures=[];this.layerTilesheets=[];this.sceneObjects=[];this.persistentObjects=[];this.sceneLayers=[];this.scenesStartLayers=[];this.bgColor="aqua";this.endAudio=this.startAudio=this.bgMusic=this.sceneVersion=-1;this.BACKGROUNDS=[];this.sceneMapIn=IS_NULL;this.sceneIsSpatiallyPartitioned=this.sceneResourcesAreProcessed=
this.sceneIsProcessed=!1;this.sceneCamera=[];this.disable_camera=function(a){0<=a&&a<gpe.maxCameras&&(this.sceneCamera[a].isVisible=!1)};this.enable_camera=function(a){0<=a&&a<gpe.maxCameras&&(this.sceneCamera[a].update_view_space(0,0,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT),this.sceneCamera[a].update_screen_space(0,0,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT),this.sceneCamera[a].isVisible=!0)};this.reset_scene_meta=function(){this.sceneCamera=[];for(var a=0;a<gpe.maxCameras;a++)this.sceneCamera[a]=new Y(0,0,
gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT,a);this.sceneCamera[0].update_view_space(0,0,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT);this.sceneCamera[0].update_screen_space(0,0,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT);this.sceneCamera[0].isVisible=!0;this.sceneCamera[1].update_view_space(0,0,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT/2);this.sceneCamera[1].update_screen_space(0,gpe.SCREEN_HEIGHT/2,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT/2);this.sceneCamera[1].isVisible=!1;this.splitRenderMode=0;this.sceneCamera[2].update_view_space(0,
0,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT);this.sceneCamera[2].update_screen_space(0,gpe.SCREEN_HEIGHT/2,gpe.SCREEN_WIDTH/2,gpe.SCREEN_HEIGHT/2);this.sceneCamera[2].isVisible=!1;this.sceneCamera[3].update_view_space(0,0,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT);this.sceneCamera[3].update_screen_space(gpe.SCREEN_WIDTH/2,gpe.SCREEN_HEIGHT/2,gpe.SCREEN_WIDTH/2,gpe.SCREEN_HEIGHT/2);this.sceneHasBeenActivated=this.sceneIsSpatiallyPartitioned=this.sceneCamera[3].isVisible=!1};this.clear_layers_data=function(){for(var a,
c=this.sceneLayers.length-1;0<=c;c--)a=this.sceneLayers[c],-1!=a&&a.clear_dynamic_data()};this.reset_scene_meta();this.add_to_persistent_objects=function(a){if(-1!=a)for(var c=this.persistentObjects.length-1;0<=c;c--)if(this.persistentObjects[c].gpeUniqGameObjectId==a.gpeUniqGameObjectId)return!1;this.persistentObjects.push(a);return!0};this.find_layer=function(a,c){if(32>a&&0<=a)for(var d=this.sceneLayers.length-1;0<=d;d--){var b=this.sceneLayers[d];if(-1!=b&&b.layerId==a&&b.layerType==c)return b}return IS_NULL};
this.get_layer=function(a,c){if(32>a&&0<=a)for(var d=this.sceneLayers.length-1;0<=d;d--){var b=this.sceneLayers[d];if(-1!=b&&b.layerId==a)return b}return"number"==typeof a&&0<=a&&32>a?(console.log("Unable to find layer with ID["+a+"]"),this.add_layer(c,a,1)):IS_NULL};this.get_scene_width=function(){return this.sceneWidth};this.get_scene_height=function(){return this.sceneHeight};this.find_tile=function(a,c,e){c=Math.max(0,Math.min(this.sceneWidth-1,c/this.tileWidth|0));e=Math.max(0,Math.min(this.sceneHeight-
1,e/this.tileHeight|0));a=this.find_layer(a,GPE_LAYER_TYPE_TILES);return a!=IS_NULL&&(c=a.get_tile_at(c,e),c!=-IS_NULL)?c.tset:IS_NULL};this.find_tile_in_box=function(a,c,e,b,f){var d;c=Math.max(0,Math.min(this.sceneWidth-1,c/this.tileWidth|0));e=Math.max(0,Math.min(this.sceneHeight-1,e/this.tileHeight|0));b=Math.max(0,Math.min(this.sceneWidth-1,b/this.tileWidth|0));f=Math.max(0,Math.min(this.sceneHeight-1,f/this.tileHeight|0));a=this.find_layer(a,GPE_LAYER_TYPE_TILES);if(a!=IS_NULL)for(d=e;d<=f;d+=
1)for(e=c;e<=b;e+=1){var g=a.get_tile_at(e,d);if(g!=-IS_NULL)return g.tset}return IS_NULL};this.find_matching_tile=function(a,c,e,b){c=Math.max(0,Math.min(this.sceneWidth-1,c/this.tileWidth|0));e=Math.max(0,Math.min(this.sceneHeight-1,e/this.tileHeight|0));a=this.find_layer(a,GPE_LAYER_TYPE_TILES);return a!=IS_NULL&&(c=a.get_tile_at(c,e),c!=-IS_NULL&&c.tset==b)?!0:!1};this.find_matching_tile_in_box=function(a,c,e,b,f,k){var d;c=Math.max(0,Math.min(this.sceneWidth-1,c/this.tileWidth|0));e=Math.max(0,
Math.min(this.sceneHeight-1,e/this.tileHeight|0));b=Math.max(0,Math.min(this.sceneWidth-1,b/this.tileWidth|0));f=Math.max(0,Math.min(this.sceneHeight-1,f/this.tileHeight|0));a=this.find_layer(a,GPE_LAYER_TYPE_TILES);if(a!=IS_NULL)for(d=e;d<=f;d+=1)for(e=c;e<=b;e+=1){var g=a.get_tile_at(e,d);if(g!=-IS_NULL&&g.tset==k)return!0}return!1};this.scene_is_ready=function(){return this.sceneResourcesAreProcessed&&this.sceneIsProcessed?!0:!1};this.scene_init=function(){this.sceneIsSpatiallyPartitioned=!1;var a=
0,c=0,e=0,b=0,f=IS_NULL;GPE_SETTINGS_IS_DEBUGGING&&console.log("Adding ["+GPR.GAME_OBJECTS_CONTINUOUS.length+"] continuous objects to scene #"+this.sceneIdNumber+".");try{for(a=0;a<GPR.GAME_OBJECTS_CONTINUOUS.length;a++)GPR.GAME_OBJECTS_CONTINUOUS[a].SPATIAL_PARTITION_LIST=[],GPR.add_object(GPR.GAME_OBJECTS_CONTINUOUS[a],!0,GPR.GAME_OBJECTS_CONTINUOUS[a].sceneLayerStartPos)}catch(l){alert(l)}GPR.GAME_OBJECTS_CONTINUOUS=[];if(this.sceneWasVisitedBefore&&this.sceneIsContinuous)for(GPE_SETTINGS_IS_DEBUGGING&&
console.log("Adding ["+this.persistentObjects.length+"] persistant objects to scene #"+this.sceneIdNumber+"."),a=0;a<this.persistentObjects.length;a++)this.persistentObjects[a].SPATIAL_PARTITION_LIST=[],GPR.add_object(this.persistentObjects[a],!0,GPR.GAME_OBJECTS_CONTINUOUS[a].sceneLayerStartPos);if(0==this.sceneWasVisitedBefore||0==this.sceneIsContinuous){var k=this.sceneLayers.length;console.log("Updating ["+k+"] layers for scene init...");for(a=0;a<k;a++){var h=this.sceneLayers[a];if(h!=IS_NULL){if(h.layerType==
GPE_LAYER_TYPE_TILES)for(c=0;c<h.scnStartTiles.length;c++){var n=h.scnStartTiles[c];if(-1!=n&&0<=n.tileNumber&&n.tileNumber<h.layerTiles.length){var p=h.layerTiles[n.tileNumber];if(0<=n.tileSheetId&&n.tileSheetId<gpe.rsm.rTilesheets.length){var m=gpe.rsm.rTilesheets[n.tileSheetId];p.tset=n.tileSheetId;p.tileIdNumb=n.tileIndexId;-1!=m&&p.tileBox.update_box(m.get_xpos_at(n.tileIndexId),m.get_ypos_at(n.tileIndexId),m.get_tile_width(),m.get_tile_height())}}}else if(h.layerType==GPE_LAYER_TYPE_BACKGROUND)for(c=
0;c<h.scnStartBackgrounds.length;c++)m=h.scnStartBackgrounds[c],-1!=m&&(p=new V,p.set_background(m.bgTexId),p.bgXOffset=m.bgXPos,p.bgYOffset=m.bgYPos,p.set_bgspeed(m.bgXSpeed,m.bgYSpeed),p.loopBGHori=m.bgTileHori,p.loopBGVert=m.bgTileVert,p.stretchBG=m.bgStartStretch,h.layerBackgrounds.push(p));if(!(h.layerType!=GPE_LAYER_TYPE_OBJECTS||this.sceneWasVisitedBefore&&this.sceneIsContinuous))for(GPE_SETTINGS_IS_DEBUGGING&&console.log("Adding ["+h.scnStartObjects.length+"] regular objects to scene #"+this.sceneIdNumber+
"."),c=0;c<h.scnStartObjects.length;c++)try{f=gpe.add_new_object(h.scnStartObjects[c].objId,h.scnStartObjects[c].xPos,h.scnStartObjects[c].yPos,h.layerId),f.customComponents=h.scnStartObjects[c].customComponents,f.layerOrigID=h.layerId,f.sceneLayerPos=h.layerId,f.layerOrigName=h.layerId}catch(l){alert(l)}}}}try{for(a=GPR.GAME_OBJECTS.length-1;0<=a;a--)for(e=GPR.GAME_OBJECTS[a],c=e.length-1;0<=c;c--)b=e[c],0==b.gpeIsBeingDestroyed&&0==b.gpeSceneStartCodeUsed&&(b.scene_start(),b.gpeSceneStartCodeUsed=
!0)}catch(l){alert(l)}this.sceneWasVisitedBefore=this.sceneHasBeenActivated=!0};this.update_scene_specs=function(a,c){a=Math.abs(a);c=Math.abs(c);this.cSceneWidth=a;this.cSceneHeight=c;gpe.sceneWidth=a;gpe.sceneHeight=c;for(var d=gpe.maxCameras-1;0<=d;d--)this.sceneCamera[d].cameraBoundaries.update_shape(0,0,a,c)};this.update_tilemap=function(){this.sceneWidth=0<this.tileAmountX&&0<this.tileWidth?this.tileAmountX*this.tileWidth:0;this.sceneHeight=0<this.tileAmountY&&0<this.tileHeight?this.tileAmountY*
this.tileHeight:0;gpe.sceneWidth=this.sceneWidth;gpe.sceneHeight=this.sceneHeight;for(var a,c,e,b,f=0;f<this.sceneLayers.length;f++)if(c=this.sceneLayers[f],-1!=c&&c.layerType==GPE_LAYER_TYPE_TILES)for(e=0;e<this.tileAmountY;e++)for(b=0;b<this.tileAmountX;b++)a=c.get_tile_at(b,e),"undefined"!=typeof a&&(a.yCoord=e*this.tileHeight,a.xCoord=b*this.tileWidth,a.tileType=0);for(a=gpe.maxCameras-1;0<=a;a--)this.sceneCamera[a].cameraBoundaries.update_shape(0,0,this.sceneWidth,this.sceneHeight)};this.add_background=
function(a,c,e,b,f,k,h){a=new sceneBackground(a,b,f);a.set_bgspeed(k,h);a.loopBGHori=c;a.loopBGVert=e;this.BACKGROUNDS.push(a)};this.replace_background=function(a,c,e){0<=a&&a<this.sceneLayers.length&&this.sceneLayers[a].replace_all_backgrounds(c,e)};this.replace_all_backgrounds=function(a,c){for(var d=this.sceneLayers.length;0<=d;d--)this.sceneLayers[d].replace_all_backgrounds(a,c)};this.set_background=function(a,c,e){0<=a&&a<this.sceneLayers.length&&this.sceneLayers[a].currentScene.set_background(c,
e)};this.add_layer=function(a,c,e){if("number"==typeof c&&0<=c&&32>c){var b=new X(a,c,e);b.layerType=a;b.layerId=c;b.layerAlpha=e;a==GPE_LAYER_TYPE_TILES&&b.create_new_map(this.tileAmountX,this.tileAmountY);this.sceneLayers.push(b);return b}return IS_NULL};this.add_start_layer=function(a,c,e){var b=this.add_layer(a,c,e);b!=IS_NULL&&this.scenesStartLayers.push({lType:a,lId:c,lAlpha:e});return b};this.get_twsize=function(){return this.tileWidth};this.get_thsize=function(){return this.tileHeight};this.get_map_width=
function(){return this.tileAmountX};this.get_map_height=function(){return this.tileAmountY};this.apply_logic=function(){};this.apply_postlogic=function(){};this.get_scene_name=function(){return 0<this.sceneName.length?sceneName:""};this.set_scene_name=function(a){0<a.length&&(this.sceneName=a)};this.change_background=function(a,c){this.BACKGROUNDS.size()>=c&&-1!=this.BACKGROUNDS.at(c)&&this.BACKGROUNDS.at(c).set_background(a)};this.change_foreground=function(a,c){this.FOREGROUNDS.size()>=c&&-1!=this.FOREGROUNDS.at(c)&&
this.FOREGROUNDS.at(c).set_background(a)};this.snap_xto_grid=function(a){return a/this.tileWidth>this.tAmountX?this.tAmountX:Math.max(0,a/this.tileWidth|0)};this.snap_yto_grid=function(a){return a/this.tileHeight>this.tAmountY?this.tAmountY:Math.max(0,a/this.tileHeight|0)};this.load_game_scene=function(a){this.sceneVersion=-1;this.sceneMapIn=gpe.fileReader.open_file("gamedata/"+a+".js")};this.load_and_parse_scene=function(){this.sceneIsProcessed=!0};this.process_scene=function(){0==this.sceneIsProcessed&&
this.load_and_parse_scene();if(0==this.sceneResourcesAreProcessed&&1==this.sceneHasBeenActivated)gpe.mapCanvas.width=this.sceneWidth,gpe.mapCanvas.height=this.sceneHeight,gpe.mapContext=gpe.mapCanvas.getContext("2d"),gpe.GPE_Current_Context=gpe.preGuiContext=gpe.preGuiCanvas.getContext("2d",{antialias:"2x",stencil:!1,format:"rgba8888",graphicsMemory:!0,dirty:!0}),(new u).update_shape(0,0,this.sceneWidth,this.sceneHeight),this.sceneResourcesAreProcessed=!0;else for(var a,c=this.sceneLayers.length-
1;0<=c;c--)a=this.sceneLayers[c],a.scroll_backgrounds();return!0};this.render_background_color=function(a,c){};this.render_backgrounds=function(a,c,e){if("undefined"!=typeof c)for(var b=0;b<this.BACKGROUNDS.size();b++)-1!=this.BACKGROUNDS.at(b)&&this.BACKGROUNDS.at(b).render_bg(a,c,e,this.sceneWidth,this.sceneHeight)};this.render_foregrounds=function(a,c){for(var d=0;d<this.FOREGROUNDS.size();d++)-1!=this.FOREGROUNDS.at(d)&&this.FOREGROUNDS.at(d).render_bg(a,c,this.sceneWidth,this.sceneHeight)};this.render_scene=
function(a,c){gpe.GPE_Current_Context=a;if(this.sceneResourcesAreProcessed&&this.sceneIsProcessed){var d,b,f,e,h=a;for(d=0;d<this.sceneCamera.length;d++){var n=this.sceneCamera[d];n.isVisible&&1}GPE.currentCameraInView=0;n=c.collisionSpacesInView;gpe.render_calls=0;for(d=this.sceneLayers.length-1;0<=d;d--){var p=this.sceneLayers.at(d);-1!=p&&p.begin_render(n)}jXTempTo=iYTempTo=jXTempFrom=iYTempFrom=0;for(d=this.sceneCamera.length-1;0<=d;d--)if(GPE.currentCameraInView=d,n=this.sceneCamera[d],n.isVisible){a=
gpe.GPE_Current_Context=gpe.EXTRA_CONTEXTS[d];a.fillStyle=this.bgColor;gpe.set_render_alpha(255);a.fillRect(0,0,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT);iYTempFrom=n.cameraRect.get_y();jXTempFrom=n.cameraRect.get_x();iYTempTo=n.cameraRect.get_y()+n.cameraRect.get_height();jXTempTo=n.cameraRect.get_x()+n.cameraRect.get_width();gpe.CURRENT_VIEW=n;gpe.CURRENT_VIEW_BOX=n.cameraRect;for(b=0;b<this.sceneLayers.length;b++)if(p=this.sceneLayers.at(b),-1!=p){if(p.layerType==GPE_LAYER_TYPE_TILES){if(0<this.tileWidth&&
0<this.tileHeight)for(jXTempFrom=jXTempFrom/this.tileWidth|0,iYTempFrom=iYTempFrom/this.tileHeight|0,jXTempTo=(jXTempTo+this.tileWidth)/this.tileWidth|0,iYTempTo=(iYTempTo+this.tileHeight)/this.tileHeight|0,f=iYTempFrom;f<iYTempTo;f++)for(e=jXTempFrom;e<jXTempTo;e++){var m=p.get_tile_at(e,f);"undefined"!=typeof m&&-1!=m&&m.render_self(a,n.cameraRect)}}else if(p.layerType==GPE_LAYER_TYPE_BACKGROUND&&0<p.layerBackgrounds.length)for(f=0;f<p.layerBackgrounds.length;f++)p.layerBackgrounds[f].render_bg(a,
n.cameraRect,n.cameraRect,this.sceneWidth,this.sceneHeight);p.render_objects()}gpe.CURRENT_VIEW_BOX.xPos=0;for(b=gpe.CURRENT_VIEW_BOX.yPos=0;b<this.sceneLayers.length;b++)p=this.sceneLayers.at(b),-1!=p&&p.render_hud_objects();"undefined"!=typeof h&&h.drawImage(gpe.EXTRA_CANVASES[d],n.renderRect.get_x(),n.renderRect.get_y(),n.renderRect.get_width(),n.renderRect.get_height())}GPE.currentCameraInView=0;this.splitRenderMode+=1;a=h;a.font="bold 16pt Calibri";a.textAlign="right";a.fillStyle="#000";if(GPE_SETTINGS_IS_DEBUGGING){for(d=
0;d<this.sceneCamera.length;d++)if(GPE.currentCameraInView=d,n=this.sceneCamera[d],n.isVisible)for(p=c.COLLISION_AREA_SPACES.length-1;-0<=p;p--)m=c.COLLISION_AREA_SPACES[p],m=m.boxArea,h.beginPath(),h.rect(m.get_x()-n.cameraRect.get_x(),m.get_y()-n.cameraRect.get_y(),m.get_width(),m.get_height()),h.lineWidth=1,0<=GPR.collisionSpacesInView.indexOf(p)?h.strokeStyle="red":h.strokeStyle="blue",h.stroke(),h.font="bold 16pt Calibri",h.textAlign="center",h.fillStyle="blue",h.fillText(p,m.get_x()-n.cameraRect.get_x()+
32,m.get_y()-n.cameraRect.get_y()+32);a.font="bold 16pt Calibri";a.textAlign="left";a.fillStyle="maroon";a.fillText("Scene Info || Version: "+this.sceneVersion+" | "+this.sceneWidth+" | "+this.sceneHeight,32,300);a.fillText("Collision Grids: "+c.COLLISION_AREA_SPACES.length+" ("+c.spatialGridWidthAmount+" X "+c.spatialGridHeightAmount+") for "+c.OBJECT_COUNT+" objects",32,364);a.textAlign="left";a.fillText("Scene Name: "+this.sceneName,32,gpe.SCREEN2_HEIGHT-64)}}else gpe.context.fillStyle=this.bgColor,
gpe.context.fillRect(0,0,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT)}}var C=0,v=0,z=GPE_PreloadImageResource.length,B=window.location;B=""+B;B=B.substring(0,B.lastIndexOf("/"));var t={STATE_NULL:0,STATE_LOAD_RESOURCES:1,STATE_LOGO_DISPLAY:2,STATE_INTRO:3,STATE_TITLE:4,STATE_MAINMENU:5,STATE_GAME_LOADING:6,STATE_MAINGAME:7,STATE_LEVEL_EDITOR:8,STATE_CREDITS:9,STATE_CUTSCENE:10,STATE_FLASHBACK:11,STATE_OPTIONS:12,STATE_EXIT:13},y=0,E;y=t.STATE_NULL;window.onload=function(){gpe=GPE=new T(GPE_SETTINGS_SCREEN_WIDTH,
GPE_SETTINGS_SCREEN_HEIGHT,854,480,GPE_SETTINGS_SYSTEM_OS);gpe.canvas=document.getElementById("gpeCanvas");gpe.masterScaleX=1;gpe.masterScaleY=1;window.addEventListener("resize",gpe.handle_canvas_size,!0);document.addEventListener("keydown",gpe.handle_key_down,!1);document.addEventListener("keypress",gpe.handle_key_press,!1);document.addEventListener("keyup",gpe.handle_key_up,!1);gpe.canvas.addEventListener("mousedown",gpe.update_mouse_down,!1);gpe.canvas.addEventListener("mouseup",gpe.update_mouse_up,
!1);gpe.canvas.addEventListener("mousemove",gpe.update_game_mouse,!1);gpe.canvas.addEventListener("mouseout",gpe.reset_game_mouse,!1);gpe.canvas.addEventListener("mouseleave",gpe.reset_game_mouse,!1);gpe.context=gpe.canvas.getContext("2d",{antialias:"2x",stencil:!1,format:"rgba8888",graphicsMemory:!0,dirty:!0});gpe.GPE_Current_Context=gpe.context;gpe.context.rect(0,0,gpe.context.width,gpe.context.height);gpe.context.save();gpe.inputController=new I;gpe.rsm=new N;for(var e=0;e<gpe.maxCameras;e++)gpe.EXTRA_CANVASES[e]=
gpe.add_canvas("exCamera"+e,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT),gpe.EXTRA_CANVASES[e].style.visibility="hidden",gpe.EXTRA_CANVASES[e].style.display="none",gpe.EXTRA_CONTEXTS[e]=gpe.EXTRA_CANVASES[e].getContext("2d",{antialias:"2x",stencil:!1,format:"rgba8888",graphicsMemory:!0,dirty:!0});gpe.mapCanvas=gpe.add_canvas("gameMap",GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT);gpe.mapCanvas.className="hide";gpe.preGuiCanvas=gpe.add_canvas("preGuiCanvas",GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT);
gpe.preGuiCanvas.className="hide";gpe.fileReader=new A;E=t.STATE_LOGO_DISPLAY;gpe.currentState=new F;GPR=gpe.currentState;gpe.handle_canvas_size();window.requestAnimationFrame(gpe.gameloop)};window.countFPS=function(){var e=(new Date).getMilliseconds(),a=1,d=0;return function(){var c=(new Date).getMilliseconds();e>c?(d=a,a=1):a+=1;e=c;return d}}()})();GPE_LAYER_TYPE_TILES=0;GPE_LAYER_TYPE_BACKGROUND=1;GPE_LAYER_TYPE_MAX=GPE_LAYER_TYPE_OBJECTS=2;GPE_DRAW_OBJECT_BOXES=!1;pie=pi=PI=Math.PI;degreesMultiple=-180/PI;radiansMultiple=-PI/180;fa_left=0;fa_center=1;fa_right=2;fa_top=0;fa_middle=1;fa_bottom=2;GPE_TO_RADIANS=Math.PI/180;newestFileData=GPR=GPE=gpe=isnull=IS_NULL=-1;game=game||{};nwft=nwft||{};preloadedImageSRC=[];preloadedImages=[];GPE_AAC=0;GPE_MP3=1;GPE_OGG=2;GPE_WAV=3;GPE_SUPPORTED_AUDIO_FORMAT_COUNT=4;GPE_MP4=0;GPE_WEBM=1;
GPE_VIDEO_OGG=2;GPE_SUPPORTED_VIDEO_FORMAT_COUNT=3;GPE_EOT=0;GPE_TTF=1;GPE_SVG=2;GPE_WOFF=3;GPE_WOFF2=4;GPE_SUPPORTED_FONT_FORMAT_COUNT=5;GPE_AUDIO_PLAYABLE=[-1,-1,-1,-1];GPE_TempVariable=document.createElement("audio");GPE_OtherTempVariable=GPE_TempVariable.canPlayType("audio/aac");"probably"==GPE_OtherTempVariable?GPE_AUDIO_PLAYABLE[GPE_AAC]=1:"maybe"==GPE_OtherTempVariable&&(GPE_AUDIO_PLAYABLE[GPE_AAC]=0);GPE_OtherTempVariable=GPE_TempVariable.canPlayType("audio/mpeg");
"probably"==GPE_OtherTempVariable?GPE_AUDIO_PLAYABLE[GPE_MP3]=1:"maybe"==GPE_OtherTempVariable&&(GPE_AUDIO_PLAYABLE[GPE_MP3]=0);GPE_OtherTempVariable=GPE_TempVariable.canPlayType("audio/ogg");"probably"==GPE_OtherTempVariable?GPE_AUDIO_PLAYABLE[GPE_OGG]=1:"maybe"==GPE_OtherTempVariable&&(GPE_AUDIO_PLAYABLE[GPE_OGG]=0);GPE_OtherTempVariable=GPE_TempVariable.canPlayType("audio/wav");
"probably"==GPE_OtherTempVariable?GPE_AUDIO_PLAYABLE[GPE_WAV]=1:"maybe"==GPE_OtherTempVariable&&(GPE_AUDIO_PLAYABLE[GPE_WAV]=0);GPE_VIDEO_PLAYABLE=[-1,-1,-1,-1];GPE_TempVariable=document.createElement("video");GPE_OtherTempVariable=GPE_TempVariable.canPlayType("video/mp4");"probably"==GPE_OtherTempVariable?GPE_VIDEO_PLAYABLE[GPE_MP4]=1:"maybe"==GPE_OtherTempVariable&&(GPE_VIDEO_PLAYABLE[GPE_MP4]=0);GPE_OtherTempVariable=GPE_TempVariable.canPlayType("video/webm");
"probably"==GPE_OtherTempVariable?GPE_VIDEO_PLAYABLE[GPE_WEBM]=1:"maybe"==GPE_OtherTempVariable&&(GPE_VIDEO_PLAYABLE[GPE_WEBM]=0);GPE_OtherTempVariable=GPE_TempVariable.canPlayType("video/ogg");"probably"==GPE_OtherTempVariable?GPE_VIDEO_PLAYABLE[GPE_VIDEO_OGG]=1:"maybe"==GPE_OtherTempVariable&&(GPE_VIDEO_PLAYABLE[GPE_VIDEO_OGG]=0);GPE_AUD_TYPE_NAME=["video/mp4","video/webm","video/ogg"];GPE_TempVariable=IS_NULL;GPE_MASTER_COLLISION_LIST=[];GAMEPAD_SUPPORTED=!1;
navigator.getGamepads&&(GAMEPAD_SUPPORTED=!0);inheritsFrom=function(w,x){w.prototype=Object.create(x.prototype)};function addSourceToVideo(w,x,D){var A=document.createElement("source");A.src=x;A.type=D;w.appendChild(A)}gc_nobutton=gc_nocontroller=gc_anycontroller=-1;gc_anybutton=-2;gc_joystick_left_x=0;gc_joystick_left_y=1;gc_joystick_right_x=2;gc_joystick_right_y=3;gc_joystick_dpad_x=4;gc_joystick_dpad_y=5;gc_left=0;gc_right=1;gc_up=2;gc_down=3;gc_but0=4;gc_but1=5;gc_but2=6;gc_but3=7;gc_l1=8;
gc_l2=9;gc_l3=10;gc_r1=11;gc_r2=12;gc_r3=13;gc_start=14;gc_select=15;gc_home=16;gc_share=17;mb_left=0;mb_right=1;mb_center=mb_middle=2;kb_nokey=-1;kb_anykey=-2;kb_backspace=8;kb_tab=9;kb_enter=13;kb_pause=19;kb_caps=20;kb_esc=27;kb_space=32;kb_page_up=33;kb_page_down=34;kb_end=35;kb_home=36;kb_left=37;kb_up=38;kb_right=39;kb_down=40;kb_insert=45;kb_delete=46;kb_0=48;kb_1=49;kb_2=50;kb_3=51;kb_4=52;kb_5=53;kb_6=54;kb_7=55;kb_8=56;kb_9=57;kb_a=65;kb_b=66;kb_c=67;kb_d=68;kb_e=69;kb_f=70;kb_g=71;
kb_h=72;kb_i=73;kb_j=74;kb_k=75;kb_l=76;kb_m=77;kb_n=78;kb_o=79;kb_p=80;kb_q=81;kb_r=82;kb_s=83;kb_t=84;kb_u=85;kb_v=86;kb_w=87;kb_x=88;kb_y=89;kb_z=90;kb_np0=96;kb_np1=97;kb_np2=98;kb_np3=99;kb_np4=100;kb_np5=101;kb_np6=102;kb_np7=103;kb_np8=104;kb_np9=105;kb_multiply=106;kb_add=107;kb_substract=109;kb_decimal=110;kb_divide=111;kb_f1=112;kb_f2=113;kb_f3=114;kb_f4=115;kb_f5=116;kb_f6=117;kb_f7=118;kb_f8=119;kb_f9=120;kb_f10=121;kb_f11=122;kb_f12=123;kb_shift=16;kb_ctrl=17;kb_alt=18;kb_plus=187;
kb_comma=188;kb_minus=189;kb_period=190;kb_fslash=191;kb_gaccent=192;kb_bslash=kb_obracket=220;kb_cbracket=221;kb_squote=222;gp_nokey=-1;gp_anykey=-2;gp_backspace=8;gp_tab=9;gp_enter=13;gp_pause=19;gp_caps=20;gp_esc=27;gp_space=32;gp_page_up=33;gp_page_down=34;gp_end=35;gp_home=36;gp_left=37;gp_up=38;gp_right=39;gp_down=40;gp_insert=45;gp_delete=46;gp_0=48;gp_1=49;gp_2=50;gp_3=51;gp_4=52;gp_5=53;gp_6=54;gp_7=55;gp_8=56;gp_9=57;gp_a=65;gp_b=66;gp_c=67;gp_d=68;gp_e=69;gp_f=70;gp_g=71;gp_h=72;gp_i=73;
gp_j=74;gp_k=75;gp_l=76;gp_m=77;gp_n=78;gp_o=79;gp_p=80;gp_q=81;gp_r=82;gp_s=83;gp_t=84;gp_u=85;gp_v=86;gp_w=87;gp_x=88;gp_y=89;gp_z=90;gp_np0=96;gp_np1=97;gp_np2=98;gp_np3=99;gp_np4=100;gp_np5=101;gp_np6=102;gp_np7=103;gp_np8=104;gp_np9=105;gp_multiply=106;gp_add=107;gp_substract=109;gp_decimal=110;gp_divide=111;gp_f1=112;gp_f2=113;gp_f3=114;gp_f4=115;gp_f5=116;gp_f6=117;gp_f7=118;gp_f8=119;gp_f9=120;gp_f10=121;gp_f11=122;gp_f12=123;gp_shift=16;gp_ctrl=17;gp_alt=18;gp_plus=187;gp_comma=188;
gp_minus=189;gp_period=190;gp_fslash=191;gp_gaccent=192;gp_bslash=gp_obracket=220;gp_cbracket=221;gp_squote=222;
(function(){function w(e){y!=t.STATE_EXIT&&(y=e)}function x(e){return!e.complete||"undefined"!=typeof e.naturalWidth&&0==e.naturalWidth?!1:!0}function D(e){this.dataSource="";this.fileName=e;this.fileLines=[];this.fileType=this.fileLines[0]="";this.fileLinePos=-1;this.fileIsReady=!1;this.is_open=function(){return this.fileIsReady};this.is_good=function(){return this.fileIsReady?this.fileLinePos<this.fileLines.length?!0:!1:IS_NULL};this.get_next_line=function(){return this.fileIsReady?this.fileLinePos<
this.fileLines.length-1?(this.fileLinePos+=1,this.fileLines[this.fileLinePos]):this.fileLinePos+=1:IS_NULL};this.get_line_count=function(){return this.fileIsReady?this.fileLines.length:-1};this.get_line_pos=function(){return this.fileIsReady?this.fileLinePos:-1};this.get_remaining_lines=function(){if(this.fileIsReady)return this.fileLines.length-this.fileLinePos};this.process_file_as_text=function(){for(var a=this.dataSource.split("*nl*"),d=0;d<a.length;d++)this.fileLines[d]=a[d];this.fileIsReady=
!0};this.close_file=function(){this.fileIsReady}}function A(){this.frLoadedFiles=[];this.osFileReader=-1;this.fileObbj;this.lastFileOpened="";this.frFileCount=0;this.recognize_new_file=function(e){""!=this.lastFileOpened&&(this.frLoadedFiles[this.frFileCount]=e,e.process_file_as_text());this.lastFileOpened="";this.frFileCount+=1};this.open_file=function(e,a){if(""!=e&&3<e.length){newestFileData=new D(e,a);this.lastFileOpened=e;var d=document.createElement("script");d.type="text/javascript";d.src=
e||null;d.innerHTML=d.src||null;document.getElementsByTagName("head")[0].appendChild(d);return newestFileData}return IS_NULL};this.open_new_file=function(e,a){};this.open_write_file=function(e,a){}}function H(){this.controllerType=IS_NULL;this.deviceType=this.detectedDeviceType=this.controllerExtension="";this.systemController=IS_NULL;this.isConnected=!1;this.timestamp=this.mapping=0;this.button_count=25;this.axes_count=16;this.touch_mouse_y=this.touch_mouse_x=this.system_axes_count=0;this.prevHit=
[];this.butIsDown=[];this.butIsPressed=[];this.butIsReleased=[];this.butIsLocked=[];this.axesMap=[];this.buttonsMap=[];for(var e=0;e<this.button_count;e++)this.prevHit[e]=!1,this.butIsDown[e]=!1,this.butIsPressed[e]=!1,this.butIsReleased[e]=!1,this.butIsLocked[e]=!1,this.buttonsMap[e]=e;this.axesValues=[];for(e=0;e<this.axes_count;e++)this.axesMap[e]=e,this.axesValues[e]=0;this.map_to_ds4_chrome=function(){this.buttonsMap[gc_left]=14;this.buttonsMap[gc_right]=15;this.buttonsMap[gc_up]=12;this.buttonsMap[gc_down]=
13;this.buttonsMap[gc_but0]=0;this.buttonsMap[gc_but1]=1;this.buttonsMap[gc_but2]=2;this.buttonsMap[gc_but3]=3;this.buttonsMap[gc_l1]=4;this.buttonsMap[gc_l2]=6;this.buttonsMap[gc_l3]=10;this.buttonsMap[gc_r1]=5;this.buttonsMap[gc_r2]=7;this.buttonsMap[gc_r3]=11;this.buttonsMap[gc_home]=16;this.buttonsMap[gc_select]=9;this.buttonsMap[gc_share]=8;this.buttonsMap[gc_start]=17;this.axesMap[gc_joystick_left_x]=0;this.axesMap[gc_joystick_left_y]=1};this.map_to_ds4_firefox=function(){this.buttonsMap[gc_left]=
14;this.buttonsMap[gc_right]=15;this.buttonsMap[gc_up]=12;this.buttonsMap[gc_down]=13;this.buttonsMap[gc_but0]=1;this.buttonsMap[gc_but1]=2;this.buttonsMap[gc_but2]=0;this.buttonsMap[gc_but3]=3;this.buttonsMap[gc_l1]=4;this.buttonsMap[gc_l2]=6;this.buttonsMap[gc_l3]=10;this.buttonsMap[gc_r1]=5;this.buttonsMap[gc_r2]=7;this.buttonsMap[gc_r3]=11;this.buttonsMap[gc_home]=16;this.buttonsMap[gc_select]=9;this.buttonsMap[gc_share]=8;this.buttonsMap[gc_start]=17};this.map_to_switchpro_chrome=function(){this.buttonsMap[gc_left]=
14;this.buttonsMap[gc_right]=15;this.buttonsMap[gc_up]=12;this.buttonsMap[gc_down]=13;this.buttonsMap[gc_but0]=1;this.buttonsMap[gc_but1]=0;this.buttonsMap[gc_but2]=3;this.buttonsMap[gc_but3]=2;this.buttonsMap[gc_l1]=4;this.buttonsMap[gc_l2]=6;this.buttonsMap[gc_l3]=10;this.buttonsMap[gc_r1]=5;this.buttonsMap[gc_r2]=7;this.buttonsMap[gc_r3]=11;this.buttonsMap[gc_home]=12;this.buttonsMap[gc_select]=8;this.buttonsMap[gc_share]=13;this.buttonsMap[gc_start]=9};this.map_to_switchpro_firefox=function(){this.buttonsMap[gc_left]=
14;this.buttonsMap[gc_right]=15;this.buttonsMap[gc_up]=12;this.buttonsMap[gc_down]=13;this.buttonsMap[gc_but0]=1;this.buttonsMap[gc_but1]=0;this.buttonsMap[gc_but2]=3;this.buttonsMap[gc_but3]=2;this.buttonsMap[gc_l1]=4;this.buttonsMap[gc_l2]=6;this.buttonsMap[gc_l3]=10;this.buttonsMap[gc_r1]=5;this.buttonsMap[gc_r2]=7;this.buttonsMap[gc_r3]=11;this.buttonsMap[gc_home]=12;this.buttonsMap[gc_select]=8;this.buttonsMap[gc_share]=13;this.buttonsMap[gc_start]=9};this.map_to_ds4_chrome();this.check_connection=
function(){return this.isConnected};this.check_button=function(a){if(this.isConnected){if(0<=a&&a<this.button_count)return 0<this.butIsDown[this.buttonsMap[a]];if(a==gc_anybutton)for(a=this.button_count-1;0<=a;a--){if(0<this.butIsDown[this.buttonsMap[a]])return!0}else if(a==gc_nobutton){for(a=this.button_count-1;0<=a;a--)if(0<this.butIsDown[this.buttonsMap[a]])return!1;return!0}}return!1};this.check_button_pressed=function(a){if(this.isConnected){if(0<=a&&a<this.button_count)return 0<this.butIsPressed[this.buttonsMap[a]];
if(a==gc_anybutton)for(a=this.button_count-1;0<=a;a--){if(0<this.butIsPressed[this.buttonsMap[a]])return!0}else if(a==gc_nobutton){for(a=this.button_count-1;0<=a;a--)if(0<this.butIsPressed[this.buttonsMap[a]])return!1;return!0}}return!1};this.check_button_released=function(a){if(this.isConnected){if(0<=a&&a<this.button_count)return this.butIsReleased[this.buttonsMap[a]];if(a==gc_anybutton)for(a=this.button_count-1;0<=a;a--){if(0<this.butIsReleased[this.buttonsMap[a]])return!0}else if(a==gc_nobutton){for(a=
this.button_count-1;0<=a;a--)if(0<this.butIsReleased[this.buttonsMap[a]])return!1;return!0}}return!1};this.gamepad_get_axes_count=function(){return this.system_axes_count};this.find_gamepad_axes_mapping=function(a){return 0<=a&&a<this.axes_count?this.axesMap[a]:-1};this.find_gamepad_button_mapping=function(a){return 0<=a&&a<this.button_count?this.axesMap[a]:-1};this.gamepad_map_axes=function(a,d){return 0<=a&&a<this.axes_count&&0<=d&&d<this.axes_count?(this.buttonsMap[a]=d,!0):!1};this.gamepad_map_button=
function(a,d){return 0<=a&&a<this.button_count&&0<=d&&d<this.button_count?(this.buttonsMap[a]=d,!0):!1};this.reset_controller=function(){for(var a=0;a<this.button_count;a++)this.butIsPressed[this.buttonsMap[a]]=this.butIsDown[this.buttonsMap[a]]&&!this.prevHit[this.buttonsMap[a]],this.butIsReleased[this.buttonsMap[a]]=!this.butIsDown[this.buttonsMap[a]]&&this.prevHit[this.buttonsMap[a]]};this.pure_reset=function(){for(var a=0;a<this.button_count;a++)this.prevHit[this.buttonsMap[a]]=!1,this.butIsDown[this.buttonsMap[a]]=
!1,this.butIsPressed[this.buttonsMap[a]]=!1,this.butIsReleased[this.buttonsMap[a]]=!1,this.butIsLocked[this.buttonsMap[a]]=!1;for(a=0;a<this.axes_count;a++)this.axesValues[a]=0}}function I(){this.mouse_button_count=3;this.key_count=225;this.joy_key_count=2;this.prevHit=[];this.keyIsDown=[];this.keyIsPressed=[];this.keyIsReleased=[];this.keyIsLocked=[];this.mousePrevHit=[];this.mbIsDown=[];this.mbIsPressed=[];this.mbIsReleased=[];this.mbIsLocked=[];this.asyncKeyIsDown=[];this.asyncKeyIsPressed=[];
this.asyncKeyIsReleased=[];this.asyncKeyIsLocked=[];this.asyncMousePrevHit=[];this.asyncMbIsDown=[];this.asyncMbIsPressed=[];this.asyncMbIsReleased=[];this.asyncMbIsLocked=[];this.game_controllers=[];this.max_controllers=5;for(var e=0;e<this.key_count;e++)this.prevHit[e]=!1,this.keyIsDown[e]=!1,this.keyIsPressed[e]=!1,this.keyIsReleased[e]=!1,this.keyIsLocked[e]=!1,this.asyncKeyIsDown[e]=!1,this.asyncKeyIsPressed[e]=!1,this.asyncKeyIsReleased[e]=!1,this.asyncKeyIsLocked[e]=!1;for(e=0;e<this.mouse_button_count;e++)this.mousePrevHit[e]=
!1,this.mbIsDown[e]=!1,this.mbIsPressed[e]=!1,this.mbIsReleased[e]=!1,this.mbIsLocked[e]=!1,this.asyncMousePrevHit[e]=!1,this.asyncMbIsDown[e]=!1,this.asyncMbIsPressed[e]=!1,this.asyncMbIsReleased[e]=!1,this.asyncMbIsLocked[e]=!1;for(e=0;e<this.max_controllers;e++)this.game_controllers[e]=new H;this.gamepad_connected=function(a){return 0<=a&&a<this.max_controllers?this.game_controllers[a].isConnected:-1};this.gamepad_detected_name=function(a){return 0<=a&&a<this.max_controllers?this.game_controllers[a].detectedDeviceType:
""};this.gamepad_name=function(a){return 0<=a&&a<this.max_controllers?this.game_controllers[a].deviceType:""};this.gamepad_object=function(a){return 0<=a&&a<this.max_controllers?this.game_controllers[a]:IS_NULL};this.gamepad_get_axes_count=function(a){return 0<=a&&a<this.max_controllers?this.game_controllers[a].gamepad_get_axes_count():-1};this.find_gamepad_mapping=function(a,d){return 0<=a&&a<this.max_controllers?this.game_controllers[a].find_gamepad_mapping(a,d):-1};this.check_gamepad=function(a,
d){if(0<=a&&a<this.max_controllers)return this.game_controllers[a].check_button(d);if(a==gc_anycontroller)for(var c=this.game_controllers.length-1;0<=c;c--)if(this.game_controllers[c].check_button(d))return!0;return!1};this.check_gamepad_down=function(a,d){if(0<=a&&a<this.max_controllers)return this.game_controllers[a].check_button(d);if(a==gc_anycontroller)for(var c=this.game_controllers.length-1;0<=c;c--)if(this.game_controllers[c].check_button(d))return!0;return!1};this.check_gamepad_pressed=function(a,
d){if(0<=a&&a<this.max_controllers)return this.game_controllers[a].check_button_pressed(d);if(a==gc_anycontroller)for(var c=this.game_controllers.length-1;0<=c;c--)if(this.game_controllers[c].check_button_pressed(d))return!0;return!1};this.check_gamepad_released=function(a,d){if(0<=a&&a<this.max_controllers)return this.game_controllers[a].check_button_released(d);if(a==gc_anycontroller)for(var c=this.game_controllers.length-1;0<=c;c--)if(this.game_controllers[c].check_button_released(d))return!0;
return!1};this.find_gamepad_axes_mapping=function(a,d){return 0<=a&&a<this.max_controllers?this.game_controllers[a].find_gamepad_axes_mapping(d):IS_NULL};this.find_gamepad_button_mapping=function(a,d){return 0<=a&&a<this.max_controllers?this.game_controllers[a].find_gamepad_mapping(d):IS_NULL};this.gamepad_map_axes=function(a,d,c){if(0<=a&&a<this.max_controllers)return this.game_controllers[a].gamepad_map_axes(d,c);if(a==gc_anycontroller){a=!1;for(var e=this.game_controllers.length-1;0<=e;e--)this.game_controllers[e].gamepad_map_axes(d,
c)&&(a=!0);return a}return!1};this.gamepad_map_button=function(a,d,c){if(0<=a&&a<this.max_controllers)return this.game_controllers[a].gamepad_map_button(d,c);if(a==gc_anycontroller){a=!1;for(var e=this.game_controllers.length-1;0<=e;e--)this.game_controllers[e].gamepad_map_button(d,c)&&(a=!0);return a}return!1};this.check_keyboard_down=function(a){if(0<=a&&a<this.key_count)return this.keyIsDown[a];if(a==gp_anykey)for(a=this.key_count-1;0<=a;a--){if(0<this.keyIsDown[a])return!0}else if(a==gp_nokey){for(a=
this.key_count-1;0<=a;a--)if(0<this.keyIsDown[a])return!1;return!0}return!1};this.check_keyboard_pressed=function(a){if(0<=a&&a<this.key_count)return this.keyIsPressed[a];if(a==gp_anykey)for(a=this.key_count-1;0<=a;a--){if(0<this.keyIsPressed[a])return!0}else if(a==gp_nokey){for(a=this.key_count-1;0<=a;a--)if(0<this.keyIsPressed[a])return!1;return!0}return!1};this.check_keyboard_released=function(a){if(0<=a&&a<this.key_count)return this.keyIsReleased[a];if(a==gp_anykey)for(a=this.key_count-1;0<=a;a--){if(0<
this.keyIsReleased[a])return!0}else if(a==gp_nokey){for(a=this.key_count-1;0<=a;a--)if(0<this.keyIsReleased[a])return!1;return!0}return!1};this.check_mouse_down=function(a){return 0<=a&&a<this.mouse_button_count?this.mbIsDown[a]:!1};this.check_mouse_pressed=function(a){return 0<=a&&a<this.mouse_button_count?this.mbIsPressed[a]:!1};this.check_mouse_released=function(a){return 0<=a&&a<this.mouse_button_count?this.mbIsReleased[a]:!1};this.get_controller=function(a){for(var d=0,c=IS_NULL,e=0;e<this.max_controllers&&
!(c=this.game_controllers[e],c.isConnected&&d++,d>=a);e++);return c};this.reset_input=function(){var a;for(a=0;a<this.key_count;a++)this.keyIsPressed[a]=this.keyIsDown[a]&&!this.prevHit[a],this.keyIsReleased[a]=!this.keyIsDown[a]&&this.prevHit[a];for(a=0;a<this.mouse_button_count;a++)this.mbIsPressed[a]=this.mbIsDown[a]&&!this.mousePrevHit[a],this.mbIsReleased[a]=!this.mbIsDown[a]&&this.mousePrevHit[a];for(var d=0;d<this.max_controllers;d++)a=this.game_controllers[d],a.reset_controller();for(a=0;a<
this.key_count;a++)this.prevHit[a]=this.keyIsDown[a];for(a=0;a<this.mouse_button_count;a++)this.mousePrevHit[a]=this.mbIsDown[a]};this.handle_key_down=function(a){"undefined"==typeof a&&(a=window.event);var d=parseInt(a.keyCode?a.keyCode:a.which);d<this.key_count&&(d<gp_np0&&a.preventDefault(),this.asyncKeyIsPressed[d]=!0,this.asyncKeyIsDown[d]=!0,this.asyncKeyIsReleased[d]=!1)};this.handle_key_press=function(a){"undefined"==typeof a&&(a=window.event);var d=parseInt(a.keyCode?a.keyCode:a.which);33<
d&&(d-=32);d<this.key_count&&(d<gp_np0&&a.preventDefault(),this.asyncKeyIsPressed[d]=!0,this.asyncKeyIsDown[d]=!0,this.asyncKeyIsReleased[d]=!1)};this.handle_key_up=function(a){"undefined"==typeof a&&(a=window.event);var d=parseInt(a.which);d<this.key_count&&(d<gp_np0&&a.preventDefault(),this.asyncKeyIsPressed[d]=!1,this.asyncKeyIsDown[d]=!1,this.asyncKeyIsReleased[d]=!0)};this.handle_mouse_press=function(a){"undefined"==typeof a&&(a=window.event);a=a.button;a<this.mouse_button_count&&(this.asyncMbIsPressed[a]=
!0,this.asyncMbIsDown[a]=!0,this.asyncMbIsReleased[a]=!1)};this.handle_mouse_up=function(a){"undefined"==typeof a&&(a=window.event);a=a.button;a<this.mouse_button_count&&(this.asyncMbIsPressed[a]=!1,this.asyncMbIsDown[a]=!1,this.asyncMbIsReleased[a]=!0)};this.process_input=function(){var a;for(a=this.key_count-1;0<=a;a--)this.keyIsPressed[a]=this.asyncKeyIsPressed[a],this.keyIsDown[a]=this.asyncKeyIsDown[a],this.keyIsReleased[a]=this.asyncKeyIsReleased[a],this.asyncKeyIsPressed[a]=!1,this.asyncKeyIsReleased[a]=
!1;for(a=this.mouse_button_count-1;0<=a;a--)this.mbIsPressed[a]=this.asyncMbIsPressed[a],this.mbIsReleased[a]=this.asyncMbIsReleased[a],this.asyncMbIsPressed[a]=!1,this.asyncMbIsDown[a]=!1,this.asyncMbIsReleased[a]=!1;var d;if(GAMEPAD_SUPPORTED){a=navigator.getGamepads();for(var c,e,b=0,f=0;f<this.max_controllers&&f<a.length;f++)if(e=a[f],null!=e){c=this.game_controllers[b];if(e.connected){c.deviceType=e.id;c.system_axes_count=e.axes.length;c.isConnected||(console.log("{"+c.deviceType+"} for controller["+
f+"] connected..."),console.log("Controller detected with "+c.system_axes_count+" axes..."),c.pure_reset(),"Wireless Controller (STANDARD GAMEPAD Vendor: 054c Product: 09cc)"==c.deviceType?(c.map_to_ds4_chrome(),c.detectedDeviceType="DullShock4"):"054c-09cc-Wireless Controller"==c.deviceType&&(c.map_to_ds4_firefox(),c.detectedDeviceType="DullShock4"),"Wireless Gamepad (Vendor: 057e Product: 2009)"==c.deviceType?(c.map_to_switchpro_chrome(),c.detectedDeviceType="SwitchPro"):" 057e-2009-Wireless Gamepad"==
c.deviceType&&(c.map_to_switchpro_firefox(),c.detectedDeviceType="SwitchPro"),"Mayflash WiiU Pro Game Controller Adapter (Vendor: 0079 Product: 1800)"==c.deviceType?(c.map_to_wiiupro_mayflash_chrome(),c.detectedDeviceType="WIiUPro_MayFlash"):" 0079-1800-Mayflash WiiU Pro Game Controller Adapter"==c.deviceType&&(c.map_to_wiiupro_mayflash_firefox(),c.detectedDeviceType="WIiUPro_MayFlash"));c.isConnected=!0;c.systemController=e;c.mapping=e.mapping;c.timestamp=e.timestamp;for(d=0;d<c.axes_count&&d<e.axes.length;d++)c.axesValues[d]=
e.axes[d];for(d=0;d<c.button_count&&d<e.buttons.length;d++){var k=c.buttonsMap[d];0<=k&&k<c.button_count&&k<e.buttons.length&&(c.butIsDown[k]=c.butIsPressed[k]=e.buttons[k].pressed,e.buttons[k].pressed&&(c.butIsDown[k]=c.butIsPressed[k]=!0))}}else c.isConnected&&console.log("{"+c.deviceType+"} for controller["+f+"] disconnected..."),c.pure_reset(),c.foundController.systemController=null,c.isConnected=!1,c.deviceType="disconnected",c.mapping="disconnected",c.timestamp=0;b++}}}}function F(){this.stateName=
"LogoDisplay";this.logoImg=new Image;this.logoImg.src=GPE_SETTINGS_APP_LOGO_LOCATION;this.audioPlayed=!1;this.displayedTimes=0;this.maxTilExit=90;this.apply_logic=function(){gpe.check_image_loading_status(this.logoImg)&&(this.displayedTimes+=1,this.displayedTimes>=this.maxTilExit&&w(t.STATE_LOAD_RESOURCES))};this.render_state=function(){if("undefined"!=typeof gpe.context&&(gpe.context.fillStyle="#CCCCCC",gpe.context.fillRect(0,0,gpe.canvas.width,gpe.canvas.height),x(this.logoImg))){var e=0,a=gpe.canvas.width,
d=gpe.canvas.height,c=0;this.logoImg.width<gpe.canvas.width&&(a=this.logoImg.width,e=(gpe.canvas.width-a)/2);this.logoImg.height<gpe.canvas.height&&(d=this.logoImg.height,c=(gpe.canvas.height-d)/2);gpe.context.drawImage(this.logoImg,e,c,a,d);this.displayedTimes>=this.maxTilExit&&w(t.STATE_LOAD_RESOURCES)}}}function J(){this.sceneHeight=this.sceneWidth=0;this.stateName="MainGame";this.currentScene=gpe.gpeScenes[0];this.currentSceneId=0;this.pastSceneId=-1;this.pastSceneName="";this.sceneWasReset=!1;
gpe.play_audio(this.currentScene.startAudio,!1);gpe.loop_audio(this.currentScene.bgMusic);this.sceneToEnter=0;this.currentScene.update_tilemap();this.MOUSE_CAM_X=[];this.MOUSE_CAM_Y=[];this.MOUSE_IN_CAM=[];for(var e=0;e<this.maxCameras;e++)this.MOUSE_CAM_X[e]=0,this.MOUSE_CAM_Y[e]=0,this.MOUSE_IN_CAM[e]=!0;this.GAME_OBJECTS=[];this.GAME_OBJECTS_TO_BE_DESTROYED=[];this.GAME_OBJECTS_TO_DELETE_TYPES=[];this.needToDeleteObjects=!1;this.GAME_OBJECTS_CONTINUOUS=[];this.GAME_OBJECTS_FAMILIES=[];this.OBJECT_COUNT=
0;this.MAIN_GAME_CODE_IS_READ=!1;this.collisionSpacesInView=[];this.spatialGridIsCreated=!1;this.spatialMapHeightSize=this.spatialMapWidthSize=0;this.superDebugCollisions=!1;this.objectCollisionIsChecked={};this.collisionPairA=[];this.collisionPairB=[];this.parsed_objects=this.collisionPairsTotal=0;this.spatialGridHeightAmount=this.spatialGridWidthAmount=2;this.spatialCollisionChecks=this.objectCollisionHashesChecked=0;this.spatialGridIsCreated=!1;this.spatialMapHeightSize=this.spatialMapWidthSize=
-1;this.set_default_grid_size=function(){this.spatialGridHeightSize=this.spatialGridWidthSize=this.spatialGridBoxSize=128};this.set_default_grid_size();this.add_collision_pair=function(a,d){this.collisionPairA[this.collisionPairsTotal]=a;this.collisionPairB[this.collisionPairsTotal]=d;this.collisionPairsTotal+=1};this.add_object_to_deletion_list=function(a){if("undefined"!=typeof a&&-1!=a&&0<=a.gpeObjectType){if(this.GAME_OBJECTS_TO_BE_DESTROYED.length>a.gpeObjectType)this.GAME_OBJECTS_TO_BE_DESTROYED[a.gpeObjectType].push_back(a);
else{for(var c,b=this.GAME_OBJECTS_TO_BE_DESTROYED.length;b<=a.gpeObjectType;b++)c=[],this.GAME_OBJECTS_TO_BE_DESTROYED.push(c);this.GAME_OBJECTS_TO_BE_DESTROYED[this.GAME_OBJECTS_TO_BE_DESTROYED.length-1].push_back(a)}this.GAME_OBJECTS_TO_DELETE_TYPES.push(a.gpeObjectType);this.needToDeleteObjects=!0}};this.add_to_continuous_objects=function(a){if(-1!=a){for(var c=this.GAME_OBJECTS_CONTINUOUS.length-1;0<=c;c--)if(this.GAME_OBJECTS_CONTINUOUS[c].gpeUniqGameObjectId==a.gpeUniqGameObjectId)return!1;
this.GAME_OBJECTS_CONTINUOUS.push(a);this.add_object_to_deletion_list(a);return!0}return!1};this.add_object=function(a,d,b){"number"!=typeof b&&(b=1);d&&(b=a.sceneLayerStartPos);if("undefined"!=typeof a&&-1!=a&&0<=b&&32>b)if(0<=a.gpeObjectType&&-1!=this.currentScene){var c=this.currentScene.get_layer(b,GPE_LAYER_TYPE_OBJECTS);if(-1!=c){if(this.GAME_OBJECTS.length>a.gpeObjectType)b=this.GAME_OBJECTS[a.gpeObjectType],b.push(a),this.GAME_OBJECTS[a.gpeObjectType]=b;else{for(var e=this.GAME_OBJECTS.length;e<=
a.gpeObjectType;e++)b=[],this.GAME_OBJECTS.push_back(b);b=this.GAME_OBJECTS[this.GAME_OBJECTS.length-1];b.push(a)}-1==a.gpeUniqGameObjectId&&(this.OBJECT_COUNT+=1,a.gpeUniqGameObjectId=this.OBJECT_COUNT);a.isInit=!0;a.gpeSceneStartCodeUsed=!1;for(e=0;e<gpe.maxCameras;e++)a.isInView[e]=!0;1==a.isViewIndependent&&(c.independentObjects.push(a),a.indepedentCameraPos=c.independentObjects.length-1);c.layerObjects.push(a);d||(a.gpeSceneStartId=this.currentSceneId);this.update_object_in_map(a);a.GPE_AddedToGridSystem=
!0;this.sceneIsSpatiallyPartitioned=!1}else console.log("Unable to obtain layer from current scene with id: ["+b+"].")}else console.log("Unable to add object of type ["+a.gpeObjectType+"].");else console.log("Undefined object added...")};this.apply_game_collisions=function(){for(var a,d,b=this.collisionPairsTotal-1;0<=b;b--)a=this.collisionPairA[b],d=this.collisionPairB[b],a.collide_with(d),d.collide_with(a)};this.apply_spatial_game_objects_prelogics=function(){for(var a,d,b,e,k,h=this.currentScene.sceneLayers.length-
1;0<=h;h--){k=this.currentScene.sceneLayers[h];for(e=k.independentObjects.length-1;0<=e;e--)b=k.independentObjects[e],0==b.gpePrelogicAppliedInFrame&&b.isInit&&!b.gpeIsBeingDestroyed&&(b.perform_object_prelogic(),b.gpeHasStartLogicFunction&&b.start_frame_logic(),b.gpeHasTimedFunctions&&b.process_timed_functions(),b.process_gpe_movement(),b.gpePrelogicAppliedInFrame=!0);for(e=this.collisionSpacesInView.length-1;0<=e;e--)if(b=this.collisionSpacesInView[e],0<=b&&b<k.COLLISION_AREA_SPACES.size())for(d=
k.COLLISION_AREA_SPACES.at(b),a=d.internalArray.length-1;0<=a;a--)b=d.internalArray[a],0==b.isViewIndependent&&0==b.gpePrelogicAppliedInFrame&&b.isInit&&!b.gpeIsBeingDestroyed&&(b.perform_object_prelogic(),b.gpeHasStartLogicFunction&&b.start_frame_logic(),b.gpeHasTimedFunctions&&b.process_timed_functions(),b.process_gpe_movement(),b.gpePrelogicAppliedInFrame=!0);for(e=k.COLLISION_AREA_OUTSIDE_SCENE.internalArray.length-1;0<=e;e--)b=k.COLLISION_AREA_OUTSIDE_SCENE.internalArray[e],0==b.isViewIndependent&&
0==b.gpePrelogicAppliedInFrame&&b.isInit&&!b.gpeIsBeingDestroyed&&(b.perform_object_prelogic(),b.gpeHasStartLogicFunction&&b.start_frame_logic(),b.gpeHasTimedFunctions&&b.process_timed_functions(),b.process_gpe_movement(),b.gpePrelogicAppliedInFrame=!0)}};this.apply_spatial_game_objects_logics=function(){for(var a,d,b,e,k=this.currentScene.sceneLayers.length-1;0<=k;k--){e=this.currentScene.sceneLayers[k];for(a=e.independentObjects.length-1;0<=a;a--)b=e.independentObjects[a],b.isInit&&0==b.gpeLogicAppliedInFrame&&
0==b.gpeIsBeingDestroyed&&(0!=b.imageSpeed&&b.update_animation(),b.gpeHasLogicFunction&&b.perform_object_logic(),b.gpeLogicAppliedInFrame=!0);for(a=e.COLLISION_AREA_OUTSIDE_SCENE.internalArray.length-1;0<=a;a--)b=e.COLLISION_AREA_OUTSIDE_SCENE.internalArray[a],0==b.isViewIndependent&&b.isInit&&0==b.gpeLogicAppliedInFrame&&0==b.gpeIsBeingDestroyed&&(0!=b.imageSpeed&&b.update_animation(),b.perform_object_logic(),b.gpeLogicAppliedInFrame=!0);for(var h=this.collisionSpacesInView.length-1;0<=h;h--)for(d=
e.COLLISION_AREA_SPACES.at(this.collisionSpacesInView[h]),a=d.objectsHeld-1;0<=a;a--)b=d.internalArray[a],0==b.isViewIndependent&&b.isInit&&0==b.gpeLogicAppliedInFrame&&0==b.gpeIsBeingDestroyed&&(0!=b.imageSpeed&&b.update_animation(),b.gpeHasLogicFunction&&b.perform_object_logic(),b.gpeLogicAppliedInFrame=!0)}};this.apply_logic=function(){if(-1!=this.currentScene)for(var a=0;a<gpe.maxCameras;a++){var d=this.currentScene.sceneCamera[a];if(1==d.isVisible){var b=gpe.masterScaleY;this.MOUSE_CAM_X[a]=
gpe.MOUSE_SCALED_X+d.cameraRect.xPos-gpe.masterScaleX*d.renderRect.xPos|0;this.MOUSE_CAM_Y[a]=gpe.MOUSE_SCALED_Y+d.cameraRect.yPos-b*d.renderRect.yPos|0;0<this.MOUSE_CAM_X[a]&&0<=this.MOUSE_CAM_Y[a]?this.MOUSE_IN_CAM[a]=!0:(this.MOUSE_CAM_X[a]=0,this.MOUSE_CAM_Y[a]=0,this.MOUSE_IN_CAM[a]=!1)}else this.MOUSE_CAM_X[a]=0,this.MOUSE_CAM_Y[a]=0,this.MOUSE_IN_CAM[a]=!1}0==this.GAME_OBJECTS_FAMILIES.length&&GPE.activate_object_families();this.process_scene_movement();if(-1!=this.currentScene&&(1!=this.currentScene.sceneHasBeenActivated&&
(this.begin_spatialpartioning(this.currentScene.sceneWidth,this.currentScene.sceneHeight),this.currentScene.scene_init(),this.sceneWidth=this.currentScene.sceneWidth,this.sceneHeight=this.currentScene.sceneHeight),this.currentScene.process_scene(),this.currentScene.sceneIsProcessed&&this.currentScene.sceneResourcesAreProcessed)){this.delete_selected_objects();this.calculate_camera_spacing();this.prepare_game_frame();this.apply_spatial_game_objects_prelogics();var e,k,h;for(k=this.currentScene.sceneLayers.length-
1;0<=k;k--){var n=this.currentScene.sceneLayers[k];if(1==Game_SelfCollideLayerList[n.layerId]){for(e=this.collisionSpacesInView.length-1;0<=e;e--){var p=this.collisionSpacesInView[e];0<=p&&p<n.COLLISION_AREA_SPACES.size()&&(a=n.COLLISION_AREA_SPACES.at(p),this.find_collisions_of_spatialpartion(a))}this.find_collisions_of_spatialpartion(n.COLLISION_AREA_OUTSIDE_SCENE)}d=Game_LayerMatrix[n.layerId];for(b=d.length-1;0<=b;b--){var m=d[b];for(h=k-1;0<=h;h--){var l=this.currentScene.sceneLayers[h];if(l.layerId==
m){for(e=this.collisionSpacesInView.length-1;0<=e;e--)p=this.collisionSpacesInView[e],0<=p&&p<l.COLLISION_AREA_SPACES.size()&&(a=n.COLLISION_AREA_SPACES.at(p),p=l.COLLISION_AREA_SPACES.at(p),this.find_collisions_of_two_spatialpartions(a,p));this.find_collisions_of_two_spatialpartions(n.COLLISION_AREA_OUTSIDE_SCENE,l.COLLISION_AREA_OUTSIDE_SCENE)}}}}this.apply_game_collisions();this.apply_spatial_game_objects_logics();this.delete_selected_objects()}};this.calculate_camera_spacing=function(){this.collisionSpacesInView=
[];var a,d,b;if(this.currentScene.sceneIsProcessed&&this.currentScene.sceneResourcesAreProcessed){var e=IS_NULL;for(a=0;a<this.currentScene.sceneLayers.length;a++){var k=this.currentScene.sceneLayers[a];if(0<k.COLLISION_AREA_SPACES.length){e=k;break}}if(e!=IS_NULL)for(a=0;a<gpe.maxCameras;a++)if(k=this.currentScene.sceneCamera[a],1==k.isVisible){var h=k.cameraRect.x2Pos+this.spatialGridWidthSize;var n=k.cameraRect.y2Pos+this.spatialGridHeightSize;for(d=k.cameraRect.xPos;d<=h;d+=this.spatialGridWidthSize)for(b=
k.cameraRect.yPos;b<=n;b+=this.spatialGridHeightSize){var p=(d/this.spatialGridWidthSize|0)*this.spatialGridHeightAmount;p+=b/this.spatialGridHeightSize|0;0<=p&&p<e.COLLISION_AREA_SPACES.length&&this.collisionSpacesInView.push(p)}}}this.collisionSpacesInView=gpe.make_array_unique(this.collisionSpacesInView)};this.camera_on=function(a){return-1!=this.currentScene&&0<=a&&a<gpe.maxCameras?this.currentScene.sceneCamera[a].isVisible:IS_NULL};this.center_camera=function(a,d,b){-1!=this.currentScene&&0<=
a&&a<gpe.maxCameras&&this.currentScene.sceneCamera[a].center_camera(d,b)};this.check_collision_rect=function(a,d){var b=a.xPos,c=a.xPos+a.rectWidth,e=a.yPos,h=d.xPos,g=d.xPos+d.rectWidth,p=d.yPos+d.rectHeight;return!(a.yPos+a.rectHeight<d.yPos||e>p||c<h||b>g)};this.check_collision_with_rect=function(a,d,b,e,k){var c=new u;c.update_shape(a,d,b,e);return this.check_collision_rect(k,c)};this.disable_camera=function(a){-1!=this.currentScene&&this.currentScene.disable_camera(a)};this.delete_selected_objects=
function(){if(1==this.needToDeleteObjects){var a=IS_NULL;this.GAME_OBJECTS_TO_DELETE_TYPES=gpe.make_array_unique(this.GAME_OBJECTS_TO_DELETE_TYPES);for(var d=this.GAME_OBJECTS_TO_DELETE_TYPES.length-1;0<=d;d--){var b=this.GAME_OBJECTS_TO_DELETE_TYPES[d];var e=this.GAME_OBJECTS_TO_BE_DESTROYED[b];for(b=e.length-1;0<=b;b--){var k=e[b];var h=!1;for(iCLayers=GPR.currentScene.sceneLayers.length-1;0<=iCLayers;iCLayers--)if(a=GPR.currentScene.sceneLayers[iCLayers],a.layerId==k.sceneLayerPos){h=!0;break}if(h)for(h=
k.SPATIAL_PARTITION_LIST.length-1;0<=h;h--){var n=k.SPATIAL_PARTITION_LIST[h];n<a.COLLISION_AREA_SPACES.length&&0<=n?(n=a.COLLISION_AREA_SPACES[n],n.remove_held_object(k)):a.COLLISION_AREA_OUTSIDE_SCENE.remove_held_object(k)}}}this.GAME_OBJECTS_TO_DELETE_TYPES=[];this.GAME_OBJECTS_TO_BE_DESTROYED=[];this.needToDeleteObjects=!1}};this.enable_camera=function(a){-1!=this.currentScene&&this.currentScene.enable_camera(a)};this.find_collision_rectangle=function(a,d,b,e,k){"number"!=typeof k&&(k=a.sceneLayerPos);
if(-1!=a&&0<=k&&32>k){for(var c=IS_NULL,f=!1,g=GPR.currentScene.sceneLayers.length-1;0<=g;g--)if(c=GPR.currentScene.sceneLayers[g],c.layerId==k){f=!0;break}if(f){k=a.collisionBox.xPos;f=a.collisionBox.yPos;0<=a.spriteId&&a.spriteId<gpe.rsm.rSprites.length?(g=gpe.rsm.rSprites[a.spriteId],a.collisionBox.update_position(d+g.colX,b+g.colY)):a.collisionBox.update_position(d,b);d=[];g=c.find_spatial_at(a.collisionBox.xPos,a.collisionBox.yPos);d.push(g);g=c.find_spatial_at(a.collisionBox.x2Pos,a.collisionBox.yPos);
d.push(g);g=c.find_spatial_at(a.collisionBox.xPos,a.collisionBox.y2Pos);d.push(g);g=c.find_spatial_at(a.collisionBox.x2Pos,a.collisionBox.y2Pos);d.push(g);d=gpe.make_array_unique(d);if(0<=e&&e<GPE_MAX_OBJECT_TYPES)if(a.gpeObjectType==e)for(b=d.length-1;0<=b;b--){g=d[b];var m=0<=g||g<c.COLLISION_AREA_SPACES.length?c.COLLISION_AREA_SPACES.at(g):c.COLLISION_AREA_OUTSIDE_SCENE;-1==m&&(m=c.COLLISION_AREA_OUTSIDE_SCENE);m=m.heldObjectsArray[e];for(g=m.length-1;0<=g;g--){var l=m[g];if(-1!=l&&l.gpeUniqGameObjectId!=
a.gpeUniqGameObjectId&&gpe.check_collision_rect(a.collisionBox,l.collisionBox))return a.collisionBox.update_position(k,f),l}}else for(b=d.length-1;0<=b;b--){if(g=d[b],m=0<=g||g<c.COLLISION_AREA_SPACES.length?c.COLLISION_AREA_SPACES.at(g):c.COLLISION_AREA_OUTSIDE_SCENE,0<=e&&e<GPE_MAX_OBJECT_TYPES)for(-1==m&&(m=c.COLLISION_AREA_OUTSIDE_SCENE),m=m.heldObjectsArray[e],g=m.length-1;0<=g;g--)if(l=m[g],-1!=l&&gpe.check_collision_rect(a.collisionBox,l.collisionBox))return a.collisionBox.update_position(k,
f),l}else for(b=d.length-1;0<=b;b--)for(g=d[b],m=0<=g||g<c.COLLISION_AREA_SPACES.length?c.COLLISION_AREA_SPACES.at(g):c.COLLISION_AREA_OUTSIDE_SCENE,g=m.internalArray.length-1;0<=g;g--)if(l=m.internalArray[g],l.gpeUniqGameObjectId!=a.gpeUniqGameObjectId&&gpe.check_collision_rect(a.collisionBox,l.collisionBox))return a.collisionBox.update_position(k,f),l;a.collisionBox.update_position(k,f)}}return IS_NULL};this.touches_family=function(a,d,b,e,k){"number"!=typeof k&&(k=a.sceneLayerPos);if(-1!=a&&0<=
k&&32>k){for(var c=IS_NULL,f=!1,g=GPR.currentScene.sceneLayers.length-1;0<=g;g--)if(c=GPR.currentScene.sceneLayers[g],c.layerId==k){f=!0;break}if(f){k=this.GAME_OBJECTS_FAMILIES[e];if(0==k.length)return this.find_collision_rectangle(a,d,b,e,layerId);if(0<=e&&e<GPE_MAX_OBJECT_TYPES){e=a.collisionBox.xPos;f=a.collisionBox.yPos;0<=a.spriteId&&a.spriteId<gpe.rsm.rSprites.length?(g=gpe.rsm.rSprites[a.spriteId],a.collisionBox.update_position(d+g.colX,b+g.colY)):a.collisionBox.update_position(d,b);d=[];
g=c.find_spatial_at(a.collisionBox.xPos,a.collisionBox.yPos);d.push(g);g=c.find_spatial_at(a.collisionBox.x2Pos,a.collisionBox.yPos);d.push(g);g=c.find_spatial_at(a.collisionBox.xPos,a.collisionBox.y2Pos);d.push(g);g=c.find_spatial_at(a.collisionBox.x2Pos,a.collisionBox.y2Pos);d.push(g);d=gpe.make_array_unique(d);var m,l;for(b=d.length-1;0<=b;b--)for(g=d[b],g=0<=g||g<c.COLLISION_AREA_SPACES.length?c.COLLISION_AREA_SPACES.at(g):c.COLLISION_AREA_OUTSIDE_SCENE,-1==g&&(g=c.COLLISION_AREA_OUTSIDE_SCENE),
m=k.length-1;0<=m;m--){var q=k[m];var r=g.heldObjectsArray[q];if(a.gpeObjectType==q)for(l=r.length-1;0<=l;l--){if(q=r[l],-1!=q&&q.gpeUniqGameObjectId!=a.gpeUniqGameObjectId&&gpe.check_collision_rect(a.collisionBox,q.collisionBox))return a.collisionBox.update_position(e,f),q}else for(l=r.length-1;0<=l;l--)if(q=r[l],-1!=q&&gpe.check_collision_rect(a.collisionBox,q.collisionBox))return a.collisionBox.update_position(e,f),q}}else return this.find_collision_rectangle(a,d,b,-1,layerId)}}return IS_NULL};
this.find_collisions_of_spatialpartion=function(a){var c,b,d,e;for(c=GPE_MAX_OBJECT_TYPES-1;0<=c;c--){var h=a.heldObjectsArray[c];for(b=h.length-1;0<=b;b--){var n=h[b];for(d=n.OBJECT_COLLISION_LIST.length-1;0<=d;d--){var p=a.heldObjectsArray[n.OBJECT_COLLISION_LIST[d]];for(e=p.length-1;0<=e;e--){var m=p[e];if(n.gpeUniqGameObjectId!=m.gpeUniqGameObjectId){this.objectCollisionHashesChecked+=2;var l=n.gpeUniqGameObjectId+":"+m.gpeUniqGameObjectId;var q=m.gpeUniqGameObjectId+":"+n.gpeUniqGameObjectId;
this.objectCollisionIsChecked[l]||this.objectCollisionIsChecked[q]||(this.objectCollisionIsChecked[l]=this.objectCollisionIsChecked[q]=!0,this.spatialCollisionChecks+=1,this.check_collision_rect(n.collisionBox,m.collisionBox)&&this.add_collision_pair(n,m))}}}}}};this.find_collisions_of_two_spatialpartions=function(a,d){var b,c,e,h;for(b=a.heldObjectsArray.size()-1;0<=b;b--){var g=a.heldObjectsArray[b];for(c=g.length-1;0<=c;c--){var p=g[c];for(e=p.OBJECT_COLLISION_LIST.length-1;0<=e;e--){var m=d.heldObjectsArray[p.OBJECT_COLLISION_LIST[e]];
for(h=m.length-1;0<=h;h--){var l=m[h];if(p.gpeUniqGameObjectId!=l.gpeUniqGameObjectId){this.objectCollisionHashesChecked+=2;var q=p.gpeUniqGameObjectId+":"+l.gpeUniqGameObjectId;var r=l.gpeUniqGameObjectId+":"+p.gpeUniqGameObjectId;this.objectCollisionIsChecked[q]||this.objectCollisionIsChecked[r]||(this.objectCollisionIsChecked[q]=this.objectCollisionIsChecked[r]=!0,this.spatialCollisionChecks+=1,this.check_collision_rect(p.collisionBox,l.collisionBox)&&this.add_collision_pair(p,l))}}}}}};this.find_collisions_in_all_spatialpartions=
function(){var a;for(a=this.COLLISION_AREA_SPACES.size()-1;0<=a;a--){var d=this.COLLISION_AREA_SPACES.at(a);this.find_collisions_of_spatialpartion(d)}this.find_collisions_of_spatialpartion(this.COLLISION_AREA_OUTSIDE_SCENE)};this.find_furthest_object=function(a,d,b,e,k){"undefined"==typeof e&&(e=IS_NULL);this.find_nearest_spatial_at(d,b)>=this.COLLISION_AREA_SPACES.size()&&this.COLLISION_AREA_SPACES.size();this.COLLISION_AREA_SPACES.size();this.COLLISION_AREA_SPACES.size();var c,f=IS_NULL,g=IS_NULL,
m=this.COLLISION_AREA_SPACES.length-1;if(0<=a&&a<GPE_MAX_OBJECT_TYPES){for(;0<=m;){k=this.COLLISION_AREA_SPACES[m];if(-1!=k)for(k=k.heldObjectsArray[a],c=k.length-1;0<=c;){var l=k[c];if(-1!=l&&0==l.gpeIsBeingDestroyed&&l.gpeUniqGameObjectId!=e){var q=l.collisionBox.xCenter;var r=l.collisionBox.yMiddle;q=gpe.get_distance(d,b,q,r);q>f&&(g=l,f=q)}c--}m--}k=this.COLLISION_AREA_OUTSIDE_SCENE.heldObjectsArray[a]}else{for(;0<=m;){k=this.COLLISION_AREA_SPACES[m];if(-1!=k)for(k=k.internalArray,c=k.length-
1;0<=c;)l=k[c],-1!=l&&0==l.gpeIsBeingDestroyed&&l.gpeUniqGameObjectId!=e&&(q=l.collisionBox.xCenter,r=l.collisionBox.yMiddle,q=gpe.get_distance(d,b,q,r),q>f&&(g=l,f=q)),c--;m--}k=this.COLLISION_AREA_OUTSIDE_SCENE.internalArray}for(c=k.length-1;0<=c;)l=k[c],-1!=l&&0==l.gpeIsBeingDestroyed&&l.gpeUniqGameObjectId!=e&&(q=l.collisionBox.xCenter,r=l.collisionBox.yMiddle,q=gpe.get_distance(d,b,q,r),q>f&&(g=l,f=q)),c--;return g};this.find_last_object=function(a){return IS_NULL};this.find_nearest_object=function(a,
d,b,e,k){"undefined"==typeof e&&(e=IS_NULL);var c,f=9007199254740991,g=IS_NULL,m=this.COLLISION_AREA_SPACES.length-1;if(0<=a&&a<GPE_MAX_OBJECT_TYPES){for(;0<=m;){k=this.COLLISION_AREA_SPACES[m];if(-1!=k)for(k=k.heldObjectsArray[a],c=k.length-1;0<=c;){var l=k[c];if(-1!=l&&0==l.gpeIsBeingDestroyed&&l.gpeUniqGameObjectId!=e){var q=l.collisionBox.xCenter;var r=l.collisionBox.yMiddle;q=gpe.get_distance(d,b,q,r);q<f&&(g=l,f=q)}c--}m--}k=this.COLLISION_AREA_OUTSIDE_SCENE.heldObjectsArray[a]}else{for(;0<=
m;){k=this.COLLISION_AREA_SPACES[m];if(-1!=k)for(k=k.internalArray,c=k.length-1;0<=c;)l=k[c],-1!=l&&0==l.gpeIsBeingDestroyed&&l.gpeUniqGameObjectId!=e&&(q=l.collisionBox.xCenter,r=l.collisionBox.yMiddle,q=gpe.get_distance(d,b,q,r),q<f&&(g=l,f=q)),c--;m--}k=this.COLLISION_AREA_OUTSIDE_SCENE.internalArray}for(c=k.length-1;0<=c;)l=k[c],-1!=l&&0==l.gpeIsBeingDestroyed&&l.gpeUniqGameObjectId!=e&&(q=l.collisionBox.xCenter,r=l.collisionBox.yMiddle,q=gpe.get_distance(d,b,q,r),q<f&&(g=l,f=q)),c--;return g};
this.find_newest_object=function(a){return IS_NULL};this.find_object_collision=function(a,d,b,e){};this.find_tile=function(a,d,b){return this.currentScene.find_tile(a,d,b)};this.find_tile_in_box=function(a,d,b,e,k){return this.currentScene.find_tile_in_box(a,d,b,e,k)};this.find_matching_tile=function(a,d,b,e){return this.currentScene.find_matching_tile(a,d,b,e)};this.find_matching_tile_in_box=function(a,d,b,e,k,h){return this.currentScene.find_tile_in_box(a,d,b,e,k,h)};this.game_reset=function(){};
this.get_camera_info=function(a){"number"!=typeof a&&(a=0);return-1!=this.currentScene&&0<=a&&a<gpe.maxCameras?(a=this.currentScene.sceneCamera[a],{x:a.cameraRect.get_x(),y:a.cameraRect.get_x(),w:a.cameraRect.get_width(),h:a.cameraRect.get_height(),sx:a.renderRect.get_x(),sy:a.renderRect.get_x(),sw:a.renderRect.get_width(),sh:a.renderRect.get_height()}):IS_NULL};this.get_camera_height=function(a){"number"!=typeof a&&(a=0);return-1!=this.currentScene&&0<=a&&a<gpe.maxCameras?this.currentScene.sceneCamera[a].cameraRect.get_height():
IS_NULL};this.get_camera_width=function(a){"number"!=typeof a&&(a=0);return-1!=this.currentScene&&0<=a&&a<gpe.maxCameras?this.currentScene.sceneCamera[a].cameraRect.get_width():IS_NULL};this.get_camera_x=function(a){"number"!=typeof a&&(a=0);return-1!=this.currentScene&&0<=a&&a<gpe.maxCameras?this.currentScene.sceneCamera[a].cameraRect.get_x():IS_NULL};this.get_camera_y=function(a){"number"!=typeof a&&(a=0);return-1!=this.currentScene&&0<=a&&a<gpe.maxCameras?this.currentScene.sceneCamera[a].cameraRect.get_y():
IS_NULL};this.get_camera_mouse_x=function(a){return 0<=a&&a<gpe.maxCameras?this.MOUSE_CAM_X[a]:this.MOUSE_CAM_X[0]};this.get_camera_mouse_y=function(a){return 0<=a&&a<gpe.maxCameras?this.MOUSE_CAM_Y[a]:this.MOUSE_CAM_Y[0]};this.get_camera_screen_height=function(a){"number"!=typeof a&&(a=0);return-1!=this.currentScene&&0<=a&&a<gpe.maxCameras?this.currentScene.sceneCamera[a].renderRect.get_height():IS_NULL};this.get_camera_screen_width=function(a){"number"!=typeof a&&(a=0);return-1!=this.currentScene&&
0<=a&&a<gpe.maxCameras?this.currentScene.sceneCamera[a].renderRect.get_width():IS_NULL};this.get_camera_screen_x=function(a){"number"!=typeof a&&(a=0);return-1!=this.currentScene&&0<=a&&a<gpe.maxCameras?this.currentScene.sceneCamera[a].renderRect.get_x():IS_NULL};this.get_camera_screen_y=function(a){"number"!=typeof a&&(a=0);return-1!=this.currentScene&&0<=a&&a<gpe.maxCameras?this.currentScene.sceneCamera[a].renderRect.get_y():IS_NULL};this.get_font_family=function(a){return"undefined"!=typeof fontIdIn&&
0<textToRender.length&&0<=fontIdIn&&fontIdIn<gpe.rsm.rFonts.length&&(a=gpe.rsm.rFonts[fontIdIn],-1!=a)?a.get_family():""};this.get_font_width=function(a,d){if("undefined"!=typeof fontIdIn&&0<textToRender.length&&0<=fontIdIn&&fontIdIn<gpe.rsm.rFonts.length){var b=gpe.rsm.rFonts[fontIdIn];if(-1!=b)return b.get_text_width(d)}return 0};this.get_font_height=function(a,d){if("undefined"!=typeof fontIdIn&&0<textToRender.length&&0<=fontIdIn&&fontIdIn<gpe.rsm.rFonts.length){var b=gpe.rsm.rFonts[fontIdIn];
if(-1!=b)return b.get_text_height(d)}return 0};this.get_font_size=function(a){return"undefined"!=typeof fontIdIn&&0<textToRender.length&&0<=fontIdIn&&fontIdIn<gpe.rsm.rFonts.length&&(a=gpe.rsm.rFonts[fontIdIn],-1!=a)?a.fontSize:-1};this.font_is_monospaced=function(a){return"undefined"!=typeof fontIdIn&&0<textToRender.length&&0<=fontIdIn&&fontIdIn<gpe.rsm.rFonts.length&&(a=gpe.rsm.rFonts[fontIdIn],-1!=a)?a.isMonoSpacedFont:!1};this.get_object_count=function(a){return 0<=a&&a<this.GAME_OBJECTS.length?
this.GAME_OBJECTS[a].length:0};this.get_object_count_all=function(a){if(0<=a&&a<GPE_MAX_OBJECT_TYPES){if(0==GPE.GAME_OBJECTS_FAMILIES[a].length)return this.GAME_OBJECTS[a].length;var c=0;for(a=this.GAME_OBJECTS[a].length-1;0<=a;a--)c+=gpe.GAME_OBJECTS[gpe.GAME_OBJECTS_FAMILIES[a]].length;return c}return 0};this.get_object_in_view_count=function(a){if(0<=a&&a<GPE_MAX_OBJECT_TYPES)for(a=this.collisionSpacesInView.length-1;0<=a;a--);return 0};this.position_open=function(a,d,b,e){"number"!=typeof e&&
(e=1);if(-1!=objOne&&0<=e&&32>e){for(var c=IS_NULL,f=!1,g=GPR.currentScene.sceneLayers.length-1;0<=g;g--)if(c=GPR.currentScene.sceneLayers[g],c.layerId==e){f=!0;break}if(f)if(f=c.find_spatial_at(a,d),e=IS_NULL,e=0>f||e>=c.COLLISION_AREA_SPACES.length?c.COLLISION_AREA_OUTSIDE_SCENE:c.COLLISION_AREA_SPACES.at(f),0<b&&b<GPE_MAX_OBJECT_TYPES)for(e=e.heldObjectsArray[b],b=e.length-1;0<=b;b--){if(c=e[b],-1!=c&&gpe.point_within(a,d,c.collisionBox.xPos,c.collisionBox.yPos,c.collisionBox.x2Pos,c.collisionBox.y2Pos))return c}else for(b=
e.internalArray.length-1;0<=b;b--)if(c=e.internalArray[b],gpe.point_within(a,d,c.collisionBox.xPos,c.collisionBox.yPos,c.collisionBox.x2Pos,c.collisionBox.y2Pos))return c}return IS_NULL};this.find_nearest_spatial_at=function(a,d){0>a&&(a=0);0>d&&(d=0);a>=this.currentScene.sceneWidth&&(a=this.currentScene.sceneWidth-1);d>=this.currentScene.sceneHeight&&(d=this.currentScene.sceneHeight-1);var b=(a/this.spatialGridWidthSize|0)*this.spatialGridHeightAmount;b+=d/this.spatialGridHeightSize|0;0>b&&(b=0);
b>=this.COLLISION_AREA_SPACES.length&&(b=this.COLLISION_AREA_SPACES.length-1);return b};this.find_spatial_at=function(a,d){var b=-1;0<=a&&0<=d&&a<this.currentScene.sceneWidth&&d<this.currentScene.sceneHeight&&(b=(a/this.spatialGridWidthSize|0)*this.spatialGridHeightAmount,b+=d/this.spatialGridHeightSize|0,0>b||b>=this.COLLISION_AREA_SPACES.length)&&(b=-1);return b};this.render_state=function(){if(-1!=this.currentScene&&0==this.sceneWasReset&&this.currentScene.sceneHasBeenActivated){if(gpe.context.font=
"bold 16pt Calibri",gpe.context.textAlign="left",gpe.context.fillStyle="#FFF",gpe.GPE_Current_Context=gpe.preGuiContext,gpe.preGuiContext.clearRect(0,0,gpe.preGuiCanvas.width,gpe.preGuiCanvas.height),this.currentScene.scene_is_ready()?this.currentScene.sceneIsProcessed&&this.currentScene.sceneResourcesAreProcessed&&(this.currentScene.render_scene(gpe.GPE_Current_Context,this),gpe.context.drawImage(gpe.preGuiCanvas,0,0,gpe.preGuiCanvas.width,gpe.preGuiCanvas.height,0,0,gpe.canvas.width,gpe.canvas.height)):
(gpe.context.fillStyle="#FFF",gpe.context.fillText("Loading...",40,gpe.canvas.height-64)),gpe.GPE_Current_Context=gpe.context,GPE_SETTINGS_IS_DEBUGGING){gpe.GPE_Current_Context.font="bold 16pt Calibri";gpe.GPE_Current_Context.textAlign="left";gpe.GPE_Current_Context.textAlign="left";gpe.GPE_Current_Context.fillStyle="red";for(var a="",d=0;d<this.collisionSpacesInView.length;d++)a=a+this.collisionSpacesInView[d]+", ";gpe.GPE_Current_Context.fillText(a,32,32);for(d=0;d<gpe.maxCameras;d++)a=this.currentScene.sceneCamera[d],
a.isVisible&&gpe.GPE_Current_Context.fillText("["+d+"] ("+a.cameraRect.xPos+","+a.cameraRect.yPos+") , ("+a.cameraRect.x2Pos+","+a.cameraRect.y2Pos+").",32,64+32*d)}}else gpe.context.fillStyle=this.currentScene.bgColor,gpe.context.fillRect(0,0,gpe.canvas.width,gpe.canvas.height)};this.begin_spatialpartioning=function(a,d){this.sceneWidth=a;this.sceneHeight=d;this.spatialGridWidthAmount=Math.ceil(a/this.spatialGridWidthSize);2>this.spatialGridWidthAmount&&(this.spatialGridWidthSize=a/2,this.spatialGridWidthAmount=
2);this.spatialGridHeightAmount=Math.ceil(d/this.spatialGridHeightSize);2>this.spatialGridHeightAmount&&(this.spatialGridHeightSize=d/2,this.spatialGridHeightAmount=2);for(var b=this.currentScene.sceneLayers.length-1;0<=b;b--)this.currentScene.sceneLayers[b].begin_spatialpartioning(a,d)};this.prepare_game_frame=function(){this.parsing_objects_begun=!0;this.spatialCollisionChecks=this.objectCollisionHashesChecked=this.colisionObjectLoops=this.collisionsCheckedCount=0;this.objectCollisionIsChecked=
{};this.collisionPairA=[];this.collisionPairB=[];this.collisionPairsTotal=0;this.parsed_objects=0;for(var a,d,b=gpe.maxCameras-1,e,k=this.currentScene.sceneLayers.length-1;0<=k;k--)for(e=this.currentScene.sceneLayers[k],a=e.layerObjects.length-1;0<=a;a--){var h=e.layerObjects[a];h.collisionBeingChecked=!0;h.isOutsideScene=!1;h.gpeLogicAppliedInFrame=!1;h.gpePrelogicAppliedInFrame=!1;for(d=b;0<=d;d--)h.prerenderedInFrame[d]=!1,h.renderedInFrame[d]=!1;h.gpeAddedToRenderList=!1;h.gpeAddedToContinuousList=
!1}this.superDebugCollisions=!1;this.currentScene.sceneIsSpatiallyPartitioned=!0};this.get_scene_width=function(a){return this.currentScene.get_scene_width()};this.get_scene_height=function(a){return this.currentScene.get_scene_height()};this.get_past_scene=function(){return pastSceneId};this.get_past_scene_name=function(){return pastSceneName};this.get_scene_id=function(){return this.currentScene.sceneId};this.get_scene_name=function(){return this.currentScene.sceneName};this.process_scene_movement=
function(){var a=this.sceneToEnter;if(this.currentSceneId!=a&&0<=a&&a<gpe.gpeScenes.length){GPE_SETTINGS_IS_DEBUGGING&&console.log("Attempting to visit scene ID #"+a+".");this.pastSceneId=this.currentScene;this.pastSceneName=this.currentScene.sceneName;var d,b;0==this.currentScene.sceneIsContinuous&&this.currentScene.reset_scene_meta();this.GAME_OBJECTS_CONTINUOUS=[];this.currentScene.persistentObjects=[];for(d=this.GAME_OBJECTS.length-1;0<=d;d--){var e=this.GAME_OBJECTS[d];for(b=e.length-1;0<=b;b--){var k=
e[b];0==k.gpeIsBeingDestroyed&&(k.scene_end(),k.gpeIsContinuousObject?this.add_to_continuous_objects(k):this.currentScene.sceneIsContinuous&&this.currentScene.add_to_persistent_objects(k))}}this.delete_selected_objects();this.scene_restart_object_info();this.currentScene.sceneIsContinuous?this.currentScene.sceneWasVisitedBefore=!0:this.currentScene.reset_scene_meta();this.currentScene.clear_layers_data();-1!=this.currentScene&&(gpe.stop_audio(this.currentScene.startAudio),gpe.stop_audio(this.currentScene.bgMusic),
gpe.play_audio(this.currentScene.endAudio,!1));this.currentScene.sceneHasBeenActivated=!1;this.currentScene=gpe.gpeScenes[a];this.currentSceneId=this.sceneToEnter=a;GPE_SETTINGS_IS_DEBUGGING&&console.log(this.currentScene);this.currentScene.update_tilemap();this.currentScene.sceneHasBeenActivated=!1;gpe.loop_audio(this.currentScene.bgMusic);gpe.play_audio(this.currentScene.startAudio,!1)}else if(this.sceneWasReset){this.GAME_OBJECTS_CONTINUOUS=[];this.currentScene.persistentObjects=[];-1!=this.currentScene&&
(gpe.stop_audio(this.currentScene.startAudio),gpe.stop_audio(this.currentScene.bgMusic),gpe.play_audio(this.currentScene.endAudio,!1));this.currentScene.reset_scene_meta();this.currentScene.clear_layers_data();if(this.sceneWasHardReset)for(d=this.GAME_OBJECTS.length-1;0<=d;d--)for(e=this.GAME_OBJECTS[d],b=e.length-1;0<=b;b--)k=e[b],0==k.gpeIsBeingDestroyed&&k.scene_end();else for(d=this.GAME_OBJECTS.length-1;0<=d;d--)for(e=this.GAME_OBJECTS[d],b=e.length-1;0<=b;b--)k=e[b],0==k.gpeIsBeingDestroyed&&
(k.scene_end(),k.gpeIsContinuousObject&&k.gpeSceneStartId!=this.currentSceneId&&this.add_to_continuous_objects(k));this.delete_selected_objects();this.scene_restart_object_info();this.currentScene.reset_scene_meta();this.currentScene.sceneHasBeenActivated=!1;this.currentScene.sceneIsContinuous&&(this.currentScene.sceneWasVisitedBefore=!0);this.currentScene.update_tilemap();gpe.loop_audio(this.currentScene.bgMusic);gpe.play_audio(this.currentScene.startAudio,!1);this.sceneWasHardReset=this.sceneWasReset=
!1}};this.scene_restart_object_info=function(){this.GAME_OBJECTS_TO_BE_DESTROYED=[];this.collisionSpacesInView=[];this.spatialGridIsCreated=!1;this.spatialMapHeightSize=this.spatialMapWidthSize=0;this.objectCollisionIsChecked={};this.GAME_OBJECTS=[];this.COLLISION_CHECK_ARRAY=new gpe.SuperVector;for(var a,d=0;d<GPE_MAX_OBJECT_TYPES;d+=1){a=new gpe.SuperVector;for(var b=0;b<GPE_MAX_OBJECT_TYPES;b+=1)a.push_back(!1);this.COLLISION_CHECK_ARRAY.push_back(a);this.GAME_OBJECTS.push_back([])}this.COLLISION_AREA_SPACES=
[];this.COLLISION_AREA_OUTSIDE_SCENE=new gpe.SuperSpatialPartition;this.superDebugCollisions=!1;this.collisionPairA=[];this.collisionPairB=[];this.parsed_objects=this.collisionPairsTotal=0;this.set_default_grid_size();this.spaitalGridHeightAmount=this.spatialGridWidthAmount=2;this.spatialCollisionChecks=this.objectCollisionHashesChecked=0;this.spatialGridIsCreated=!1;this.spatialMapHeightSize=this.spatialMapWidthSize=-1};this.scene_enter=function(a){return this.sceneToEnter==this.currentSceneId&&
0<=a&&a<gpe.gpeScenes.length?(this.sceneToEnter=a,!0):!1};this.scene_enter_previous=function(){if(this.sceneToEnter==this.currentSceneId&&0<this.currentSceneId)return this.sceneToEnter=this.currentSceneId-1,!0};this.scene_enter_next=function(){return this.sceneToEnter==this.currentSceneId&&this.currentSceneId<gpe.gpeScenes.length-1?(this.sceneToEnter=this.currentSceneId+1,!0):!1};this.scene_reset=function(a){0==this.sceneWasReset&&(this.sceneWasHardReset=a?!0:!1,this.sceneWasReset=!0)};this.setup_camera=
function(a,d,b,e,k){-1!=this.currentScene&&0<=a&&a<gpe.maxCameras&&this.currentScene.sceneCamera[a].setup_camera(d,b,e,k)};this.split_screen=function(a,d,b){if(1<=a&&8>=a){console.log("Setting up "+a+" cameras...");var c;for(c=0;c<a;c++)this.enable_camera(c);for(c=a;c<gpe.maxCameras;c++)this.disable_camera(c);"boolean"==typeof d&&(d=!1);"boolean"==typeof b&&(b=!1);1==a?this.setup_camera(0,0,0,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT):2==a?d?(this.setup_camera(0,0,0,GPE_SETTINGS_SCREEN_WIDTH/
2,GPE_SETTINGS_SCREEN_HEIGHT),this.setup_camera(1,GPE_SETTINGS_SCREEN_WIDTH/2,0,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT)):(this.setup_camera(0,0,0,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(1,0,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT/2)):3==a?d?(this.setup_camera(0,0,0,GPE_SETTINGS_SCREEN_WIDTH/3,GPE_SETTINGS_SCREEN_HEIGHT),this.setup_camera(1,GPE_SETTINGS_SCREEN_WIDTH/3,0,GPE_SETTINGS_SCREEN_WIDTH/3,GPE_SETTINGS_SCREEN_HEIGHT),
this.setup_camera(2,2*GPE_SETTINGS_SCREEN_WIDTH/3,0,GPE_SETTINGS_SCREEN_WIDTH/3,GPE_SETTINGS_SCREEN_HEIGHT)):b?(this.setup_camera(0,0,0,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(1,GPE_SETTINGS_SCREEN_WIDTH/2,0,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(2,0,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2)):(this.setup_camera(0,0,0,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(1,
0,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(2,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT/2)):4==a?(this.setup_camera(0,0,0,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(1,GPE_SETTINGS_SCREEN_WIDTH/2,0,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(2,0,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/
2),this.setup_camera(3,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT/2)):5!=a&&(6==a?(this.setup_camera(0,0,0,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(1,GPE_SETTINGS_SCREEN_WIDTH/2,0,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(2,GPE_SETTINGS_SCREEN_WIDTH/2,0,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(3,0,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH/
2,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(4,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT/2),this.setup_camera(5,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT/2)):7!=a&&8==a&&(this.setup_camera(0,0,0,GPE_SETTINGS_SCREEN_WIDTH/4,GPE_SETTINGS_SCREEN_HEIGHT/4),this.setup_camera(1,GPE_SETTINGS_SCREEN_WIDTH/2,0,GPE_SETTINGS_SCREEN_WIDTH/4,GPE_SETTINGS_SCREEN_HEIGHT/4),
this.setup_camera(2,GPE_SETTINGS_SCREEN_WIDTH/2,0,GPE_SETTINGS_SCREEN_WIDTH/4,GPE_SETTINGS_SCREEN_HEIGHT/4),this.setup_camera(3,GPE_SETTINGS_SCREEN_WIDTH/2,0,GPE_SETTINGS_SCREEN_WIDTH/4,GPE_SETTINGS_SCREEN_HEIGHT/4),this.setup_camera(4,0,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH/4,GPE_SETTINGS_SCREEN_HEIGHT/4),this.setup_camera(5,0,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH/4,GPE_SETTINGS_SCREEN_HEIGHT/4),this.setup_camera(6,0,GPE_SETTINGS_SCREEN_HEIGHT/2,GPE_SETTINGS_SCREEN_WIDTH/
4,GPE_SETTINGS_SCREEN_HEIGHT/4),this.setup_camera(7,GPE_SETTINGS_SCREEN_WIDTH/2,GPE_SETTINGS_SCREEN_HEIGHT/4,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT/4)));return!0}gpe.enable_camera(0);gpe.setup_camera(0,0,0,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT);return 0};this.update_object_in_map=function(a){if(-1!=typeof a){for(var c=IS_NULL,b=!1,d=a.sceneLayerPos,e=GPR.currentScene.sceneLayers.length-1;0<=e;e--)if(c=GPR.currentScene.sceneLayers[e],c.layerId==d){b=!0;break}if(b){b=[-1,
-1,-1,-1];b[0]=-1;b[1]=-1;b[2]=-1;b[3]=-1;d=a.collisionBox.xPos;e=a.collisionBox.yPos;var h=a.collisionBox.x2Pos;var n=a.collisionBox.y2Pos;0>d||0>e||d>this.sceneWidth||e>this.sceneHeight?b[0]=-1:(b[0]=(d/c.spatialGridWidthSize|0)*c.spatialGridHeightAmount,b[0]+=e/c.spatialGridHeightSize|0);0>h||0>e||h>this.sceneWidth||e>this.sceneHeight?b[1]=-1:(b[1]=(h/c.spatialGridWidthSize|0)*c.spatialGridHeightAmount,b[1]+=e/c.spatialGridHeightSize|0);0>d||0>n||d>this.sceneWidth||n>this.sceneHeight?b[2]=-1:(b[2]=
(d/c.spatialGridWidthSize|0)*c.spatialGridHeightAmount,b[2]+=n/c.spatialGridHeightSize|0);0>h||0>n||h>this.sceneWidth||n>this.sceneHeight?b[3]=-1:(b[3]=(h/c.spatialGridWidthSize|0)*c.spatialGridHeightAmount,b[3]+=n/c.spatialGridHeightSize|0);b=gpe.make_array_unique(b);if(1==a.GPE_AddedToGridSystem){for(d=a.SPATIAL_PARTITION_LIST.length-1;0<=d;d--){h=a.SPATIAL_PARTITION_LIST[d];n=!1;for(e=b.length-1;0<=e;e--)if(h==b[e]){n=!0;break}n||(0>h||h>=c.COLLISION_AREA_SPACES.length?c.COLLISION_AREA_OUTSIDE_SCENE.remove_held_object(a):
(e=c.COLLISION_AREA_SPACES[h],e.remove_held_object(a)))}for(d=b.length-1;0<=d;d--){h=b[d];n=!1;for(e=a.SPATIAL_PARTITION_LIST.length-1;0<=e;e--)if(h==a.SPATIAL_PARTITION_LIST[e]){n=!0;break}n||(0>h||h>=c.COLLISION_AREA_SPACES.size()?0==a.isOutsideScene&&(c.COLLISION_AREA_OUTSIDE_SCENE.add_object(a),a.isOutsideScene=!0):(e=c.COLLISION_AREA_SPACES.at(h),e.add_object(a)))}}else for(d=b.length-1;0<=d;d--)h=b[d],0>h||h>=c.COLLISION_AREA_SPACES.size()?0==a.isOutsideScene&&(c.COLLISION_AREA_OUTSIDE_SCENE.add_object(a),
a.isOutsideScene=!0):(e=c.COLLISION_AREA_SPACES.at(h),e.add_object(a));a.SPATIAL_PARTITION_LIST=b}else console.log("Unable to find matching layer in map for ["+d+"] layer...")}};this.replace_background=function(a,d,b){this.currentScene.replace_background(a,d,b)};this.replace_all_backgrounds=function(a,d){this.currentScene.replace_all_backgrounds(a,d)};this.set_background=function(a,d,b){this.currentScene.replace_background(a,d,b)};this.GAME_OBJECTS[0]=[];this.COLLISION_CHECK_ARRAY=new gpe.SuperVector;
for(var a=0;a<this.GAME_OBJECTS.length;a+=1){e=new gpe.SuperVector;for(var d=0;d<this.GAME_OBJECTS;d+=1)e.push_back([]);this.COLLISION_CHECK_ARRAY.push_back(e)}}function K(){this.html5AudioSource=new Audio;this.audioIsLoaded=!1;this.audioId=this.audioCouldBePlayed=-1;this.audioFileName=[];this.actualAudioFileName="";this.audioName="unnamed";this.audioGroupName="";this.audioLoopsAround=!1;this.defaultVolume=100;this.isBeingLooped=this.audioLoadedInMemory=this.audioWasPaused=this.audioWasStopped=!1;
for(var e=0;e<GPE_SUPPORTED_AUDIO_FORMAT_COUNT;e++)this.audioFileName[e]="";this.check_audio_state=function(){for(var a=0;a<GPE_SUPPORTED_AUDIO_FORMAT_COUNT;a++);0==this.audioShouldLoad&&(this.audioIsLoaded=!0);1!=this.audioIsLoaded&&2<=this.html5AudioSource.readyState?this.audioLoadedInMemory=this.audioIsLoaded=!0:this.html5AudioSource.error&&(this.audioIsLoaded=!0,this.audioLoadedInMemory=!1,console.log("Error loading "+this.audioName+"."));return this.audioIsLoaded};this.check_is_playing=function(){return-1!=
this.html5AudioSource?!this.html5AudioSource.paused:!1};this.load_audio=function(){-1==this.html5AudioSource&&(this.html5AudioSource=new Audio,this.html5AudioSource.volume=this.defaultVolume);if(0==this.audioIsLoaded){this.actualAudioFileName="";var a=!1;this.audioCouldBePlayed=-1;for(var d=0;d<GPE_SUPPORTED_AUDIO_FORMAT_COUNT;d++)GPE_AUDIO_PLAYABLE[d]>this.audioCouldBePlayed&&3<this.audioFileName[d].length&&(this.actualAudioFileName=this.audioFileName[d],this.audioCouldBePlayed=GPE_AUDIO_PLAYABLE[d],
a=!0);0==a&&(this.audioIsLoaded=!0);3<this.actualAudioFileName.length&&(this.html5AudioSource.addEventListener("canplaythrough",function(){this.audioLoadedInMemory=this.audioIsLoaded=!0}),this.html5AudioSource.src=this.actualAudioFileName)}};this.pause_audio=function(){gpe.lastLoopedTrack==this.audioId&&(gpe.lastLoopedTrack=-1);this.isBeingLooped=!1;-1!=this.html5AudioSource&&1==this.audioLoadedInMemory&&(this.html5AudioSource.oncanplaythrough=function(){},this.html5AudioSource.pause(),this.audioWasPaused=
!0,this.audioWasStopped=!1)};this.play_audio=function(a){"undefined"==typeof a&&(a=!1);-1!=this.html5AudioSource&&(1==this.audioIsLoaded&&1==this.audioLoadedInMemory?(this.html5AudioSource.paused?this.html5AudioSource.ended&&(this.html5AudioSource.currentTime=0):this.html5AudioSource.currentTime=.5,this.html5AudioSource.play()):2<=this.html5AudioSource.readyState?(this.audioIsLoaded=!0,this.html5AudioSource.play()):this.html5AudioSource.oncanplaythrough=function(){this.play(a)},this.audioWasStopped=
this.audioWasPaused=!1,a?(GPE_SETTINGS_IS_DEBUGGING&&console.log("Playing Audio"+this.audioId+" that loops"),gpe.lastLoopedTrack=this.audioId,this.isBeingLooped=!0):(GPE_SETTINGS_IS_DEBUGGING&&console.log("Playing Audio"+this.audioId+" that doesnt loop"),this.isBeingLooped=!1))};this.stop_audio=function(){gpe.lastLoopedTrack==this.audioId&&(gpe.lastLoopedTrack=-1);this.isBeingLooped=!1;GPE_SETTINGS_IS_DEBUGGING&&console.log("Stopping audio track: ["+this.audioId+"].");-1!=this.html5AudioSource&&(this.html5AudioSource.oncanplaythrough=
function(){},this.html5AudioSource.currentTime=0,this.html5AudioSource.pause(),this.audioWasPaused=!1,this.audioWasStopped=!0)}}function L(){this.fontId=-1;this.fontFileName=[];this.fontFamilyName="";this.fontName="unnamed";this.fontCanvasInfo="";this.fontSize=12;this.isMonoSpacedFont=!1;for(var e=0;e<GPE_SUPPORTED_FONT_FORMAT_COUNT;e++)this.fontFileName[e]="";this.load_font=function(){var a=!1;this.fontCanvasInfo=""+this.fontSize+"pt ";if(0<this.fontFamilyName.length)this.fontCanvasInfo+=this.fontFamilyName;
else{for(var d=0;d<GPE_SUPPORTED_FONT_FORMAT_COUNT;d++)if(this.fontFileName[d],0<this.fontFileName[d].length&&0==a){this.fontCanvasInfo+=this.fontFileName[d];a=!0;break}0==a&&(this.fontCanvasInfo+="Arial")}};this.get_text_width=function(a){if(0<a.length){if(isMonoSpacedFont)return a.length*fontWidth}else return gpe.GPE_Current_Context.font=fFont.fontCanvasInfo,gpe.GPE_Current_Context.fillStyle=fontRenderColor,gpe.GPE_Current_Context.textBaseline="top",gpe.GPE_Current_Context.textAlign="left",metrics=
gpe.GPE_Current_Context.measureText(a),metrics.width};this.get_text_height=function(a){if(0<a.length){if(isMonoSpacedFont)return a.length*fontHeight}else return gpe.GPE_Current_Context.font=fFont.fontCanvasInfo,gpe.GPE_Current_Context.fillStyle=fontRenderColor,gpe.GPE_Current_Context.textBaseline="top",gpe.GPE_Current_Context.textAlign="left",metrics=gpe.GPE_Current_Context.measureText("M"),metrics.width*a.length};this.get_family=function(){return this.fontFamilyName};this.get_name=function(){return this.fontName};
this.get_size=function(a){return this.fontSize};this.is_mono_spaced=function(){return this.isMonoSpacedFont}}function M(){this.html5VideoSource=document.createElement("video");this.html5VideoSource.controls=!1;document.body.appendChild(this.html5VideoSource);this.videoIsLoaded=!1;this.videoId=this.videoCouldBePlayed=-1;this.videoFileName=[];this.actualVideoFileName="";this.videoName="unnamed";this.videoGroupName="";this.videoLoopsAround=!1;this.previousVolume=this.defaultVolume=100;this.videoLoadedInMemory=
this.videoWasPaused=this.videoWasStopped=!1;for(var e=0;e<GPE_SUPPORTED_VIDEO_FORMAT_COUNT;e++)this.videoFileName[e]="";this.check_video_state=function(){for(var a=!1,d=0;d<GPE_SUPPORTED_VIDEO_FORMAT_COUNT;d++)0<=GPE_AUDIO_PLAYABLE[d]&&3<this.videoFileName[d].length&&(a=!0);0==a&&(this.videoIsLoaded=!0);1!=this.videoIsLoaded&&2<=this.html5VideoSource.readyState&&(this.videoLoadedInMemory=this.videoIsLoaded=!0);return this.videoIsLoaded};this.check_is_playing=function(){return-1!=this.html5VideoSource?
!this.html5VideoSource.paused:!1};this.load_video=function(){-1==this.html5VideoSource&&(this.html5VideoSource=new Video,this.html5VideoSource.volume=this.defaultVolume);if(0==this.videoIsLoaded){this.actualVideoFileName="";var a=!1;this.videoCouldBePlayed=-1;for(var d=0;d<GPE_SUPPORTED_VIDEO_FORMAT_COUNT;d++)GPE_VIDEO_PLAYABLE[d]>this.videoCouldBePlayed&&3<this.videoFileName[d].length&&(this.actualVideoFileName=this.videoFileName[d],this.videoCouldBePlayed=GPE_VIDEO_PLAYABLE[d],addSourceToVideo(this.html5VideoSource,
this.videoFileName[d],GPE_AUD_TYPE_NAME[d]),a=!0);0==a&&(this.videoIsLoaded=!0);3<this.actualVideoFileName.length&&(this.html5VideoSource.addEventListener("canplaythrough",function(){this.videoLoadedInMemory=this.videoIsLoaded=!0}),this.html5VideoSource.src=this.actualVideoFileName)}};this.pause_video=function(){-1!=this.html5VideoSource&&1==this.videoLoadedInMemory&&(this.html5VideoSource.pause(),this.videoWasPaused=!0,this.videoWasStopped=!1);gpe.lastLoopedVideo==this.videoId&&(gpe.lastLoopedVideo=
-1)};this.play_video=function(a,d){this.load_video();"undefined"==typeof a&&(a=!1);"undefined"==typeof videoPlayingIsSkippable&&(d=!0);-1!=this.html5VideoSource&&(gpe.currentVideoPlaying=this.videoId,gpe.isPlayingVideo=!0,gpe.videoPlayingIsSkippable=d,1==this.videoIsLoaded&&1==this.videoLoadedInMemory?(this.html5VideoSource.paused?this.html5VideoSource.ended&&(this.html5VideoSource.currentTime=0):this.html5VideoSource.currentTime=.5,this.html5VideoSource.play()):2<=this.html5VideoSource.readyState?
(this.videoIsLoaded=!0,this.html5VideoSource.play()):this.html5VideoSource.oncanplay=function(){this.play()},this.videoWasStopped=this.videoWasPaused=!1,a?(GPE_SETTINGS_IS_DEBUGGING&&console.log("Playing Video["+this.videoId+"[ that loops"),gpe.lastLoopedVideo=this.videoId,this.html5VideoSource.addEventListener("ended",gpe.loop_last_video,!1)):(GPE_SETTINGS_IS_DEBUGGING&&console.log("Playing Video["+this.videoId+"] that doesnt loop"),this.html5VideoSource.addEventListener("ended",gpe.stop_last_video,
!1)))};this.process_playing_video=function(){if(-1!=this.html5VideoSource)if(this.videoWasStopped)gpe.exit_video_view_mode(),this.stop_video();else{if(this.html5VideoSource.ended||this.html5VideoSource.error)gpe.exit_video_view_mode(),this.stop_video()}else gpe.exit_video_view_mode()};this.render_video=function(a,d,c,e){-1!=this.html5VideoSource&&gpe.context.drawImage(this.html5VideoSource,0,0,this.html5VideoSource.videoWidth,this.html5VideoSource.videoHeight,a,d,c,e)};this.stop_video=function(){-1!=
this.html5VideoSource&&(this.html5VideoSource.currentTime=0,this.html5VideoSource.pause(),this.videoWasPaused=!1,this.videoWasStopped=!0);gpe.lastLoopedVideo==this.videoId&&(gpe.lastLoopedVideo=-1)}}function N(){this.randomVariableOn=IS_NULL;this.rAllImages=[];this.rTextures=[];this.rTilesheets=[];this.rAudio=[];this.rSprites=[];this.rBackgrounds=[];this.rFonts=[];this.rVideos=[];this.nameBackgrounds=[];this.SPRITE_COUNT=0;this.RESOURCES_ADDED=!1;this.spritesLoadedCount=this.texturesLoadedCount=0;
this.spritePercentage=50;this.percentLoaded=9;this.latestLoadMessage="";this.audioLoadedCount=0;this.audioIsReadyForLoading=!1;this.audioIsAllLoaded=this.texturesIsAlLoaded=this.spritesIsAllLoaded=0;this.check_resources_state=function(){if(-1!=this.RESOURCES_ADDED){var e;if(this.texturesLoadedCount!=this.rTextures.length)for(e=this.texturesLoadedCount=0;e<this.rTextures.length;e++){var a=this.rTextures[e];-1!=a&&"undefined"!=typeof a?a.check_texture_state()&&this.texturesLoadedCount++:this.texturesLoadedCount++}if(this.spritesLoadedCount!=
this.SPRITE_COUNT)for(e=this.spritesLoadedCount=0;e<z;e++)a=this.rSprites[e],-1!=a&&"undefined"!=typeof a&&-1!=a.imageObj&&"undefined"!=typeof a.imageObj&&(x(a.imageObj)?(a.imageObj.alt="true",this.spritesLoadedCount++,this.percentLoaded+=1/this.SPRITE_COUNT*this.spritePercentage):"failed"==a.imageObj.alt&&(a.imageObj.alt="failed",this.spritesLoadedCount++,this.percentLoaded+=1/this.SPRITE_COUNT*this.spritePercentage,console.log("Error loading sprite")));if(1==this.audioIsReadyForLoading&&this.audioLoadedCount!=
this.rAudio.length&&(this.audioLoadedCount=0,this.audioIsReadyForLoading))for(e=0;e<this.rAudio.length;e++)1==this.rAudio[e].check_audio_state()&&this.audioLoadedCount++;this.spritesLoadedCount==this.SPRITE_COUNT&&(this.spritesIsAllLoaded=1);this.texturesLoadedCount==this.rTextures.length&&(this.texturesIsAlLoaded=1);1==this.audioIsReadyForLoading&&this.audioLoadedCount==this.rAudio.length&&(this.audioIsAllLoaded=1);1==this.spritesIsAllLoaded&&1==this.texturesIsAlLoaded&&1==this.audioIsAllLoaded&&
(this.RESOURCES_ADDED=!0)}};this.sprite_add=function(e,a,d,c,g){};this.sprite_add_collision=function(e,a,d,c,g,b,f,k,h){};this.add_audio=function(e,a,d,c,g,b,f,k,h){var n=new K;n.id=e;n.audioId=e;0<a.length&&(n.audioName=a);n.audioFileName[GPE_AAC]=d;n.audioFileName[GPE_MP3]=c;n.audioFileName[GPE_OGG]=g;n.audioFileName[GPE_WAV]=b;n.audioType=f;n.audioGroupName=k;n.defaultVolume=h;n.load_audio();this.rAudio.push(n);return this.rAudio.length-1};this.add_font=function(e,a,d,c,g,b,f,k,h,n,p){var m=new L;
m.id=e;0<a.length&&(m.fontFamilyName=a);m.fontFileName[GPE_EOT]=d;m.fontFileName[GPE_SVG]=c;m.fontFileName[GPE_TTF]=g;m.fontFileName[GPE_WOFF]=b;m.fontFileName[GPE_WOFF2]=f;m.fontSize=k;m.estimatedWidth=h;m.estimatedHeight=n;m.isMonoSpacedFont=p;m.load_font();this.rFonts.push(m);return this.rFonts.length-1};this.add_sprite_empty=function(){this.rSprites.push(IS_NULL);this.SPRITE_COUNT+=1;return this.rSprites.length-1};this.add_sprite=function(e,a,d,c,g,b,f,k,h,n,p,m){var l=this.get_sprite(d);return l==
IS_NULL?(l=new O,l.maxSpriteFrames=a,l.spriteName=d,l.spriteWidth=b,l.spriteHeight=f,l.id=e,l.setId=e,4<d.length&&(e=this.load_new_image(d),l.update_sprite_data(e,c,g,b,f)),l.colX=h,l.colY=n,l.colShape=k,1==k?(l.colRadius=p,l.colWidth=p,l.colHeight=p):(l.colWidth=p,l.colHeight=m),this.rSprites.push(l),this.SPRITE_COUNT+=1,this.rSprites.length-1):l};this.add_spritesheet=function(e,a,d,c,g,b,f,k,h,n,p,m){return this.add_sprite(e,a,d,c,g,b,f,k,h,n,p,m)};this.add_video=function(e,a,d,c,g,b,f){var k=new M;
k.id=e;k.videoId=e;0<a.length&&(k.audioName=a);k.videoFileName[GPE_WEBM]=c;k.videoFileName[GPE_MP4]=d;k.videoFileName[GPE_VIDEO_OGG]=g;k.videoGroupName=b;k.defaultVolume=f;this.rVideos.push(k);return this.rVideos.length-1};this.edit_collision_box=function(e,a,d,c,g){};this.load_new_image=function(e){var a=this.get_game_image(e);-1==a&&(a=new Image,a.src=e,this.rAllImages.push(a));return a};this.load_new_texture=function(e,a){var d=this.get_texture(e);d==IS_NULL&&(d=new G,d.texId=a,d.imageSource=new Image,
d.imageSource.src=e,d.fileLocation=e,d.texId=a,0==this.rTextures.length?this.rTextures[0]=d:this.rTextures.push_back(d),this.texturesLoadedCount=0);return d};this.add_texture=function(e,a){var d=this.get_texture(a);return d==IS_NULL?(d=new G,d.imageSource=this.load_new_image(a),d.check_texture_state(),d.texId=e,d.fileLocation=a,this.rTextures.push(d),this.rTextures.length-1):d};this.add_tilesheet=function(e,a,d,c,g,b,f,k){var h=new P;h.id=e;h.tex=this.load_new_image(a);h.fileLocation=a;h.tWidth=d;
h.tHeight=c;h.hOff=g;h.vOff=b;h.hSep=f;h.vSep=k;h.update_tex_specs();this.rTilesheets.push(h);return this.rTilesheets.length-1};this.get_game_image=function(e){var a;if("number"==typeof e){if(0<=e&&e<this.rAllImages.length)return this.rAllImages[e];for(a=0;a<this.rAllImages.length;a++){var d=this.rAllImages[a];if(d.texId==e)return d}}else if("string"==typeof e)for(a=0;a<this.rAllImages.length;a++)if(d=this.rAllImages[a],d.id==e)return d;console.log("Unable to find: ["+e+"].");return IS_NULL};this.get_audio=
function(e){var a;if("number"==typeof idIn){if(0<=idIn&&idIn<this.rAudio.length)return idIn;for(a=this.rAudio.length-1;0<=a;a--)if(e=this.rAudio[a],e.audioId==idIn)return a}else if("string"==typeof idIn)for(a=this.rAudio.length-1;0<=a;a--)if(e=this.rAudio[a],e.audioName==idIn)return a;return IS_NULL};this.get_texture=function(e){var a;if("number"==typeof e){if(0<=e&&e<this.rTextures.length)return e;for(a=this.rTextures.length-1;0<=a;a--){var d=this.rTextures[a];if(d.texId==e)return a}}else if("string"==
typeof e)for(a=this.rTextures.length-1;0<=a;a--)if(d=this.rTextures[a],d.fileLocation==e||d.name==e)return a;return IS_NULL};this.get_tilesheet=function(e){var a;if("number"==typeof e){if(0<=e&&e<this.rTilesheets.length)return e;for(a=this.rTilesheets.length-1;0<=a;a--){var d=this.rTilesheets[a];if(d.texId==e)return a}}else if("string"==typeof e)for(a=this.rTilesheets.length-1;0<=a;a--)if(d=this.rTilesheets[a],d.fileLocation==e||d.name==e)return a;return IS_NULL};this.get_sprite=function(e){var a;
if("number"==typeof e){if(0<=e&&e<this.rSprites.length)return e;for(a=this.rSprites.length-1;0<=a;a--){var d=this.rSprites[a];if(d.texId==e)return a}}else if("string"==typeof e)for(a=this.rSprites.length-1;0<=a;a--)if(d=this.rSprites[a],d.fileLocation==e||d.name==e)return a;return IS_NULL};this.load_files=function(){};this.clean_up=function(){}}function Q(){this.stateName="ResourceLoader";this.imagesLoaded=0;this.spritesLoaded=this.audioLoaded=!1;this.percentLoaded=0;this.latestLoadMessage="";this.imagePercentage=
100;this.postLoadPauseTick=this.spritesPercentage=this.musicPercentage=0;this.postLoadPauseMax=5;this.loadingBegan=!1;this.imageStartLoadPos=0;this.gpeAppOpend=!1;this.apply_logic=function(){if(gpe.preload_completed())this.postLoadPauseTick+=1,this.postLoadPauseTick>=this.postLoadPauseMax&&(0==this.gpeAppOpend?(gpe.fileReader.open_file("js/gpe_app.js"),this.gpeAppOpend=!0):1==gpe.rsm.audioIsReadyForLoading&&w(t.STATE_MAINGAME));else{if(0==this.loadingBegan){z=GPE_PreloadImageResource.length;this.postLoadPauseTick+=
1;if(this.postLoadPauseTick>=this.postLoadPauseMax){this.postLoadPauseTick=0;var e=IS_NULL;0<=this.imageStartLoadPos&&this.imageStartLoadPos<z&&(e=new Image,e.onerror=function(){this.alt="failed";console.log("Failed to load image["+this.src+"]...")},e.src=GPE_PreloadImageResource[this.imageStartLoadPos],e.id=GPE_PreloadImageResource[this.imageStartLoadPos],e.alt="false",preloadedImages.push(e));this.imageStartLoadPos++}this.imageStartLoadPos>=z&&(this.loadingBegan=!0)}for(v=0;v<preloadedImages.length;v++)"false"==
preloadedImages[v].alt?x(preloadedImages[v])&&(preloadedImages[v].alt="true",this.imagesLoaded++,this.percentLoaded+=1/z*this.imagePercentage,gpe.rsm.rAllImages.push(preloadedImages[v])):"failed"==preloadedImages[v].alt&&(console.log("Failed to load ["+GPE_PreloadImageResource[v]+"] image."),preloadedImages[v].alt="failed",this.imagesLoaded++,this.percentLoaded+=1/z*this.imagePercentage,gpe.rsm.rAllImages.push(preloadedImages[v]));this.imagesLoaded==z&&(gpe.PRELOAD_COMPLETE=1)}};this.render_state=
function(){gpe.context.fillStyle="#333";gpe.context.fillRect(0,0,gpe.canvas.width,gpe.canvas.height);gpe.preload_completed()?(gpe.context.font="bold 24pt Calibri",gpe.context.textAlign="center",gpe.context.textBaseline="middle",gpe.context.fillStyle="#FFF",gpe.context.fillText("Starting Game...",gpe.canvas.width/2,gpe.canvas.height/2)):(gpe.context.font="bold 12pt Calibri",gpe.context.textAlign="center",gpe.context.textBaseline="top",gpe.context.fillStyle="#FFF",gpe.context.fillText("Now loading...["+
(this.percentLoaded|0)+"%]",gpe.canvas.width/2,gpe.canvas.height/2+32),0<z?(gpe.render_rectangle(0,gpe.canvas.height/2-32,this.percentLoaded/100*gpe.canvas.width,gpe.canvas.height/2,"blue",!1,4,!0),gpe.render_rectangle(0,gpe.canvas.height/2-32,this.percentLoaded/100*gpe.canvas.width,gpe.canvas.height/2,"white",!0,4,!0)):(gpe.context.font="bold 24pt Calibri",gpe.context.textAlign="center",gpe.context.textBaseline="middle",gpe.context.fillText("Loading...",gpe.canvas.width/2,gpe.canvas.height/2)))}}
function R(){this.optionName="";this.isUnlocked=!1}function S(){this.stateName="MainMenu";this.menuFont="bold 32pt Calibri";this.menuFooterFont="bold 18pt Calibri";this.naviSound=new Audio;this.naviSelectSound=new Audio;this.menuIcon;this.menuBackground=preloadedImages[2];this.menuSelectPos=2;this.menuFontColor="#FFF";this.menuHighLightFontColor="blue";this.menuLockedColor="rgb(128, 128, 128)";this.menuLockedHighLightColor="maroon";this.menuChoices=[];this.add_menu_option=function(e,a){var d=new R;
d.optionName=e;d.isUnlocked=a;this.menuChoices.push(d)};this.apply_logic=function(){var e=gpe.inputController.get_controller(1);-1!=e&&(e.check_button_released(gpe.cbi.UP_BUT)&&--this.menuSelectPos,e.check_button_released(gpe.cbi.DOWN_BUT)&&(this.menuSelectPos+=1));gpe.inputController.keyIsReleased[gp_w]&&--this.menuSelectPos;gpe.inputController.keyIsReleased[gp_s]&&(this.menuSelectPos+=1);gpe.inputController.keyIsReleased[gp_enter]&&w(t.STATE_MAINGAME);0>this.menuSelectPos&&(this.menuSelectPos=0);
this.menuSelectPos>=this.menuChoices.length&&(this.menuSelectPos=this.menuChoices.length-1)};this.render_state=function(){gpe.context.fillStyle="#333";gpe.context.fillRect(0,0,gpe.canvas.width,gpe.canvas.height);gpe.preload_completed()&&gpe.context.drawImage(this.menuBackground,0,0,gpe.canvas.width,gpe.canvas.height);gpe.context.font=this.menuFont;gpe.context.textAlign="center";for(var e,a=this.menuChoices.length-1;0<=a;a--)e=this.menuChoices[a],gpe.context.fillStyle=e.isUnlocked?this.menuSelectPos==
a?this.menuHighLightFontColor:this.menuFontColor:this.menuSelectPos==a?this.menuLockedHighLightColor:this.menuLockedColor,gpe.context.fillText(e.optionName,gpe.SCREEN_WIDTH/2,gpe.SCREEN_HEIGHT-64+64*(a-this.menuChoices.length));gpe.context.font=this.menuFooterFont;gpe.context.textAlign="right";gpe.context.fillStyle="#FFF";gpe.context.fillText("Version "+gpe.GPE_APP_VERSION_NUMBER.toFixed(1),gpe.SCREEN_WIDTH-32,gpe.SCREEN_HEIGHT-32);gpe.context.textAlign="center";gpe.context.fillText("Published By "+
gpe.GPE_APP_PUBLISHER,gpe.SCREEN_WIDTH/2,gpe.SCREEN_HEIGHT-48);gpe.context.fillText("Developed By "+gpe.GPE_APP_DEVELOPER,gpe.SCREEN_WIDTH/2,gpe.SCREEN_HEIGHT-16)};this.add_menu_option("Continue",0);this.add_menu_option("New Game",1);this.add_menu_option("Options",1);this.add_menu_option("Multiplayer",1);this.add_menu_option("Extras",0)}function T(e,a,d,c,g){this.OUT_OF_SIGHT_OUT_OF_PROCESSING=!0;this.GPE_APP_VERSION_NUMBER=this.GPE_VERSION_NUMBER=1;this.GPE_APP_DEVELOPER=GPE_GAME_DEVELOPER;this.GPE_APP_PUBLISHER=
GPE_GAME_PUBLISHER;this.SCREEN_WIDTH=e;this.SCREEN_HEIGHT=a;this.SCREEN2_WIDTH=d;this.SCREEN2_HEIGHT=c;this.originalScreenWidth=e;this.originalScreenHeight=a;this.screenScale=1;this.isInFullScreenMode=!1;this.fullScreenScale="aspect";this.fps=30;this.maxCameras=8;this.deviceType=g;this.currentState=this.MOUSE_SCALED_Y=this.MOUSE_SCALED_X=this.MOUSE_Y=this.MOUSE_X=0;this.canvasIsEnabled=!0;this.PRELOAD_COMPLETE=this.OBJECT_RENDER_CALLS=this.OBJECT_RENDER_CHECKS=0;this.EXTRA_CANVASES=[];this.EXTRA_CONTEXTS=
[];this.LEVEL_CURRENT_NAME="";this.exPlugins=[];this.EX_PLUGIN_COUNT=0;this.context=this.canvas=IS_NULL;this.currentCameraInView=0;this.CURRENT_VIEW=this.fileReader=this.rsm=this.inputController=this.preGuiContext=this.preGuiCanvas=this.mapContext=this.mapCanvas=this.GPE_Current_Context=IS_NULL;this.CURRENT_VIEW_BOX={xPos:0,yPos:0};this.currentVideoPlaying=this.lastLoopedVideo=this.lastLoopedTrack=-1;this.isPlayingVideo=!1;this.videoPlayingIsSkippable=!0;this.cbi={LEFT_BUT:0,RIGHT_BUT:1,UP_BUT:2,
DOWN_BUT:3,A_BUT:4,B_BUT:5,X_BUT:6,Y_BUT:7,START_BUT:8,SELECT_BUT:9,L_BUT:10,R_BUT:11,ZL_BUT:12,ZR_BUT:13,L2_BUT:14,L3_BUT:15,R2_BUT:16,R3_BUT:17,HOME_BUT:18,SHARE_BUT:19,EXT1_BUT:20,EXT2_BUT:21,EXT3_BUT:22,EXT4_BUT:23,EXT5_BUT:24};this.gpeScenes=[];this.gpeScenePos=0;this.cosValues=[];this.sinValues=[];this.tanValues=[];this.arcCosValues=[];this.arcSinValues=[];this.tarcTanValues=[];this.gamePaths=[];this.GPE_GamePath=function(b,a){function c(b,a){this.pathId=b;this.isClosedPath=a;this.pathPoints=
[];this.pathOriginalPoints=[];this.originalPathLength=this.pathLength=0}c.prototype.add_original_point=function(b,a,c){"number"!=typeof b&&(b=0);"number"!=typeof a&&(a=0);"number"==typeof c?0>=c&&(c=.1):c=1;b={pointX:b,pointY:a,pointRSpeed:c};this.pathOriginalPoints.push(b);this.pathPoints.push(b);this.originalPathLength++;this.pathLength++;return b};c.prototype.add_new_point=function(b,a,c){"number"!=typeof b&&(b=0);"number"!=typeof a&&(a=0);"number"==typeof c?0>=c&&(c=.1):c=1;b={pointX:b,pointY:a,
pointRSpeed:c};this.pathPoints.push(b);this.pathLength++;return b};c.prototype.insert_new_point=function(b,a,c,d){return"number"==typeof b&&0<=b&&b<this.pathLength?("number"!=typeof a&&(a=0),"number"!=typeof c&&(c=0),"number"==typeof d?0>=d&&(d=.1):d=1,a={pointX:a,pointY:c,pointRSpeed:d},this.pathPoints.insert(b,a),this.pathLength++,a):this.add_new_point(a,c,d)};c.prototype.get_point=function(b){return"number"==typeof b&&0<=b&&b<this.pathLength?this.pathPoints[b]:IS_NULL};c.prototype.get_size=function(){return this.pathLength};
c.prototype.restore_path=function(){this.pathPoints=[];for(var b=this.pathLength=0;b<this.originalPathLength;b++);this.pathLength=this.originalPathLength};return c}();this.add_path=function(b,a){var c=new gpe.GPE_GamePath(b,a);this.gamePaths.push(c);return c};this.create_path=function(b,a){if(a){var c=new gpe.GPE_GamePath(this.gamePaths.length,b);this.gamePaths.push(c)}else c=new gpe.GPE_GamePath(-1,b);return c};this.get_path=function(b){return"number"==typeof b&&0<=b&&b<this.gamePaths.length?this.gamePaths[b]:
IS_NULL};this.get_path_length=function(b){return"number"==typeof b&&0<=b&&b<this.gamePaths.length?this.gamePaths[b].pathLength:IS_NULL};this.get_path_original_length=function(b){return"number"==typeof b&&0<=b&&b<this.gamePaths.length?this.gamePaths[b].originalPathLength:IS_NULL};this.restore_path=function(b){"number"==typeof b&&0<=b&&b<this.gamePaths.length&&this.gamePaths[b].restore_path()};for(e=0;360>=e;e++)this.cosValues[e]=Math.cos(e*radiansMultiple),this.sinValues[e]=Math.sin(e*radiansMultiple),
this.tanValues[e]=Math.tan(e*radiansMultiple);this.abs=function(b){return"number"===typeof b?(0>b&&(b*=-1),b):0};this.bound_number=function(b,a,c){b<a?b=a:b>c&&(b=c);return b};this.cos=function(b){if(0>b)for(b*=-1;0>b;)b+=360;else if(360<b)for(;360<b;)b-=360;return this.cosValues[b|0]};this.degree=function(b){b*=degreesMultiple;return b+180};this.get_direction=function(b,a,c,d){return angle=Math.atan2(a-d,b-c)};this.get_distance=function(b,a,c,d){return b==c&&a==d?0:Math.sqrt(Math.pow(c-b,2)+Math.pow(d-
a,2))};this.get_random=function(b,a){return Math.random()*(a-b+1)+b|0};this.round=function(b){return b|0};this.sin=function(b){if(0>b)for(b*=-1;0>b;)b+=360;else if(360<b)for(;360<b;)b-=360;return this.sinValues[b|0]};this.tan=function(b){if(0>b)for(b*=-1;0>b;)b+=360;else if(360<b)for(;360<b;)b-=360;return 0<=b&360>=b?this.tanValues[b|0]:0};this.radian=function(b){return b=(b-180)*radiansMultiple};this.sign=function(b){return"number"===typeof b?b?0>b?-1:1:b===b?0:NaN:NaN};this.add_canvas=function(b,
a,c){var d=document.createElement("canvas");d.width=a;d.height=c;d.id=b;document.body.appendChild(d);return d};this.add_plugin=function(b){"undefined"!=typeof b&&(this.exPlugins[this.EX_PLUGIN_COUNT]=b,this.EX_PLUGIN_COUNT+=1)};this.apply_plugins_logics=function(){for(var b,a=0;a<gpe.exPlugins.size();a++)b=gpe.exPlugins.at(a),-1!=b&&b.process_plugin()};this.add_gamescene=function(b,a){var c=new U(b,a);this.gpeScenes.push(c);return c};this.audio_loop=function(b){this.play_audio(b,!0)};this.audio_play=
function(b,a){this.play_audio(b,a)};this.audio_playing=function(b){return this.is_audio_playing(b)};this.audio_stop_all=function(){this.stop_all_audio()};this.camera_on=function(b){return GPR.camera_on(b)};this.center_camera=function(b,a,c){GPR.center_camera(b,a,c)};this.check_collision_rect=function(b,a){var c=b.xPos,d=b.xPos+b.rectWidth,e=b.yPos,f=a.xPos,g=a.xPos+a.rectWidth,l=a.yPos+a.rectHeight;return!(b.yPos+b.rectHeight<=a.yPos||e>=l||d<=f||c>=g)};this.check_collision_with_rect=function(b,a,
c,d,e){var f=new u;f.update_shape(b,a,c,d);return this.check_collision_rect(e,f)};this.check_image_loading_status=function(b){return!b.complete||"undefined"!=typeof b.naturalWidth&&0==b.naturalWidth?!1:!0};this.gamepad_connected=function(b){return this.inputController.gamepad_connected(b)};this.gamepad_object=function(b){return this.inputController.gamepad_object(b)};this.gamepad_name=function(b){return this.inputController.gamepad_name(b)};this.find_gamepad_mapping=function(b,a){return this.inputController.gamepad_mapping(b,
a)};this.check_gamepad=function(b,a){return this.inputController.check_gamepad_down(b,a)};this.check_gamepad_down=function(b,a){return this.inputController.check_gamepad_down(b,a)};this.check_gamepad_pressed=function(b,a){return this.inputController.check_gamepad_pressed(b,a)};this.check_gamepad_released=function(b,a){return this.inputController.check_gamepad_released(b,a)};this.check_keyboard=function(b){return this.inputController.check_keyboard_down(b)};this.check_keyboard_down=function(b){return this.inputController.check_keyboard_down(b)};
this.check_keyboard_pressed=function(b){return this.inputController.check_keyboard_pressed(b)};this.check_keyboard_released=function(b){return this.inputController.check_keyboard_released(b)};this.check_mouse=function(b){return this.inputController.check_mouse_down(b)};this.check_mouse_down=function(b){return this.inputController.check_mouse_down(b)};this.check_mouse_pressed=function(b){return this.inputController.check_mouse_pressed(b)};this.check_mouse_released=function(b){return this.inputController.check_mouse_released(b)};
this.disable_camera=function(b){GPR.disable_camera(b)};this.disable_canvas=function(){this.canvasIsEnabled=!1;this.canvas.className="hide"};this.disable_outofsightmode=function(){this.OUT_OF_SIGHT_OUT_OF_PROCESSING=!1};this.enable_outofsightmode=function(){this.OUT_OF_SIGHT_OUT_OF_PROCESSING=!0};this.enable_camera=function(b){GPR.enable_camera(b)};this.enable_canvas=function(){this.canvasIsEnabled=!0;this.canvas.className="show"};this.enter_render=function(){gpe.GPE_Current_Context=gpe.context;0==
gpe.isPlayingVideo&&0!=gpe.currentState&&gpe.currentState.render_state();this.render_top_hud();C=window.countFPS()};this.erase_data=function(b,a){"undefined"!==typeof Storage&&localStorage.removeItem(b+"_"+a)};this.exit_video_view_mode=function(){gpe.isPlayingVideo=!1;gpe.currentVideoPlaying=-1};this.find_furthest_object=function(b,a,c,d){return GPR.find_furthest_object(b,a,c,d)};this.find_nearest_object=function(b,a,c,d){return GPR.find_nearest_object(b,a,c,d)};this.get_camera_height=function(b){return GPR.get_camera_height(b)};
this.get_camera_info=function(b){return GPR.get_camera_info(b)};this.get_camera_width=function(b){return GPR.get_camera_width(b)};this.get_camera_x=function(b){return GPR.get_camera_x(b)};this.get_camera_y=function(b){return GPR.get_camera_y(b)};this.get_camera_mouse_x=function(b){return GPR.get_camera_mouse_x(b)};this.get_camera_mouse_y=function(b){return GPR.get_camera_mouse_y(b)};this.get_camera_screen_height=function(b){return GPR.get_camera_screen_height(b)};this.get_camera_screen_width=function(b){return GPR.get_camera_screen_width(b)};
this.get_camera_screen_x=function(b){return GPR.get_camera_screen_x(b)};this.get_camera_screen_y=function(b){return GPR.get_camera_screen_y(b)};this.get_current_camera=function(){return this.currentCameraInView};this.get_current_camera_id=function(){return this.currentCameraInView};this.handle_canvas_size=function(){gpe.canvasIsEnabled?E==t.STATE_MAINGAME?1==GPE_GAME_SCALING_SETTING?(gpe.canvas.width=GPE_SETTINGS_SCREEN_WIDTH/2,gpe.canvas.height=GPE_SETTINGS_SCREEN_HEIGHT/2,gpe.masterScaleX=.5,gpe.masterScaleY=
.5):2==GPE_GAME_SCALING_SETTING?(gpe.canvas.width=2*GPE_SETTINGS_SCREEN_WIDTH,gpe.canvas.height=2*GPE_SETTINGS_SCREEN_HEIGHT,gpe.masterScaleX=2,gpe.masterScaleY=2):3==GPE_GAME_SCALING_SETTING?(gpe.canvas.height=window.innerHeight,gpe.canvas.width=GPE_SETTINGS_SCREEN_WIDTH/GPE_SETTINGS_SCREEN_HEIGHT*window.innerHeight,gpe.masterScaleX=gpe.canvas.width/GPE_SETTINGS_SCREEN_WIDTH,gpe.masterScaleY=gpe.canvas.height/GPE_SETTINGS_SCREEN_HEIGHT):4==GPE_GAME_SCALING_SETTING?(gpe.canvas.height=window.innerHeight,
gpe.canvas.width=window.innerWidth,gpe.masterScaleX=gpe.canvas.width/GPE_SETTINGS_SCREEN_WIDTH,gpe.masterScaleY=gpe.canvas.height/GPE_SETTINGS_SCREEN_HEIGHT):(gpe.canvas.height=GPE_SETTINGS_SCREEN_HEIGHT,gpe.canvas.width=GPE_SETTINGS_SCREEN_WIDTH,gpe.masterScaleX=1,gpe.masterScaleY=1):(gpe.canvas.height=window.innerHeight,gpe.canvas.width=window.innerWidth,gpe.masterScaleX=gpe.canvas.width/GPE_SETTINGS_SCREEN_WIDTH,gpe.masterScaleY=gpe.canvas.height/GPE_SETTINGS_SCREEN_HEIGHT):(gpe.canvas.height=
0,gpe.canvas.width=0,gpe.masterScaleX=1,gpe.masterScaleY=1)};this.load_data=function(b,a){if("undefined"!==typeof Storage){var c=localStorage.getItem(b+"_"+a);return null==c?IS_NULL:c}return IS_NULL};this.GPE_GameObject=function(b,a,c){function d(b,a,c){this.foundPathObject=this.pathId=-1;this.pathTargetPosition=this.pathTargetY=this.pathTargetX=this.pathRelativeY=this.pathRelativeX=this.pathPosition=0;this.pathReplayOnEnd=!0;this.pathCurrentDirection=this.pathCurrentSpeed=this.pathSpeed=0;this.pathGoingForward=
!0;this.sceneLayerStartPos=this.sceneLayerPos=c;this.customComponents={};this.spriteId=this.gpeSceneStartId=IS_NULL;this.outlineTestColor="lime";this.gpeObjectType=this.objectDepthPosition=this.prevObjectDepth=this.objectDepth=0;this.gpeUniqGameObjectId=-1;this.hasPreRenderFunction=this.gpeAddedToContinuousList=this.gpeAddedToRenderList=this.gpePrelogicAppliedInFrame=this.gpeLogicAppliedInFrame=this.GPE_AddedToGridSystem=!1;this.hasRenderFunction=!0;this.gpeSceneStartCodeUsed=this.gpeHasLogicFunction=
this.gpeHasStartLogicFunction=this.hasHudRenderFunction=this.gpeHasTimedFunctions=this.hasPostRenderFunction=!1;this.prerenderedInFrame=[];this.renderedInFrame=[];this.renderedAboveInFrame=[];this.hudrenderedInFrame=[];for(c=0;c<gpe.maxCameras;c++)this.prerenderedInFrame[c]=!1,this.renderedInFrame[c]=!1,this.renderedAboveInFrame[c]=!1,this.hudrenderedInFrame[c]=!1;this.collisionBox=new u;this.collisionBox.update_shape(b,a,32,32);this.isOutsideScene=!1;this.lastCollisionObjId=-1;this.applyGravity=
!0;this.gravityDirection=270;this.imageSpeed=this.spriteFrame=this.gravityEffect=0;this.isVisible=this.animationEnded=!1;this.xPos=this.xBegin=b;this.x2Pos=b+32;this.yPos=this.yBegin=a;this.y2Pos=a+32;this.animationDuration=this.defaultSpeed=this.speed=this.direction=this.yspeed=this.xspeed=this.y2Past=this.yPast=this.x2Past=this.xPast=this.yVel=this.xVel=this.yEnd=this.xEnd=0;this.gpeIsBeingDestroyed=!1;this.isInit=!0;this.isViewIndependent=!1;this.isInView=[];this.timeToCheckForInView=[];for(b=
b=0;b<gpe.maxCameras;b++)this.isInView[b]=!1,this.timeToCheckForInView[b]=0;this.functionTimer=[];for(b=0;10>=b;b++)this.functionTimer[b]=0;this.timedFunction0=function(){};this.timedFunction1=function(){};this.timedFunction2=function(){};this.timedFunction3=function(){};this.timedFunction4=function(){};this.timedFunction5=function(){};this.timedFunction6=function(){};this.timedFunction7=function(){};this.timedFunction8=function(){};this.timedFunction9=function(){};this.timedFunction10=function(){};
this.OBJECT_COLLISION_LIST=[];this.SPATIAL_PARTITION_LIST=[];this.GPE_SearchForCollisionBegin=0;this.under_mouse=function(b){if("undefined"==typeof b)b=0;else if(0>b||b>=gpe.maxCameras)b=0;return GPR.MOUSE_CAM_X[b]>=this.xPos&&GPR.MOUSE_CAM_X[b]<=this.x2Pos&&GPR.MOUSE_CAM_Y[b]>=this.yPos&&GPR.MOUSE_CAM_Y[b]<=this.y2Pos?!0:!1}}d.prototype.add_object=function(b,a,c){return GPE.add_new_object(b,a,c,this.sceneLayerStartPos)};d.prototype.bounce_from=function(b){};d.prototype.collide_with=function(b){};
d.prototype.initialize=function(){this.default_load()};d.prototype.equals=function(b){return"undefined"!=typeof b?b.gpeObjectType==this.gpeObjectType&&b.gpeUniqGameObjectId==this.gpeUniqGameObjectId?!0:!1:-1};d.prototype.default_load=function(){this.lastCollisionObjId=this.spriteId=IS_NULL;this.applyGravity=!0;this.gravityDirection=270;this.imageSpeed=this.spriteFrame=this.gravityEffect=0;this.isVisible=this.animationEnded=!1;this.animationDuration=this.defaultSpeed=this.speed=this.direction=this.yspeed=
this.xspeed=this.y2Past=this.x2Past=this.yPast=this.xPast=this.yVel=this.xVel=this.yEnd=this.xEnd=0;this.gpeUniqGameObjectId=-1;this.SPATIAL_PARTITION_LIST=[]};d.prototype.get_component=function(b){b=this.customComponents[b];return"undefined"!=typeof b?b:IS_NULL};d.prototype.gpe_constructor=function(){this.default_load()};d.prototype.get_depth=function(){return this.objectDepth};d.prototype.get_collision_height=function(){return this.collisionBox.rectHeight};d.prototype.get_collision_width=function(){return this.collisionBox.rectWidth};
d.prototype.get_my_direction=function(b,a){return gpe.get_direction(this.collisionBox.xPos,this.collisionBox.yPos,b,a)};d.prototype.get_my_distance=function(b,a){return gpe.get_distance(this.collisionBox.xPos,this.collisionBox.yPos,b,a)};d.prototype.get_sprite=function(){return this.spriteId};d.prototype.getx=function(){return this.xPos};d.prototype.getx2=function(){return this.x2Pos};d.prototype.gety=function(){return this.yPos};d.prototype.gety2=function(){return this.y2Pos};d.prototype.end_frame_logic=
function(){};d.prototype.gravity_use=function(){if(0!=this.gravityEffect||0!=this.vspd)270==this.gravityDirection?this.yspeed+=this.gravityEffect:90==this.gravityDirection?this.yspeed-=this.gravityEffect:(this.xspeed+=Math.cos(this.gravityDirection)*this.gravityEffect,this.yspeed+=Math.sin(this.gravityDirection)*this.gravityEffect,this.move_right(this.xspeed)),this.move_down(this.yspeed)};d.prototype.init_sprite=function(b){"number"==typeof b&&(this.spriteId=b,this.spriteFrame=0,0<=this.spriteId&&
this.spriteId<gpe.rsm.rSprites.length?(b=gpe.rsm.rSprites[this.spriteId],this.collisionBox.update_shape(this.xPos+b.colX,this.yPos+b.colY,b.colWidth,b.colHeight),this.x2Pos=this.xPos+b.colX+b.colWidth,this.y2Pos=this.yPos+b.colY+b.colHeight):(this.collisionBox.update_shape(this.xPos,this.yPos,32,32),this.x2Pos=this.xPos+32,this.y2Pos=this.yPos+32),this.x2Past=this.x2Pos,this.y2Past=this.y2Pos)};d.prototype.make_view_dependent=function(){if(this.isViewIndependent){this.isViewIndependent=!1;var b=this.currentScene.get_layer(this.sceneLayerPos,
GPE_LAYER_TYPE_OBJECTS);if(-1!=b)for(var a=b.independentObjects.length-1;0<=a;a--){var c=b.independentObjects[a];c.gpeUniqGameObjectId==this.gpeUniqGameObjectId&&b.independentObjects.splce(a)}}};d.prototype.make_view_independent=function(){if(!this.isViewIndependent){this.isViewIndependent=!0;var b=this.currentScene.get_layer(this.sceneLayerPos,GPE_LAYER_TYPE_OBJECTS);-1!=b&&b.independentObjects.push(this)}};d.prototype.move_left=function(b){this.collisionBox.add_x(-b);this.xPos-=b;this.x2Pos-=b;
GPR.update_object_in_map(this)};d.prototype.move_right=function(b){this.collisionBox.add_x(b);this.xPos+=b;this.x2Pos+=b;GPR.update_object_in_map(this)};d.prototype.move_up=function(b){this.collisionBox.add_y(-b);this.yPos-=b;this.y2Pos-=b;GPR.update_object_in_map(this)};d.prototype.move_down=function(b){this.collisionBox.add_y(b);this.yPos+=b;this.y2Pos+=b;GPR.update_object_in_map(this)};d.prototype.move_towards=function(b,a,c){"number"==typeof b&&"number"==typeof a&&"number"==typeof c?(this.direction=
this.get_my_direction(b,a),this.speed=c):this.direction=this.speed=0};d.prototype.path_begin=function(b,a,c,d){var e=IS_NULL;"number"==typeof b?e=GPE.get_path(b):"Object"==typeof b&&(e=b);"number"!=typeof a&&(a=1);"bool"!=typeof c&&(c=!0);"bool"!=typeof d&&(d=!1);e!=IS_NULL&&(this.pathId=e.pathId,this.foundPathObject=e,this.pathRelativeY=this.pathRelativeX=this.pathPosition=0,this.pathSpeed=Math.abs(a),this.pathCurrentSpeed=Math.abs(a),this.pathReplayOnEnd=c,1<e.pathPoints.length?d?(this.pathRelativeX=
e.pathPoints[0].pointX-this.collisionBox.xCenter,this.pathRelativeY=e.pathPoints[0].pointY-this.collisionBox.yMiddle,0<=a?(this.pathPosition=e.pathPoints.length-1,this.path_move_towards_point(1),this.pathGoingForward=!0):(this.path_move_towards_point(e.pathPoints.length-1),this.pathGoingForward=!1)):0<=a?(this.pathPosition=e.pathPoints.length-1,this.path_move_towards_point(0),this.pathGoingForward=!0):(this.path_move_towards_point(e.pathPoints.length-1),this.pathGoingForward=!1):console.log("Path does not have enough points to begin..."))};
d.prototype.path_start=function(b,a,c,d){this.path_begin(b,a,c,d)};d.prototype.path_move_along=function(){return!1};d.prototype.path_move_towards_point=function(b){if(this.foundPathObject!=IS_NULL&&"number"==typeof b&&0<=b&&b<this.foundPathObject.pathPoints.length)return this.pathTargetX=this.foundPathObject.pathPoints[b].pointX-this.pathRelativeX,this.pathTargetY=this.foundPathObject.pathPoints[b].pointY-this.pathRelativeY,this.pathCurrentDirection=this.get_my_direction(this.pathTargetX,this.pathTargetY),
this.pathCurrentSpeed=this.foundPathObject.pathPoints[b].pointRSpeed*this.pathSpeed,this.pathTargetPosition=b,!0;this.pathCurrentDirection=this.pathCurrentSpeed=this.pathTargetPosition=this.pathPosition=0;return!1};d.prototype.path_end=function(){this.pathId=-1;this.foundPathObject=IS_NULL;this.pathRelativeY=this.pathRelativeX=this.pathPosition=0;this.pathReplayOnEnd=!0;this.pathTargetY=this.pathTargetX=this.pathCurrentSpeed=this.pathSpeed=0};d.prototype.path_stop=function(){this.pathId=-1;this.foundPathObject=
IS_NULL;this.pathRelativeY=this.pathRelativeX=this.pathPosition=0;this.pathReplayOnEnd=!0;this.pathTargetY=this.pathTargetX=this.pathCurrentSpeed=this.pathSpeed=0};d.prototype.using_path=function(){return-1!=this.pathId&&this.foundPathObject!=IS_NULL?!0:!1};d.prototype.get_path_id=function(){return this.pathId};d.prototype.get_path_object=function(){return this.foundPathObject};d.prototype.get_path_targetx=function(){return this.pathTargetX};d.prototype.get_path_targety=function(){return this.pathTargetY};
d.prototype.get_path_position=function(){return this.pathPosition};d.prototype.get_path_original_size=function(){this.foundPathObject!=IS_NULL&&this.foundPathObject.originalPathLength;return-1};d.prototype.get_path_size=function(){this.foundPathObject!=IS_NULL&&this.foundPathObject.pathLength;return-1};d.prototype.perform_object_logic=function(){};d.prototype.perform_object_prelogic=function(){this.xPast=this.collisionBox.xPos;this.yPast=this.collisionBox.yPos;this.x2Past=this.collisionBox.x2Pos;
this.y2Past=this.collisionBox.y2Pos;this.gpeLogicAppliedInFrame=!1;for(var b=gpe.maxCameras-1;0<=b;b--)this.prerenderedInFrame[b]=!1,this.renderedInFrame[b]=!1,this.hudrenderedInFrame[b]=!1;this.gpeAddedToRenderList=!1};d.prototype.process_gpe_movement=function(){if("number"==typeof this.pathCurrentSpeed&&0<this.pathCurrentSpeed)this.get_my_distance(this.pathTargetX,this.pathTargetY)>2*this.pathCurrentSpeed?(this.move_left(Math.cos(this.pathCurrentDirection)*this.pathCurrentSpeed),this.move_up(Math.sin(this.pathCurrentDirection)*
this.pathCurrentSpeed)):this.pathGoingForward?(this.pathPosition=this.pathTargetPosition,this.pathTargetPosition+1<this.foundPathObject.pathPoints.length-1?this.path_move_towards_point(this.pathTargetPosition+1):this.pathReplayOnEnd?this.foundPathObject.isClosedPath?this.path_move_towards_point(0):(this.path_move_towards_point(this.foundPathObject.pathPoints.length-1),this.pathGoingForward=!1):this.path_end()):0<=this.pathTargetPosition-1&&this.pathTargetPosition-1<this.foundPathObject.pathPoints.length-
1?this.path_move_towards_point(this.pathTargetPosition-1):this.pathReplayOnEnd?this.foundPathObject.isClosedPath?this.path_move_towards_point(this.foundPathObject.pathPoints.length-1):(this.path_move_towards_point(0),this.pathGoingForward=!0):this.path_end();else if("number"==typeof this.speed&&0!=this.speed){this.xspeed=Math.cos(this.direction)*this.speed;this.yspeed=Math.sin(this.direction)*this.speed;this.move_left(this.xspeed);this.move_up(this.yspeed);return}this.speed=0};d.prototype.process_timed_functions=
function(){0<this.functionTimer[0]&&0>=--this.functionTimer[0]&&(this.functionTimer[0]=-1,this.timedFunction0());0<this.functionTimer[1]&&0>=--this.functionTimer[1]&&(this.functionTimer[1]=-1,this.timedFunction1());0<this.functionTimer[2]&&0>=--this.functionTimer[2]&&(this.functionTimer[2]=-1,this.timedFunction2());0<this.functionTimer[3]&&0>=--this.functionTimer[3]&&(this.functionTimer[3]=-1,this.timedFunction3());0<this.functionTimer[4]&&0>=--this.functionTimer[4]&&(this.functionTimer[4]=-1,this.timedFunction4());
0<this.functionTimer[5]&&0>=--this.functionTimer[5]&&(this.functionTimer[5]=-1,this.timedFunction5());0<this.functionTimer[6]&&0>=--this.functionTimer[6]&&(this.functionTimer[6]=-1,this.timedFunction6());0<this.functionTimer[7]&&0>=--this.functionTimer[7]&&(this.functionTimer[7]=-1,this.timedFunction7());0<this.functionTimer[8]&&0>=--this.functionTimer[8]&&(this.functionTimer[8]=-1,this.timedFunction8());0<this.functionTimer[9]&&0>=--this.functionTimer[9]&&(this.functionTimer[9]=-1,this.timedFunction9());
0<this.functionTimer[10]&&0>=--this.functionTimer[10]&&(this.functionTimer[10]=-1,this.timedFunction10())};d.prototype.render_above=function(){};d.prototype.render_under=function(){};d.prototype.render_hud=function(){};d.prototype.render_self=function(){gpe.preload_completed()&&0<=this.spriteId?(gpe.OBJECT_RENDER_CALLS+=1,gpe.render_sprite(this.spriteId,this.spriteFrame,this.xPos,this.yPos,1,1)):GPE_DRAW_OBJECT_BOXES&&gpe.render_rectangle(this.collisionBox.xPos,this.collisionBox.yPos,this.collisionBox.x2Pos,
this.collisionBox.y2Pos,"blue",!0,1);gpe.render_calls++};d.prototype.scene_end=function(){};d.prototype.scene_start=function(){};d.prototype.self_destruct=function(){if(0==this.gpeIsBeingDestroyed){this.self_obliterate();this.gpeIsBeingDestroyed=!0;GPR.add_object_to_deletion_list(this);var b=GPR.GAME_OBJECTS[this.gpeObjectType];var a=IS_NULL;for(var c=!1,d=GPR.currentScene.sceneLayers.length-1;0<=d;d--)if(a=GPR.currentScene.sceneLayers[d],a.layerId==this.sceneLayerPos){c=!0;break}c?a.remove_object(this):
console.log("unable to find matching layer to delete from...");for(c=b.length-1;0<=c;c--)if(a=b[c],a.gpeUniqGameObjectId==this.gpeUniqGameObjectId){b.splice(c,1);break}}};d.prototype.set_depth=function(b){};d.prototype.self_obliterate=function(){};d.prototype.set_sprite=function(b){"number"==typeof this.spriteId&&this.spriteId!=b&&(this.spriteId=b,this.spriteFrame=0,0<=this.spriteId&&this.spriteId<gpe.rsm.rSprites.length?(b=gpe.rsm.rSprites[this.spriteId],this.collisionBox.update_shape(this.xPos+
b.colX,this.yPos+b.colY,b.colWidth,b.colHeight),this.x2Pos=this.xPos+b.colX+b.colWidth,this.y2Pos=this.yPos+b.colY+b.colHeight):(this.collisionBox.update_shape(this.xPos,this.yPos,32,32),this.x2Pos=this.xPos+32,this.y2Pos=this.yPos+32),this.x2Past=this.x2Pos,this.y2Past=this.y2Pos,GPR.update_object_in_map(this))};d.prototype.setx=function(b){if(0<=this.spriteId&&this.spriteId<gpe.rsm.rSprites.length){var a=gpe.rsm.rSprites[this.spriteId];this.collisionBox.set_x(b+a.colX);this.x2Pos=this.xPos+a.colX+
a.colWidth}else this.collisionBox.set_x(b);this.xPos=b;this.x2Pos=b+32;GPR.update_object_in_map(this)};d.prototype.sety=function(b){if(0<=this.spriteId&&this.spriteId<gpe.rsm.rSprites.length){var a=gpe.rsm.rSprites[this.spriteId];this.collisionBox.set_y(newX+a.colY);this.y2Pos=this.yPos+a.colY+a.colHeight}else this.collisionBox.set_y(b),this.y2Pos=b+32;this.yPos=b;GPR.update_object_in_map(this)};d.prototype.speed_move=function(){};d.prototype.set_velocity=function(b,a){-0==b&&(b=0);"number"==typeof b&&
(this.direction=b,"number"==typeof a&&(this.speed=a))};d.prototype.start_countdown=function(b,a){0<=b&&10>=b&&"number"==typeof a&&(this.functionTimer[b]=a)};d.prototype.set_countdown=function(b,a){0<=b&&10>=b&&"number"==typeof a&&(this.functionTimer[b]=a)};d.prototype.start_frame_logic=function(){};d.prototype.set_timer=function(b,a){0<=b&&10>=b&&"number"==typeof a&&(this.functionTimer[b]=60*a)};d.prototype.start_timer=function(b,a){0<=b&&10>=b&&"number"==typeof a&&(this.functionTimer[b]=60*a)};d.prototype.update_animation=
function(b){0<=this.spriteId&&this.spriteId<gpe.rsm.rSprites.length&&(b=gpe.rsm.rSprites[this.spriteId],1<b.frameCount&&(this.spriteFrame+=this.imageSpeed,this.spriteFrame>=b.frameCount-1&&(this.spriteFrame=0),0>this.spriteFrame&&(this.spriteFrame=b.frameCount-2)))};d.prototype.under_mouse=function(b){};d.prototype.update_cords=function(b,a){this.xPos=b;this.yPos=a;if(0<=this.spriteId&&this.spriteId<gpe.rsm.rSprites.length){var c=gpe.rsm.rSprites[this.spriteId];this.collisionBox.update_position(b+
c.colX,a+c.colY);this.collisionBox.update_size(c.colWidth,c.colHeight);this.x2Pos=this.xPos+c.colX+c.colWidth;this.y2Pos=this.yPos+c.colY+c.colHeight}else this.collisionBox.update_position(b,a),this.collisionBox.update_position(32,32),this.x2Pos=b+32,this.y2Pos=a+32;GPR.update_object_in_map(this)};d.prototype.touches_tile=function(b){return GPR.find_tile_in_box(b,this.xPos,this.yPos,this.x2Pos,this.y2Pos)};d.prototype.touches_certain_tile=function(b,a){return GPR.find_matching_tile_in_box(b,this.xPos,
this.yPos,this.x2Pos,this.y2Pos,a)};return d}();this.SuperSpatialPartition=function(){function b(){this.internalArray=[];this.heldObjectsArray=[];this.objectsHeld=0;this.boxArea=new u;this.spaceName="CAS_X2015_";for(var b=0;b<GPE_MAX_OBJECT_TYPES;b++)this.heldObjectsArray[b]=[]}b.prototype.add_object=function(b){this.internalArray[this.objectsHeld]=b;this.heldObjectsArray[b.gpeObjectType].push_back(b);this.objectsHeld+=1};b.prototype.empty_list=function(){for(var b=this.objectsHeld=this.internalArray.length=
0;b<GPE_MAX_OBJECT_TYPES;b++)this.heldObjectsArray[b]=[]};b.prototype.remove_held_object=function(b){if("undefined"!=typeof b){for(var a,c=this.internalArray.length-1;0<=c;c--)a=this.internalArray[c],a.gpeUniqGameObjectId==b.gpeUniqGameObjectId&&(this.internalArray.splice(c,1),--this.objectsHeld);c=this.heldObjectsArray[b.gpeObjectType];for(var d=c.length-1;0<=d;d--)a=c[d],a.gpeUniqGameObjectId==b.gpeUniqGameObjectId&&this.heldObjectsArray[b.gpeObjectType].splice(d,1)}};b.prototype.set_space=function(b,
a,c,d){this.boxArea.update_shape(b,a,c,d)};return b}();this.find_last_object=function(b){return GPR.find_last_object(b)};this.getfps=function(){return C};this.get_fps=function(){return C};this.get_mouse_x=function(){return this.MOUSE_SCALED_X};this.get_mouse_y=function(){return this.MOUSE_SCALED_Y};this.get_object_count=function(b){return GPR.get_object_count(b)};this.get_object_in_view_count=function(b){return 0<=b&&b<GPE_MAX_OBJECT_TYPES?GPR.get_object_in_view_count(b):0};this.find_tile=function(b,
a,c){return GPR.find_tile(b,a,c)};this.find_tile_in_box=function(b,a,c,d,e){return GPR.find_tile_in_box(b,a,c,d,e)};this.find_matching_tile=function(b,a,c,d){return GPR.find_matching_tile(b,a,c,d)};this.find_matching_tile_in_box=function(b,a,c,d,e,g){return GPR.find_tile_in_box(b,a,c,d,e,g)};this.get_current_scene_id=function(){return GPR.currentSceneId};this.get_current_scene_name=function(){return this.get_scene_name(GPR.currentSceneId)};this.get_scene_height=function(b){return"number"===typeof b&&
0<=b&&b<this.gpeScenes.length?this.gpeScenes[sceneIdNumber].sceneHeight:GPR.get_scene_height()};this.get_scene_name=function(b){return"number"===typeof b&&0<=b&&b<this.gpeScenes.length?this.gpeScenes[sceneIdNumber].sceneName:this.get_current_scene_name()};this.get_scene_width=function(b){return"number"===typeof b&&0<=b&&b<this.gpeScenes.length?this.gpeScenes[sceneIdNumber].sceneWidth:GPR.get_scene_width()};this.scene_enter_named=function(b){for(var a=this.gpeScenes.length-1;0<=a;a--)if(this.gpeScenes[a].sceneName==
b)return GPR.scene_enter(a),!0;return!1};this.scene_enter=function(b){return GPR.scene_enter(b)};this.scene_enter_next=function(){return GPR.scene_enter_next()};this.scene_enter_previous=function(){return GPR.scene_emter_previous()};this.scene_reset=function(b){GPR.scene_reset(b)};this.get_sprite_width=function(b){return"number"==typeof b&&(b|=0,0<=b&&b<gpe.rsm.rSprites.length)?gpe.rsm.rSprites[b].spriteWidth:0};this.get_sprite_height=function(b){return"number"==typeof b&&(b|=0,0<=b&&b<gpe.rsm.rSprites.length)?
gpe.rsm.rSprites[b].spriteHeight:0};this.get_sprite_length=function(b){return"number"==typeof b&&(b|=0,0<=b&&b<gpe.rsm.rSprites.length)?gpe.rsm.rSprites[b].frameCount:0};this.get_sprite_object=function(b){return"number"==typeof b&&(b|=0,0<=b&&b<gpe.rsm.rSprites.length)?gpe.rsm.rSprites[b]:IS_NULL};this.get_texture_width=function(b){return"number"==typeof b&&(b|=0,0<=b&&b<gpe.rsm.rSprites.length)?gpe.rsm.rTextures[b].texWid:0};this.get_texture_height=function(b){return"number"==typeof b&&(b|=0,0<=
b&&b<gpe.rsm.rSprites.length)?gpe.rsm.rTextures[b].texHeight:0};this.find_newest_object=function(b){return GPR.find_newest_object(b)};this.find_collision_rectangle=function(b,a,c,d,e){return GPR.find_collision_rectangle(b,a,c,d,e)};this.game_reset=function(){GPR.game_reset();location.reload()};this.is_audio_playing=function(b){if("undefined"!=typeof b)return 0<=b&&b<this.rsm.rAudio.length&&(b=this.rsm.rAudio[b|0],-1!=b)?b.check_is_playing():!1};this.is_video_playing=function(b){if("undefined"!=typeof b)return 0<=
b&&b<this.rsm.rVideos.length&&(b=this.rsm.rVideos[b],-1!=b)?b.check_is_playing():!1};this.loop_last_track=function(){gpe.play_audio(gpe.lastLoopedTrack,!0)};this.loop_last_video=function(){gpe.play_video(gpe.lastLoopedVideo,!0)};this.make_array_unique=function(b){return b.reduce(function(b,a){0>b.indexOf(a)&&b.push(a);return b},[])};this.move_camera=function(b,a,c){GPR.move_camera(b,a,c)};this.pause_audio=function(b){"undefined"!=typeof b&&0<=b&&b<this.rsm.rAudio.length&&(b=this.rsm.rAudio[b|0],-1!=
b&&b.pause_audio())};this.pause_all_audio=function(){for(var b=this.rsm.rAudio.length-1;0<=b;b--){var a=this.rsm.rAudio[b];-1!=a&&a.pause_audio()}};this.loop_audio=function(b){"undefined"!=typeof b&&0<=b&&b<this.rsm.rAudio.length&&(b=this.rsm.rAudio[b|0],-1!=b&&b.play_audio(!0))};this.play_audio=function(b,a){"undefined"==typeof a&&(a=!1);if("undefined"!=typeof b&&0<=b&&b<this.rsm.rAudio.length){var c=this.rsm.rAudio[b|0];-1!=c&&c.play_audio(a)}};this.pause_audio_group=function(b){if("undefined"!=
typeof b)for(var a=this.rsm.rAudio.length-1;0<=a;a--){var c=this.rsm.rAudio[a];-1!=c&&c.audioGroupName==b&&c.pause_audio()}};this.pause_video=function(b){"undefined"!=typeof b&&0<=b&&b<this.rsm.rVideos.length&&(b=this.rsm.rVideos[b|0],-1!=b&&b.pause_video())};this.pause_all_video=function(){for(var b=this.rsm.rVideos.length-1;0<=b;b--){var a=this.rsm.rVideos[b];-1!=a&&a.pause_video()}};this.play_video=function(b,a,c){"undefined"==typeof a&&(a=!1);"undefined"!=typeof b&&0<=b&&b<this.rsm.rVideos.length&&
(b=this.rsm.rVideos[b|0],-1!=b&&b.play_video(a,c))};this.pause_video_group=function(b){if("undefined"!=typeof b)for(var a=this.rsm.rVideos.length-1;0<=a;a--){var c=this.rsm.rVideos[a];-1!=c&&c.videoGroupName==b&&c.pause_video()}};this.position_collides=function(b,a,c,d,e){return GPR.find_collision_rectangle(b,a,c,d,e)};this.position_open=function(b,a,c,d){return GPR.position_open(b,a,c,d)};this.point_between=function(b,a,c,d,e,g){var f=Math.max(c,e),h=Math.min(d,g);d=Math.max(d,g);return b>Math.min(c,
e)&&b<f&&a>h&&a<d?!0:!1};this.point_within=function(b,a,c,d,e,g){var f=Math.max(c,e),h=Math.min(d,g);d=Math.max(d,g);return b>=Math.min(c,e)&&b<=f&&a>=h&&a<=d?!0:!1};this.preload_completed=function(){return this.PRELOAD_COMPLETE};this.render_circle=function(b,a,c,d,e,g,m){b-=gpe.CURRENT_VIEW_BOX.xPos;a-=gpe.CURRENT_VIEW_BOX.yPos;0<c&&(0>c&&(c*=-1),gpe.GPE_Current_Context.beginPath(),gpe.GPE_Current_Context.arc(b,a,c,0,2*Math.PI,!1),1==e?(gpe.GPE_Current_Context.lineWidth=g,gpe.GPE_Current_Context.strokeStyle=
d,gpe.GPE_Current_Context.stroke()):(gpe.GPE_Current_Context.fillStyle=d,gpe.GPE_Current_Context.fill()),gpe.GPE_Current_Context.closePath())};this.render_current_video=function(){if(0<=this.currentVideoPlaying&&this.currentVideoPlaying<this.rsm.rVideos.length){var b=this.rsm.rVideos[this.currentVideoPlaying];-1!=b&&b.render_video(0,0,GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT)}};this.render_line=function(b,a,c,d,e,g,m){b-=gpe.CURRENT_VIEW_BOX.xPos;a-=gpe.CURRENT_VIEW_BOX.yPos;c-=gpe.CURRENT_VIEW_BOX.xPos;
d-=gpe.CURRENT_VIEW_BOX.yPos;"number"!=typeof g&&(g=1);0!=g&&(0>g&&(g*=-1),gpe.GPE_Current_Context.beginPath(),gpe.GPE_Current_Context.moveTo(b,a),gpe.GPE_Current_Context.lineTo(c,d),gpe.GPE_Current_Context.lineWidth=g,gpe.GPE_Current_Context.strokeStyle=e,gpe.GPE_Current_Context.stroke())};this.render_rect=function(b,a,c,d,e){"undefined"==typeof b&&this.render_rectangle(b.xPos,b.yPos,b.x2Pos,rectin.y2Pos,a,c,d)};this.render_rectangle=function(b,a,c,d,e,g,m,l){l=Math.min(b,c)-gpe.CURRENT_VIEW_BOX.xPos;
var f=Math.min(a,d)-gpe.CURRENT_VIEW_BOX.yPos;b=Math.abs(b-c);a=Math.abs(a-d);g?(gpe.GPE_Current_Context.beginPath(),gpe.GPE_Current_Context.rect(l,f,b,a),gpe.GPE_Current_Context.lineWidth=m,gpe.GPE_Current_Context.strokeStyle=e,gpe.GPE_Current_Context.stroke()):(gpe.GPE_Current_Context.fillStyle=e,gpe.GPE_Current_Context.fillRect(l,f,b,a))};this.render_sprite=function(b,a,c,d,e,g){"number"==typeof b&&(b|=0,0<=b&&b<gpe.rsm.rSprites.length&&gpe.rsm.rSprites[b].render_to_context(gpe.GPE_Current_Context,
a,c|0,d|0,e,g))};this.render_sprite_rotated=function(b,a,c,d,e,g,m){b&&0<=b&&b<gpe.rsm.rSprites.length&&(b=gpe.rsm.rSprites[b|0],-1!=b&&(0<e&&360>e?(gpe.GPE_Current_Context.save(),gpe.GPE_Current_Context.translate(c,d),gpe.GPE_Current_Context.rotate(e*GPE_TO_RADIANS),b.render_to_context(gpe.GPE_Current_Context,a,-(b.get_width()/2),-(b.get_height()/2),g,m),gpe.GPE_Current_Context.restore()):b.render_to_context(gpe.GPE_Current_Context,a,c,d,g,m)))};this.render_square=function(b,a,c,d,e,g,m){a-=gpe.CURRENT_VIEW_BOX.xPos;
b-=gpe.CURRENT_VIEW_BOX.yPos;0!=c&&(0>c&&(a-=c,b-=c,c*=-1),e?(gpe.GPE_Current_Context.beginPath(),gpe.GPE_Current_Context.rect(a,b,c,c),gpe.GPE_Current_Context.lineWidth=g,gpe.GPE_Current_Context.strokeStyle=d,gpe.GPE_Current_Context.stroke()):(gpe.GPE_Current_Context.fillStyle=d,gpe.GPE_Current_Context.fillRect(a|0,b|0,c,c)))};this.render_text=function(b,a,c,d,e,g,m){d=""+d;if(0<d.length){a-=gpe.CURRENT_VIEW_BOX.xPos;c-=gpe.CURRENT_VIEW_BOX.yPos;var f=!1;"undefined"!=typeof b&&0<=b&&b<gpe.rsm.rFonts.length&&
(b=gpe.rsm.rFonts[b|0],-1!=b&&(gpe.GPE_Current_Context.font=b.fontCanvasInfo,f=!0));0==f&&(gpe.GPE_Current_Context.font="20px Arial");gpe.GPE_Current_Context.textAlign=g==fa_right?"right":g==fa_center?"center":"left";gpe.GPE_Current_Context.textBaseline=m==fa_bottom?"bottom":m==fa_middle?"middle":"top";gpe.GPE_Current_Context.fillStyle=e;gpe.GPE_Current_Context.fillText(d,a|0,c|0)}};this.render_texture=function(b,a,c){"undefined"!=typeof b&&0<=b&&b<gpe.rsm.rTextures.length&&(b=gpe.rsm.rTextures[b|
0],-1!=b&&b.render_to_context(gpe.GPE_Current_Context,a|0,c|0))};this.render_texture_scaled=function(b,a,c,d,e){"undefined"!=typeof b&&0<=b&&b<gpe.rsm.rTextures.length&&(b=gpe.rsm.rTextures[b|0],-1!=b&&b.render_tex_scaled(gpe.GPE_Current_Context,a|0,c|0))};this.render_texture_clipped=function(b,a,c,d){"undefined"!=typeof b&&0<=b&&b<gpe.rsm.rTextures.length&&(b=gpe.rsm.rTextures[b|0],-1!=b&&b.render_tex_clipped(gpe.GPE_Current_Context,a|0,c|0,d))};this.render_top_hud=function(){gpe.isPlayingVideo&&
this.render_current_video();GPE_SETTINGS_IS_DEBUGGING&&(gpe.context.font="bold 16pt Calibri",gpe.context.textAlign="left",gpe.context.textAlign="left",gpe.context.fillStyle="red",gpe.GPE_Current_Context.fillText(C+" fps ||| Checking "+this.colisionObjectLoops+"times with "+GPR.spatialCollisionChecks+" collision checks",40,gpe.SCREEN_HEIGHT-32))};this.render_triangle=function(b,a,c,d,e,g,m,l,q,r){b-=gpe.CURRENT_VIEW_BOX.xPos;a-=gpe.CURRENT_VIEW_BOX.yPos;c-=gpe.CURRENT_VIEW_BOX.xPos;d-=gpe.CURRENT_VIEW_BOX.yPos;
e-=gpe.CURRENT_VIEW_BOX.xPos;g-=gpe.CURRENT_VIEW_BOX.yPos;gpe.GPE_Current_Context.beginPath();gpe.GPE_Current_Context.moveTo(b,a);gpe.GPE_Current_Context.lineTo(c,d);gpe.GPE_Current_Context.lineTo(e,g);gpe.GPE_Current_Context.closePath();l?("undefined"==typeof q&&(q=5),gpe.GPE_Current_Context.lineWidth=q,gpe.GPE_Current_Context.lineJoin="round",gpe.GPE_Current_Context.strokeStyle=m,gpe.GPE_Current_Context.stroke()):(gpe.GPE_Current_Context.fillStyle=m,gpe.GPE_Current_Context.fill())};this.render_wrapped_text=
function(b,a,c,d,e,g,m){if("undefined"!=typeof b&&0<d.length)if(0<=b&&b<gpe.rsm.rFonts.length){var f=gpe.rsm.rFonts[b];if(-1!=f){a-=gpe.CURRENT_VIEW_BOX.xPos;c-=gpe.CURRENT_VIEW_BOX.yPos;gpe.GPE_Current_Context.font=f.fontCanvasInfo;gpe.GPE_Current_Context.fillStyle=e;gpe.GPE_Current_Context.textBaseline="top";gpe.GPE_Current_Context.textAlign="left";b="";e=d.split(" ");for(f=0;f<e.length;f++){d=b+e[f]+" ";var h=gpe.GPE_Current_Context.measureText(d);h=h.width;h>g&&0<f?(gpe.GPE_Current_Context.fillText(b,
a,c),b=e[f]+" ",c+=m):b=d}gpe.GPE_Current_Context.fillText(b,a,c)}else console.log("Unable to render fontId ["+b+"].")}else console.log("FontId ["+b+"] out of range.");else console.log("Unable to render wrapped text ["+d+"] with font ["+b+"].")};this.save_data=function(b,a,c){"undefined"!==typeof Storage&&localStorage.setItem(b+"_"+a,c)};this.replace_background=function(b,a,c){GPR.replace_background(b,a,c)};this.replace_all_backgrounds=function(b,a){GPR.replace_all_backgrounds(b,a)};this.set_background=
function(b,a,c){GPR.replace_background(b,a,c)};this.setup_camera=function(b,a,c,d,e){GPR.setup_camera(b,a,c,d,e)};this.split_screen=function(b,a,c){return GPR.split_screen(b,a,c)};this.set_render_alpha=function(b){gpe.GPE_Current_Context.globalAlpha=0<b&&255>b?b/255:0==b?0:1};this.SuperString=function(){return function(b){this.lastAteString=this.lastAteInt=-1;this.str="";"string"==typeof b?(this.str=b,this.length=this.str.length):this.length=IS_NULL;this.j_str=function(){return this.str};this.js_str=
function(){return this.str};this.empty=function(){return 0==this.str.length?!0:!1};this.update_string=function(b){"string"==typeof b?(this.str=b,this.length=this.str.length):this.str=""};this.size=function(){return length}}}();this.SuperVector=function(){function b(){this.internalArray=[];this.vectorLength=0}b.prototype.assign=function(b,a){b<this.internalArray.length&&(this.internalArray[b]=a)};b.prototype.at=function(b){return b<this.vectorLength?this.internalArray[b]:-1};b.prototype.back=function(){return 0<
this.vectorLength?this.internalArray[this.vectorLength-1]:-1};b.prototype.clear=function(){this.internalArray.length=0};b.prototype.insert=function(b,a){this.internalArray.insert(b,a);this.vectorLength++};b.prototype.makeLowercase=function(){for(var b=0;b<this.vectorLength;b++)"string"===typeof this.internalArray[b]&&(this.internalArray[b]=this.internalArray[b].toLowerCase())};b.prototype.makeUppercase=function(){for(var b=0;b<this.vectorLength;b++)"string"===typeof this.internalArray[b]&&(this.internalArray[b]=
this.internalArray[b].toUpperCase())};b.prototype.floorValues=function(){for(var b=0;b<this.vectorLength;b++)"number"===typeof this.internalArray[b]&&(this.internalArray[b]|=0)};b.prototype.roundValues=function(){for(var b=0;b<this.vectorLength;b++)"number"===typeof this.internalArray[b]&&(this.internalArray[b]=Math.round(this.internalArray[b]))};b.prototype.roundByDecimals=function(b){b=Math.floor(b);if(0<=b){var a=Math.pow(10,b);for(var c=0;c<this.vectorLength;c++)"number"===typeof this.internalArray[c]&&
(this.internalArray[c]=Math.round(this.internalArray[c]/a)*a)}else for(c=0;c<this.length;c++)a=Math.pow(10,-1*b),"number"===typeof this[c]&&(this[c]=roundedBeforeDecimal+Math.round(this[c]*a)/a)};b.prototype.ceilValues=function(){for(var b=0;b<this.vectorLength;b++)"number"===typeof this.internalArray[b]&&(this.internalArray[b]=Math.ceil(this.internalArray[b]))};b.prototype.size=function(){return this.vectorLength};b.prototype.push_back=function(b){this.internalArray.push(b);this.vectorLength=this.internalArray.length};
b.prototype.pop_back=function(){var b=this.internalArray.pop();this.vectorLength=this.internalArray.length;return b};return b}();this.stop_all_audio=function(){for(var b=this.rsm.rAudio.length-1;0<=b;b--){var a=this.rsm.rAudio[b];-1!=a&&a.stop_audio()}};this.stop_audio_group=function(b){if("undefined"!=typeof b)for(var a=this.rsm.rAudio.length-1;0<=a;a--){var c=this.rsm.rAudio[a];-1!=c&&c.audioGroupName==b&&c.stop_audio()}};this.stop_audio=function(b){"undefined"!=typeof b&&0<=b&&b<this.rsm.rAudio.length&&
(b=this.rsm.rAudio[b|0],-1!=b&&b.stop_audio())};this.stop_all_video=function(){for(var b=this.rsm.rVideos.length-1;0<=b;b--){var a=this.rsm.rVideos[b];-1!=a&&a.stop_video()}};this.stop_video_group=function(b){if("undefined"!=typeof b)for(var a=this.rsm.rVideos.length-1;0<=a;a--){var c=this.rsm.rVideos[a];-1!=c&&c.videoGroupName==b&&c.stop_video()}};this.stop_last_video=function(){this.isPlayingVideo=!1};this.stop_video=function(b){"undefined"!=typeof b&&0<=b&&b<this.rsm.rVideos.length&&(b=this.rsm.rVideos[b|
0],-1!=b&&b.stop_video())};this.to_bool=function(b){if("undefined"!=typeof b)if("string"==typeof b){if("true"==b||"yes"==b||"1"==b)return!0}else if("number"==typeof b&&1==b)return!0;return!1};this.touches_object=function(b,a,c,d,e){return GPR.find_collision_rectangle(b,a,c,d,e)};this.touches_family=function(b,a,c,d,e){return GPR.touches_family(b,a,c,d,e)};this.handle_key_down=function(b){"undefined"==typeof b&&(b=window.event);gpe.inputController.handle_key_down(b)};this.handle_key_press=function(b){"undefined"==
typeof b&&(b=window.event);gpe.inputController.handle_key_press(b)};this.handle_key_up=function(b){"undefined"==typeof b&&(b=window.event);gpe.inputController.handle_key_up(b)};this.update_mouse_down=function(b){"undefined"==typeof b&&(b=window.event);gpe.inputController.handle_mouse_press(b)};this.update_game_mouse=function(b){"undefined"==typeof b&&console.log("undefined event for mouse....");var a=gpe.canvas.getBoundingClientRect();gpe.MOUSE_X=(b.clientX-a.left)/(a.right-a.left)*(gpe.canvas.width+
2);gpe.MOUSE_Y=(b.clientY-a.top)/(a.bottom-a.top)*(gpe.canvas.height+2);0==gpe.masterScaleX&&(gpe.masterScaleX=1);0==gpe.masterScaleY&&(gpe.masterScaleY=1);gpe.MOUSE_SCALED_X=1>=GPE.masterScaleX?1/gpe.masterScaleX*gpe.MOUSE_X:0!=GPE.MOUSE_X?gpe.MOUSE_X/gpe.masterScaleX:0;gpe.MOUSE_SCALED_Y=1>=GPE.masterScaleY?1/gpe.masterScaleY*gpe.MOUSE_Y:0!=GPE.MOUSE_Y?gpe.MOUSE_Y/gpe.masterScaleY:0;gpe.MOUSE_X=Math.round(gpe.MOUSE_X);gpe.MOUSE_Y=Math.round(gpe.MOUSE_Y)};this.reset_game_mouse=function(b){gpe.MOUSE_X=
0;gpe.MOUSE_Y=0;gpe.MOUSE_SCALED_X=0;gpe.MOUSE_SCALED_Y=0};this.update_mouse_down=function(b){"undefined"==typeof b&&(b=window.event);gpe.inputController.handle_mouse_press(b)};this.update_mouse_up=function(b){"undefined"==typeof b&&(b=window.event);gpe.inputController.handle_mouse_up(b)};this.video_loop=function(b){this.play_video(b,!0)};this.video_play=function(b,a){this.play_video(b,a)};this.video_playing=function(b){return this.is_video_playing(b)};this.video_stop_all=function(){this.stop_all_video()};
this.gameloop_logic=function(){-1!=gpe.rsm&&gpe.rsm.check_resources_state();-1!=gpe.inputController&&gpe.inputController.process_input();gpe.apply_plugins_logics();if(gpe.isPlayingVideo)if(0<=gpe.currentVideoPlaying&&gpe.currentVideoPlaying<gpe.rsm.rVideos.length){var b=gpe.rsm.rVideos[gpe.currentVideoPlaying];-1!=b?(gpe.videoPlayingIsSkippable&&(gpe.check_keyboard(gp_esc)||gpe.check_keyboard(gp_enter))&&(b.stop_video(),gpe.exit_video_view_mode()),b.process_playing_video()):gpe.exit_video_view_mode()}else gpe.exit_video_view_mode();
else if(0!=gpe.currentState){for(var a=gpe.rsm.rAudio.length-1;0<=a;a--)b=gpe.rsm.rAudio[a],-1!=b&&b.isBeingLooped&&-1!=b.html5AudioSource&&b.html5AudioSource.ended&&b.play_audio(!0);gpe.currentState.apply_logic()}-1!=gpe.inputController&&gpe.inputController.reset_input();gpe.apply_plugins_logics()};this.gameloop_render=function(){gpe.canvasIsEnabled&&(GPE_FPS_UNCAPPED||GPE_STANDARD_DELTA>GPE_STANDARD_INTERVAL)&&(gpe.OBJECT_RENDER_CHECKS=0,gpe.OBJECT_RENDER_CALLS=0,GPE_STANDARD_THEN=GPE_STANDARD_NOW-
GPE_STANDARD_DELTA%GPE_STANDARD_INTERVAL,gpe.enter_render())};this.gameloop=function(){GPE_STANDARD_NOW=Date.now();GPE_STANDARD_DELTA=GPE_STANDARD_NOW-GPE_STANDARD_THEN;gpe.gameloop_logic();if(y!=t.STATE_NULL){y!=t.STATE_EXIT&&(gpe.currentState=IS_NULL);switch(y){case t.STATE_LOGO_DISPLAY:gpe.currentState=new F;break;case t.STATE_LOAD_RESOURCES:gpe.currentState=new Q;break;case t.STATE_MAINMENU:gpe.currentState=new S;break;case t.STATE_MAINGAME:gpe.currentState=new J}GPR=gpe.currentState;E=y;y=t.STATE_NULL;
gpe.handle_canvas_size()}gpe.gameloop_render();window.requestAnimationFrame(gpe.gameloop)};this.colisionObjectLoops=this.collisionsCheckedCount=0}function u(){this.y2Pos=this.x2Pos=this.rectHeight=this.rectWidth=this.yMiddle=this.xCenter=this.yPos=this.xPos=0;this.add_x=function(e){this.xPos+=e;this.x2Pos+=e;this.xCenter+=e};this.add_y=function(e){this.yPos+=e;this.y2Pos+=e;this.yMiddle+=e};this.get_center=function(){return this.xCenter};this.get_height=function(){return this.rectHeight};this.get_middle=
function(){return this.yMiddle};this.get_width=function(){return this.rectWidth};this.get_x=function(){return this.xPos};this.get_x2=function(){return this.x2Pos};this.get_y=function(){return this.yPos};this.get_y2=function(){return this.y2Pos};this.set_x=function(e){this.xPos=e;this.x2Pos=this.xPos+this.rectWidth;this.xCenter=this.xPos+this.rectWidth/2};this.set_y=function(e){this.yPos=e;this.y2Pos=this.yPos+this.rectHeight;this.yMiddle=this.yPos+this.rectHeight/2};this.update_position=function(e,
a){this.xPos=e;this.yPos=a;this.x2Pos=this.xPos+this.rectWidth;this.y2Pos=this.yPos+this.rectHeight;this.xCenter=this.xPos+this.rectWidth/2;this.yMiddle=this.yPos+this.rectHeight/2};this.update_box=function(e,a,d,c){this.update_shape(e,a,d,c)};this.update_shape=function(e,a,d,c){"number"==typeof e&&"number"==typeof a&&"number"==typeof d&&"number"==typeof c&&(this.xPos=e,this.yPos=a,this.rectWidth=d,this.rectHeight=c,0>d&&(this.xPos=e-d,this.rectWidth=Math.abs(d),GPE_SETTINGS_IS_DEBUGGING&&console.log(this.rectWidth)),
0>c&&(this.yPos=a-c,this.rectHeight=Math.abs(c),GPE_SETTINGS_IS_DEBUGGING&&console.log(this.rectHeigh)),this.x2Pos=this.xPos+this.rectWidth,this.y2Pos=this.yPos+this.rectHeight,this.xCenter=this.xPos+this.rectWidth/2,this.yMiddle=this.yPos+this.rectHeight/2)};this.update_size=function(e,a){this.rectWidth=e;this.rectHeight=a;0>e&&(this.xPos=xNew-e,this.rectWidth=Math.abs(e));0>a&&(this.yPos=yNew-a,this.rectHeight=Math.abs(a));this.x2Pos=this.xPos+this.rectWidth;this.y2Pos=this.yPos+this.rectHeight;
this.xCenter=this.xPos+this.rectWidth/2;this.yMiddle=this.yPos+this.rectHeight/2}}function O(){this.imageObj;this.maxSpriteFrames=this.frameCount=0;this.spriteName="";this.gpeId=this.setId=-1;this.yOrg=this.xOrg=0;this.spriteHeight=this.spriteWidth=1;this.colY=this.colX=0;this.colRadius=this.colHeight=this.colWidth=1;this.imageHeight=this.imageWidth=this.colShape=0;this.frameRect=[];this.get_height=function(){return this.spriteHeight};this.get_width=function(){return this.spriteWidth};this.update_sprite_data=
function(e,a,d,c,g){this.imageWidth=e.naturalWidth;this.imageHeight=e.naturalHeight;GPE_SETTINGS_IS_DEBUGGING&&console.log("["+this.setId+"]Size: "+this.imageWidth+" , "+this.imageHeight+".");var b=0;this.spriteWidth=this.colWidth=c;this.spriteHeight=this.colHeight=g;this.frameCount=0;this.imageObj=e;var f,k;for(f=d;f<this.imageHeight;f+=g)for(k=a;k<this.imageWidth;k+=c)if(this.frameCount<this.maxSpriteFrames||0>=this.maxSpriteFrames){var h=new u;e=c;d=g;k+c>this.imageWidth&&(e=this.imageWidth-k);
f+g>this.imageHeight&&(d=this.imageHeight-d);h.update_shape(k,f,e,d);this.frameRect[b]=h;b+=1;this.frameCount+=1}};this.render_to_context=function(e,a,d,c,g,b){d-=gpe.CURRENT_VIEW_BOX.xPos;c-=gpe.CURRENT_VIEW_BOX.yPos;"undefined"==typeof g&&(g=1);"undefined"==typeof b&&(b=1);if(0<=a&&a<this.frameRect.length)if(a=this.frameRect[a|0],1==g&&1==b)e.drawImage(this.imageObj,a.get_x(),a.get_y(),a.rectWidth,a.rectHeight,d,c,a.rectWidth,a.rectHeight);else if(0>g||0>b){var f=1,k=1;0>g&&(g*=-1,f=-1);0>b&&(k=
-1,b*=-1);e.save();e.translate(d,c);d=a.rectWidth/2;c=a.rectHeight/2;e.translate(d,c);e.scale(f,k);e.drawImage(this.imageObj,a.get_x(),a.get_y(),a.rectWidth,a.rectHeight,-d,-c,a.rectWidth*g,a.rectHeight*b);e.restore()}else e.drawImage(this.imageObj,a.get_x(),a.get_y(),a.rectWidth,a.rectHeight,d*f,c*k,a.rectWidth*g,a.rectHeight*b)}}function P(){this.id=this.tex=IS_NULL;this.tAmountY=this.tAmountX=0;this.tHeight=this.tWidth=32;this.vSep=this.hSep=this.vOff=this.hOff=0;this.tileEndPos=this.tileStartPos=
1;this.tilesetIsProcessed=this.texIsLoaded=!1;this.load_tilesheet_texture=function(e,a){this.tex=gpe.rsm.load_new_texture(e,a)};this.pixel_from_xpos=function(e){return this.hOff+e*(this.tWidth+this.hSep)};this.pixel_from_ypos=function(e){return this.vOff+e*(this.tHeight+this.vSep)};this.get_xpos_at=function(e){var a=0;0<this.tAmountX&&e>=this.tAmountX&&0<e?a=this.hOff+Math.abs(e%this.tAmountX)*(this.tWidth+this.hSep):0<=e&&(a=this.hOff+e*(this.tWidth+this.hSep));return a};this.get_ypos_at=function(e){var a=
0;0!=this.tAmountX&&e>=this.tAmountX&&0<e?a=this.vOff+(e/this.tAmountX|0)*(this.tHeight+this.vSep):0==e&&(a=this.vOff);return a};this.get_tile_width=function(){return this.tWidth};this.get_tile_height=function(){return this.tHeight};this.update_tex_specs=function(){this.tAmountY=this.tAmountX=0;var e=this.hOff,a=this.vOff;this.tileEndPos=this.tileStartPos;if(-1!=this.tex){for(;e<this.tex.naturalWidth;)e+=this.tWidth+this.hSep,this.tAmountX+=1;for(;a<this.tex.naturalHeight;)a+=this.tHeight+this.vSep,
this.tAmountY+=1}this.tileEndPos+=this.tAmountX*this.tAmountY};this.init_tilesheet=function(){0==this.texIsLoaded&&-1!=this.tex&&(this.texIsLoaded=this.tex.check_texture_state());return this.texIsLoaded}}function G(){this.imageSource=IS_NULL;this.texHeight=this.texWid=0;this.name=this.fileLocation="";this.texId=IS_NULL;this.textureFailedToLoad=this.textureIsFullyLoaded=!1;this.get_id=function(){return texId};this.check_texture_state=function(){-1!=this.imageSource?0==this.textureIsFullyLoaded&&((this.textureIsFullyLoaded=
x(this.imageSource))?(this.texWid=this.imageSource.naturalWidth,this.texHeight=this.imageSource.naturalHeight):"failed"==this.imageSource.alt&&(this.texHeight=this.textWid=0,this.textureFailedToLoad=this.textureIsFullyLoaded=!0)):this.textureIsFullyLoaded=!1;return this.textureIsFullyLoaded};this.change_texture=function(e){this.imageSource=e};this.get_width=function(){return this.texWid};this.get_height=function(){return this.texHeight};this.render_tex=function(e,a,d){-1!=this.imageSource&&0==this.textureFailedToLoad&&
-1!=e&&this.textureIsFullyLoaded&&e.drawImage(this.imageSource,a,d)};this.render_tex_scaled=function(e,a,d,c,g){if(-1!=this.imageSource&&0==this.textureFailedToLoad&&-1!=e&&this.textureIsFullyLoaded)if(0<c&&0<g)e.drawImage(this.imageSource,a,d,c,g);else if(0>c||0>g){d=a=1;0>c&&(c*=-1,a=-1);0>scaleY&&(d=-1,g*=-1);e.save();e.translate(xOn,yOn);var b=c/2,f=g/2;e.translate(b,f);e.scale(a,d);e.drawImage(this.imageObj,-b,-f,c,g);e.restore()}};this.render_tex_clipped=function(e,a,d,c){-1!=this.imageSource&&
-1!=e&&this.textureIsFullyLoaded&&0==this.textureFailedToLoad&&"undefined"!=typeof c&&e.drawImage(this.imageSource,c.get_x(),c.get_y(),c.get_width(),c.get_height(),a,d,c.get_width(),c.get_height())}}function V(){this.backgroundTexture=IS_NULL;this.bgYSpeed=this.bgXSpeed=this.bgYOffset=this.bgXOffset=0;this.bgId=this.fileLocation=IS_NULL;this.bgColor="black";this.loopBGVert=this.loopBGHori=this.renderBgSpeed=!1;this.get_scene_background_color=function(){return this.bgColor};this.set_background=function(e){0<=
e&&e<gpe.rsm.rTextures.length?(e.bgId=e,e.backgroundTexture=gpe.rsm.rTextures[e]):(e.bgId=IS_NULL,e.backgroundTexture=IS_NULL)};this.set_background_color=function(e){this.bgColor=e};this.set_bgoffsets=function(e,a){this.bgXOffset=e;this.bgYOffset=a};this.set_bgspeed=function(e,a){this.bgXSpeed=e;this.bgYSpeed=a};this.scroll_bg=function(){-1!=this.backgroundTexture&&0==this.stretchBG&&(this.bgXOffset+=this.bgXSpeed,this.bgYOffset+=this.bgYSpeed,this.loopBGHori&&(this.bgXOffset<=-this.backgroundTexture.get_width()&&
(this.bgXOffset=0),this.bgXOffset>=this.backgroundTexture.get_width()&&(this.bgXOffset=0)),this.loopBGVert&&(this.bgYOffset<=-this.backgroundTexture.get_height()&&(this.bgYOffset=0),this.bgYOffset>=this.backgroundTexture.get_height()&&(this.bgYOffset=0)))};this.render_bg_speed=function(e,a,d,c,g){this.backgroundTexture.render_tex(d,1*e-c.xPos,1*a-c.yPos,1*this.backgroundTexture.get_width(),1*this.backgroundTexture.get_height())};this.render_bg=function(e,a,d,c,g){if(-1!=this.backgroundTexture&&this.backgroundTexture.textureIsFullyLoaded)if(this.loopBGHori)if(this.loopBGVert)for(var b=
this.bgXOffset-this.backgroundTexture.get_width();b<=c+this.backgroundTexture.get_width();b+=this.backgroundTexture.get_width())for(var f=this.bgYOffset-this.backgroundTexture.get_height();f<=g+this.backgroundTexture.get_height();f+=this.backgroundTexture.get_height())this.render_bg_speed(b,f,e,a,d);else for(b=this.bgXOffset-this.backgroundTexture.get_width();b<=c+this.bgXOffset+this.backgroundTexture.get_width();b+=this.backgroundTexture.get_width())this.render_bg_speed(b,this.bgYOffset,e,a,d);else if(this.loopBGVert)for(f=
this.bgYOffset-this.backgroundTexture.get_height();f<=g;f+=this.backgroundTexture.get_height())this.render_bg_speed(this.bgXOffset,f,e,a,d);else this.render_bg_speed(this.bgXOffset,this.bgYOffset,e,a,d)}}function W(){this.tileIdNumb=this.tset=IS_NULL;this.tSetPos=-1;this.yCoord=this.xCoord=0;this.tileLayer=-1;this.tileType=0;this.drewBefore=this.isSolid=!1;this.tileBox=new u;this.tileBox.update_shape(0,0,32,32);this.get_type=function(){return this.tileType};this.update_box=function(e,a,d,c){this.tileBox.update_shape(e,
a,d,c)};this.render_self=function(e,a){if(0<=this.tset&&this.tset<gpe.rsm.rTilesheets.length){var d=gpe.rsm.rTilesheets[this.tset];-1!=d&&(d=d.tex,-1!=d&&e.drawImage(d,this.tileBox.get_x(),this.tileBox.get_y(),this.tileBox.get_width(),this.tileBox.get_height(),this.xCoord-a.xPos,this.yCoord-a.yPos,this.tileBox.get_width(),this.tileBox.get_height()))}};this.render_self_auto=function(e){if(0<=this.tset&&this.tset<gpe.rsm.rTilesheets.length){var a=gpe.rsm.rTilesheets[this.tset];-1!=a&&(a=a.tex,e.drawImage(a,
this.tileBox.get_x(),this.tileBox.get_y(),this.tileBox.get_width(),this.tileBox.get_height(),this.xCoord,this.yCoord,this.tileBox.get_width(),this.tileBox.get_height()))}}}function X(e,a,d){this.spatialGridHeightSize=this.spatialGridWidthSize=this.spatialGridBoxSize=128;this.spatialGridHeightAmount=this.spatialGridWidthAmount=2;this.layerType=e;this.layerObjects=[];this.independentObjects=[];this.layerBackgrounds=[];this.scnStartBackgrounds=[];this.scnStartObjects=[];this.scnStartTiles=[];this.tileAmountY=
this.tileAmountX=IS_NULL;this.layerId=a;this.layerAlpha=d;this.layerName="";this.prevTileAmountY=this.prevTileAmountX=IS_NULL;this.layerTiles=[];this.collisionSpacesInView=[];this.spatialGridIsCreated=!1;this.spatialMapHeightSize=this.spatialMapWidthSize=0;this.COLLISION_AREA_SPACES=[];this.COLLISION_AREA_OUTSIDE_SCENE=new gpe.SuperSpatialPartition;this.superDebugCollisions=!1;this.objectCollisionIsChecked={};this.collisionPairA=[];this.collisionPairB=[];this.parsed_objects=this.collisionPairsTotal=
0;this.prerenderObjectRenderList=[];this.regularObjectRenderList=[];this.renderAboveObjectRenderList=[];this.renderHudObjectRenderList=[];this.set_default_grid_size=function(){this.spatialGridHeightSize=this.spatialGridWidthSize=this.spatialGridBoxSize=128};this.set_default_grid_size();this.spatialGridHeightAmount=this.spatialGridWidthAmount=2;this.spatialCollisionChecks=this.objectCollisionHashesChecked=0;this.spatialGridIsCreated=!1;this.spatialMapHeightSize=this.spatialMapWidthSize=-1;this.add_collision_pair=
function(a,d){this.collisionPairA[this.collisionPairsTotal]=a;this.collisionPairB[this.collisionPairsTotal]=d;this.collisionPairsTotal+=1};this.begin_spatialpartioning=function(a,d){if(this.spatialGridIsCreated&&this.spatialMapWidthSize==a&&this.spatialMapHeightSize==d)console.log("Not overwriting scene grid...");else if(this.COLLISION_AREA_OUTSIDE_SCENE.empty_list(),this.set_default_grid_size(),"undefined"!=typeof a&&"undefined"!=typeof d)if(this.COLLISION_AREA_SPACES.clear(),0<a&&0<d){this.spatialMapWidthSize=
a;this.spatialMapHeightSize=d;this.spatialGridWidthAmount=Math.ceil(a/this.spatialGridWidthSize);2>this.spatialGridWidthAmount&&(this.spatialGridWidthSize=a/2,this.spatialGridWidthAmount=2);this.spatialGridHeightAmount=Math.ceil(d/this.spatialGridHeightSize);2>this.spatialGridHeightAmount&&(this.spatialGridHeightSize=d/2,this.spatialGridHeightAmount=2);var b,c,e=0,g=0;for(b=0;b<this.spatialGridWidthAmount;b+=1){for(c=0;c<this.spatialGridHeightAmount;c+=1){var n=new gpe.SuperSpatialPartition;n.set_space(e,
g,this.spatialGridWidthSize,this.spatialGridHeightSize);g+=this.spatialGridHeightSize;n.spaceName+="testrun_"+b+"_"+c+"_test";this.COLLISION_AREA_SPACES.push_back(n)}g=0;e+=this.spatialGridWidthSize}this.spatialGridIsCreated=!0}else console.log("Negative dimensions given for spatial partitioning...");else console.log("Invalid dimensions given for spatial partitioning...")};this.begin_render=function(a){this.prerenderObjectRenderList=[];this.regularObjectRenderList=[];this.renderAboveObjectRenderList=
[];this.renderHudObjectRenderList=[];var c;for(jLoop=this.independentObjects.length-1;0<=jLoop;jLoop--){var b=this.independentObjects[jLoop];b.isInit&&b.isVisible&&!b.gpeIsBeingDestroyed&&(b.hasPreRenderFunction&&this.prerenderObjectRenderList.push(b),this.regularObjectRenderList.push(b),b.hasPostRenderFunction&&this.renderAboveObjectRenderList.push(b),b.hasHudRenderFunction&&this.renderHudObjectRenderList.push(b),b.gpeAddedToRenderList=!0)}var d=this.COLLISION_AREA_SPACES.size();for(jLoop=a.length-
1;0<=jLoop;jLoop--)if(foundCollisionSpaceId=a[jLoop],0<=foundCollisionSpaceId&&foundCollisionSpaceId<d)for(currentSpace=this.COLLISION_AREA_SPACES[foundCollisionSpaceId],c=currentSpace.internalArray.length-1;0<=c;c--)b=currentSpace.internalArray[c],!b.gpeAddedToRenderList&&b.isInit&&b.isVisible&&!b.gpeIsBeingDestroyed&&(b.hasPreRenderFunction&&this.prerenderObjectRenderList.push(b),this.regularObjectRenderList.push(b),b.hasPostRenderFunction&&this.renderAboveObjectRenderList.push(b),b.hasHudRenderFunction&&
this.renderHudObjectRenderList.push(b),b.gpeAddedToRenderList=!0)};this.get_tile_at=function(a,d){var b=a+d*this.tileAmountX;return 0<=b&&b<this.layerTiles.length?this.layerTiles[b]:IS_NULL};this.clear_dynamic_data=function(){this.independentObjects=[];this.layerObjects=[];this.layerBackgrounds=[];for(var a=this.COLLISION_AREA_SPACES.length-1;0<=a;a--)this.COLLISION_AREA_SPACES[a].empty_list();this.COLLISION_AREA_OUTSIDE_SCENE.empty_list()};this.create_new_map=function(a,d){this.tileAmountX=a;this.tileAmountY=
d;var b=this.tileAmountX*this.tileAmountY,c;this.layerTiles=[];for(c=0;c<b;c++)this.layerTiles[c]=new W,this.layerTiles[c].tileType=0};this.get_map_size=function(){return this.layerTiles.length};this.remove_object=function(a){for(var c,b=this.layerObjects.length-1;0<=b;b--)c=this.layerObjects[b],c.gpeUniqGameObjectId==a.gpeUniqGameObjectId&&this.layerObjects.splice(b,1)};this.find_spatial_at=function(a,d){var b=-1;0<=a&&0<=d&&(b=(a/this.spatialGridWidthSize|0)*this.spatialGridHeightAmount,b+=d/this.spatialGridHeightSize|
0,0>b||b>=this.COLLISION_AREA_SPACES.length)&&(b=-1);return b};this.render_objects=function(){var a;for(a=this.prerenderObjectRenderList.length-1;0<=a;a--){var d=this.prerenderObjectRenderList[a];d.render_under()}gpe.set_render_alpha(255);for(a=this.regularObjectRenderList.length-1;0<=a;a--)d=this.regularObjectRenderList[a],d.render_self();gpe.set_render_alpha(255);for(a=this.renderAboveObjectRenderList.length-1;0<=a;a--)d=this.renderAboveObjectRenderList[a],d.render_above();gpe.set_render_alpha(255)};
this.render_hud_objects=function(){var a;for(a=this.renderHudObjectRenderList.length-1;0<=a;a--){var d=this.renderHudObjectRenderList[a];d.render_hud()}};this.scroll_backgrounds=function(){for(var a=this.layerBackgrounds.length-1;0<=a;a--)-1!=this.layerBackgrounds[a]&&this.layerBackgrounds[a].scroll_bg()};this.replace_all_backgrounds=function(a,d){for(var b=this.layerBackgrounds.length;0<=b;b--)this.layerBackgrounds[b].bgId==a&&this.layerBackgrounds[b].set_background(d)};this.set_background=function(a,
d,b){0<=a&&a<this.layerBackgrounds.length&&this.layerBackgrounds[a].set_background(b)}}function Y(e,a,d,c,g){this.cameraRect=new u;this.cameraBoundaries=new u;this.cameraRect.update_shape(e,a,d,c);this.renderRect=new u;this.scaledRect=new u;this.scaledRect.update_shape(e,a,d,c);this.vertBorder=this.horiBorder=this.viewTarget=IS_NULL;this.vSpeed=this.hSpeed=0;this.isVisible=!1;this.cSceneHeight=this.cSceneWidth=this.maxYTilesInView=this.maxXTilesInView=0;this.center_camera=function(b,a){this.cameraRect.update_position(b-
this.cameraRect.rectWidth/2,a-this.cameraRect.rectHeight/2);this.cameraRect.get_x2()>this.cameraBoundaries.get_width()&&this.cameraRect.set_x(this.cameraBoundaries.get_width()-this.cameraRect.get_width());this.cameraRect.get_y2()>this.cameraBoundaries.get_height()&&this.cameraRect.set_y(this.cameraBoundaries.get_height()-this.cameraRect.get_height());0>this.cameraRect.get_x()&&this.cameraRect.set_x(0);0>this.cameraRect.get_y()&&this.cameraRect.set_y(0)};this.move_hori=function(b){0>b?this.cameraBoundaries.get_x()<
this.cameraRect.get_x()+b?this.cameraRect.add_x(b):this.cameraRect.set_x(0):this.cameraBoundaries.x2Pos>this.cameraRect.x2Pos+b&&this.cameraRect.add_x(b)};this.move_vert=function(b){0>b?this.cameraBoundaries.get_y()<this.cameraRect.get_y()+b?this.cameraRect.add_y(b):this.cameraRect.set_y(0):this.cameraBoundaries.y2Pos>this.cameraRect.y2Pos+b&&this.cameraRect.add_y(b)};this.setup_camera=function(b,a,c,d){this.isVisible=!0;console.log("Updaing Camera with ("+b+", "+a+", "+c+", "+d+") dimensions...");
this.renderRect.update_shape(b,a,c,d);this.cameraRect.update_shape(b,a,c,d)};this.update_tile_size=function(b,a){this.maxXTilesInView=b;this.maxYTilesInView=a};this.update_screen_space=function(b,a,c,d){this.renderRect.update_shape(b,a,c,d)};this.update_view_space=function(b,a,c,d){this.cameraRect.update_shape(b,a,c,d)}}function U(e,a){"number"!=typeof e&&(e=-1);"string"!=typeof a&&(a="");this.sceneName=a;this.sceneId=e;this.sceneHasBeenActivated=!1;this.sceneHeight=this.sceneWidth=1024;gpe.sceneWidth=
1024;gpe.sceneHeight=1024;this.sceneWasVisitedBefore=this.sceneIsContinuous=!1;this.defaultLayerName="game - layer";this.tileAmountY=this.tileAmountX=0;this.tileHeight=this.tileWidth=32;this.mapTextures=[];this.layerTilesheets=[];this.sceneObjects=[];this.persistentObjects=[];this.sceneLayers=[];this.scenesStartLayers=[];this.bgColor="aqua";this.endAudio=this.startAudio=this.bgMusic=this.sceneVersion=-1;this.BACKGROUNDS=[];this.sceneMapIn=IS_NULL;this.sceneIsSpatiallyPartitioned=this.sceneResourcesAreProcessed=
this.sceneIsProcessed=!1;this.sceneCamera=[];this.disable_camera=function(a){0<=a&&a<gpe.maxCameras&&(this.sceneCamera[a].isVisible=!1)};this.enable_camera=function(a){0<=a&&a<gpe.maxCameras&&(this.sceneCamera[a].update_view_space(0,0,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT),this.sceneCamera[a].update_screen_space(0,0,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT),this.sceneCamera[a].isVisible=!0)};this.reset_scene_meta=function(){this.sceneCamera=[];for(var a=0;a<gpe.maxCameras;a++)this.sceneCamera[a]=new Y(0,0,
gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT,a);this.sceneCamera[0].update_view_space(0,0,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT);this.sceneCamera[0].update_screen_space(0,0,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT);this.sceneCamera[0].isVisible=!0;this.sceneCamera[1].update_view_space(0,0,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT/2);this.sceneCamera[1].update_screen_space(0,gpe.SCREEN_HEIGHT/2,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT/2);this.sceneCamera[1].isVisible=!1;this.splitRenderMode=0;this.sceneCamera[2].update_view_space(0,
0,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT);this.sceneCamera[2].update_screen_space(0,gpe.SCREEN_HEIGHT/2,gpe.SCREEN_WIDTH/2,gpe.SCREEN_HEIGHT/2);this.sceneCamera[2].isVisible=!1;this.sceneCamera[3].update_view_space(0,0,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT);this.sceneCamera[3].update_screen_space(gpe.SCREEN_WIDTH/2,gpe.SCREEN_HEIGHT/2,gpe.SCREEN_WIDTH/2,gpe.SCREEN_HEIGHT/2);this.sceneHasBeenActivated=this.sceneIsSpatiallyPartitioned=this.sceneCamera[3].isVisible=!1};this.clear_layers_data=function(){for(var a,
c=this.sceneLayers.length-1;0<=c;c--)a=this.sceneLayers[c],-1!=a&&a.clear_dynamic_data()};this.reset_scene_meta();this.add_to_persistent_objects=function(a){if(-1!=a)for(var c=this.persistentObjects.length-1;0<=c;c--)if(this.persistentObjects[c].gpeUniqGameObjectId==a.gpeUniqGameObjectId)return!1;this.persistentObjects.push(a);return!0};this.find_layer=function(a,c){if(32>a&&0<=a)for(var d=this.sceneLayers.length-1;0<=d;d--){var b=this.sceneLayers[d];if(-1!=b&&b.layerId==a&&b.layerType==c)return b}return IS_NULL};
this.get_layer=function(a,c){if(32>a&&0<=a)for(var d=this.sceneLayers.length-1;0<=d;d--){var b=this.sceneLayers[d];if(-1!=b&&b.layerId==a)return b}return"number"==typeof a&&0<=a&&32>a?(console.log("Unable to find layer with ID["+a+"]"),this.add_layer(c,a,1)):IS_NULL};this.get_scene_width=function(){return this.sceneWidth};this.get_scene_height=function(){return this.sceneHeight};this.find_tile=function(a,c,e){c=Math.max(0,Math.min(this.sceneWidth-1,c/this.tileWidth|0));e=Math.max(0,Math.min(this.sceneHeight-
1,e/this.tileHeight|0));a=this.find_layer(a,GPE_LAYER_TYPE_TILES);return a!=IS_NULL&&(c=a.get_tile_at(c,e),c!=-IS_NULL)?c.tset:IS_NULL};this.find_tile_in_box=function(a,c,e,b,f){var d;c=Math.max(0,Math.min(this.sceneWidth-1,c/this.tileWidth|0));e=Math.max(0,Math.min(this.sceneHeight-1,e/this.tileHeight|0));b=Math.max(0,Math.min(this.sceneWidth-1,b/this.tileWidth|0));f=Math.max(0,Math.min(this.sceneHeight-1,f/this.tileHeight|0));a=this.find_layer(a,GPE_LAYER_TYPE_TILES);if(a!=IS_NULL)for(d=e;d<=f;d+=
1)for(e=c;e<=b;e+=1){var g=a.get_tile_at(e,d);if(g!=-IS_NULL)return g.tset}return IS_NULL};this.find_matching_tile=function(a,c,e,b){c=Math.max(0,Math.min(this.sceneWidth-1,c/this.tileWidth|0));e=Math.max(0,Math.min(this.sceneHeight-1,e/this.tileHeight|0));a=this.find_layer(a,GPE_LAYER_TYPE_TILES);return a!=IS_NULL&&(c=a.get_tile_at(c,e),c!=-IS_NULL&&c.tset==b)?!0:!1};this.find_matching_tile_in_box=function(a,c,e,b,f,k){var d;c=Math.max(0,Math.min(this.sceneWidth-1,c/this.tileWidth|0));e=Math.max(0,
Math.min(this.sceneHeight-1,e/this.tileHeight|0));b=Math.max(0,Math.min(this.sceneWidth-1,b/this.tileWidth|0));f=Math.max(0,Math.min(this.sceneHeight-1,f/this.tileHeight|0));a=this.find_layer(a,GPE_LAYER_TYPE_TILES);if(a!=IS_NULL)for(d=e;d<=f;d+=1)for(e=c;e<=b;e+=1){var g=a.get_tile_at(e,d);if(g!=-IS_NULL&&g.tset==k)return!0}return!1};this.scene_is_ready=function(){return this.sceneResourcesAreProcessed&&this.sceneIsProcessed?!0:!1};this.scene_init=function(){this.sceneIsSpatiallyPartitioned=!1;var a=
0,c=0,e=0,b=0,f=IS_NULL;GPE_SETTINGS_IS_DEBUGGING&&console.log("Adding ["+GPR.GAME_OBJECTS_CONTINUOUS.length+"] continuous objects to scene #"+this.sceneIdNumber+".");try{for(a=0;a<GPR.GAME_OBJECTS_CONTINUOUS.length;a++)GPR.GAME_OBJECTS_CONTINUOUS[a].SPATIAL_PARTITION_LIST=[],GPR.add_object(GPR.GAME_OBJECTS_CONTINUOUS[a],!0,GPR.GAME_OBJECTS_CONTINUOUS[a].sceneLayerStartPos)}catch(l){alert(l)}GPR.GAME_OBJECTS_CONTINUOUS=[];if(this.sceneWasVisitedBefore&&this.sceneIsContinuous)for(GPE_SETTINGS_IS_DEBUGGING&&
console.log("Adding ["+this.persistentObjects.length+"] persistant objects to scene #"+this.sceneIdNumber+"."),a=0;a<this.persistentObjects.length;a++)this.persistentObjects[a].SPATIAL_PARTITION_LIST=[],GPR.add_object(this.persistentObjects[a],!0,GPR.GAME_OBJECTS_CONTINUOUS[a].sceneLayerStartPos);if(0==this.sceneWasVisitedBefore||0==this.sceneIsContinuous){var k=this.sceneLayers.length;console.log("Updating ["+k+"] layers for scene init...");for(a=0;a<k;a++){var h=this.sceneLayers[a];if(h!=IS_NULL){if(h.layerType==
GPE_LAYER_TYPE_TILES)for(c=0;c<h.scnStartTiles.length;c++){var n=h.scnStartTiles[c];if(-1!=n&&0<=n.tileNumber&&n.tileNumber<h.layerTiles.length){var p=h.layerTiles[n.tileNumber];if(0<=n.tileSheetId&&n.tileSheetId<gpe.rsm.rTilesheets.length){var m=gpe.rsm.rTilesheets[n.tileSheetId];p.tset=n.tileSheetId;p.tileIdNumb=n.tileIndexId;-1!=m&&p.tileBox.update_box(m.get_xpos_at(n.tileIndexId),m.get_ypos_at(n.tileIndexId),m.get_tile_width(),m.get_tile_height())}}}else if(h.layerType==GPE_LAYER_TYPE_BACKGROUND)for(c=
0;c<h.scnStartBackgrounds.length;c++)m=h.scnStartBackgrounds[c],-1!=m&&(p=new V,p.set_background(m.bgTexId),p.bgXOffset=m.bgXPos,p.bgYOffset=m.bgYPos,p.set_bgspeed(m.bgXSpeed,m.bgYSpeed),p.loopBGHori=m.bgTileHori,p.loopBGVert=m.bgTileVert,p.stretchBG=m.bgStartStretch,h.layerBackgrounds.push(p));if(!(h.layerType!=GPE_LAYER_TYPE_OBJECTS||this.sceneWasVisitedBefore&&this.sceneIsContinuous))for(GPE_SETTINGS_IS_DEBUGGING&&console.log("Adding ["+h.scnStartObjects.length+"] regular objects to scene #"+this.sceneIdNumber+
"."),c=0;c<h.scnStartObjects.length;c++)try{f=gpe.add_new_object(h.scnStartObjects[c].objId,h.scnStartObjects[c].xPos,h.scnStartObjects[c].yPos,h.layerId),f.customComponents=h.scnStartObjects[c].customComponents,f.layerOrigID=h.layerId,f.sceneLayerPos=h.layerId,f.layerOrigName=h.layerId}catch(l){alert(l)}}}}try{for(a=GPR.GAME_OBJECTS.length-1;0<=a;a--)for(e=GPR.GAME_OBJECTS[a],c=e.length-1;0<=c;c--)b=e[c],0==b.gpeIsBeingDestroyed&&0==b.gpeSceneStartCodeUsed&&(b.scene_start(),b.gpeSceneStartCodeUsed=
!0)}catch(l){alert(l)}this.sceneWasVisitedBefore=this.sceneHasBeenActivated=!0};this.update_scene_specs=function(a,c){a=Math.abs(a);c=Math.abs(c);this.cSceneWidth=a;this.cSceneHeight=c;gpe.sceneWidth=a;gpe.sceneHeight=c;for(var d=gpe.maxCameras-1;0<=d;d--)this.sceneCamera[d].cameraBoundaries.update_shape(0,0,a,c)};this.update_tilemap=function(){this.sceneWidth=0<this.tileAmountX&&0<this.tileWidth?this.tileAmountX*this.tileWidth:0;this.sceneHeight=0<this.tileAmountY&&0<this.tileHeight?this.tileAmountY*
this.tileHeight:0;gpe.sceneWidth=this.sceneWidth;gpe.sceneHeight=this.sceneHeight;for(var a,c,e,b,f=0;f<this.sceneLayers.length;f++)if(c=this.sceneLayers[f],-1!=c&&c.layerType==GPE_LAYER_TYPE_TILES)for(e=0;e<this.tileAmountY;e++)for(b=0;b<this.tileAmountX;b++)a=c.get_tile_at(b,e),"undefined"!=typeof a&&(a.yCoord=e*this.tileHeight,a.xCoord=b*this.tileWidth,a.tileType=0);for(a=gpe.maxCameras-1;0<=a;a--)this.sceneCamera[a].cameraBoundaries.update_shape(0,0,this.sceneWidth,this.sceneHeight)};this.add_background=
function(a,c,e,b,f,k,h){a=new sceneBackground(a,b,f);a.set_bgspeed(k,h);a.loopBGHori=c;a.loopBGVert=e;this.BACKGROUNDS.push(a)};this.replace_background=function(a,c,e){0<=a&&a<this.sceneLayers.length&&this.sceneLayers[a].replace_all_backgrounds(c,e)};this.replace_all_backgrounds=function(a,c){for(var d=this.sceneLayers.length;0<=d;d--)this.sceneLayers[d].replace_all_backgrounds(a,c)};this.set_background=function(a,c,e){0<=a&&a<this.sceneLayers.length&&this.sceneLayers[a].currentScene.set_background(c,
e)};this.add_layer=function(a,c,e){if("number"==typeof c&&0<=c&&32>c){var b=new X(a,c,e);b.layerType=a;b.layerId=c;b.layerAlpha=e;a==GPE_LAYER_TYPE_TILES&&b.create_new_map(this.tileAmountX,this.tileAmountY);this.sceneLayers.push(b);return b}return IS_NULL};this.add_start_layer=function(a,c,e){var b=this.add_layer(a,c,e);b!=IS_NULL&&this.scenesStartLayers.push({lType:a,lId:c,lAlpha:e});return b};this.get_twsize=function(){return this.tileWidth};this.get_thsize=function(){return this.tileHeight};this.get_map_width=
function(){return this.tileAmountX};this.get_map_height=function(){return this.tileAmountY};this.apply_logic=function(){};this.apply_postlogic=function(){};this.get_scene_name=function(){return 0<this.sceneName.length?sceneName:""};this.set_scene_name=function(a){0<a.length&&(this.sceneName=a)};this.change_background=function(a,c){this.BACKGROUNDS.size()>=c&&-1!=this.BACKGROUNDS.at(c)&&this.BACKGROUNDS.at(c).set_background(a)};this.change_foreground=function(a,c){this.FOREGROUNDS.size()>=c&&-1!=this.FOREGROUNDS.at(c)&&
this.FOREGROUNDS.at(c).set_background(a)};this.snap_xto_grid=function(a){return a/this.tileWidth>this.tAmountX?this.tAmountX:Math.max(0,a/this.tileWidth|0)};this.snap_yto_grid=function(a){return a/this.tileHeight>this.tAmountY?this.tAmountY:Math.max(0,a/this.tileHeight|0)};this.load_game_scene=function(a){this.sceneVersion=-1;this.sceneMapIn=gpe.fileReader.open_file("gamedata/"+a+".js")};this.load_and_parse_scene=function(){this.sceneIsProcessed=!0};this.process_scene=function(){0==this.sceneIsProcessed&&
this.load_and_parse_scene();if(0==this.sceneResourcesAreProcessed&&1==this.sceneHasBeenActivated)gpe.mapCanvas.width=this.sceneWidth,gpe.mapCanvas.height=this.sceneHeight,gpe.mapContext=gpe.mapCanvas.getContext("2d"),gpe.GPE_Current_Context=gpe.preGuiContext=gpe.preGuiCanvas.getContext("2d",{antialias:"2x",stencil:!1,format:"rgba8888",graphicsMemory:!0,dirty:!0}),(new u).update_shape(0,0,this.sceneWidth,this.sceneHeight),this.sceneResourcesAreProcessed=!0;else for(var a,c=this.sceneLayers.length-
1;0<=c;c--)a=this.sceneLayers[c],a.scroll_backgrounds();return!0};this.render_background_color=function(a,c){};this.render_backgrounds=function(a,c,e){if("undefined"!=typeof c)for(var b=0;b<this.BACKGROUNDS.size();b++)-1!=this.BACKGROUNDS.at(b)&&this.BACKGROUNDS.at(b).render_bg(a,c,e,this.sceneWidth,this.sceneHeight)};this.render_foregrounds=function(a,c){for(var d=0;d<this.FOREGROUNDS.size();d++)-1!=this.FOREGROUNDS.at(d)&&this.FOREGROUNDS.at(d).render_bg(a,c,this.sceneWidth,this.sceneHeight)};this.render_scene=
function(a,c){gpe.GPE_Current_Context=a;if(this.sceneResourcesAreProcessed&&this.sceneIsProcessed){var d,b,e,k,h=a;for(d=0;d<this.sceneCamera.length;d++){var n=this.sceneCamera[d];n.isVisible&&1}GPE.currentCameraInView=0;n=c.collisionSpacesInView;gpe.render_calls=0;for(d=this.sceneLayers.length-1;0<=d;d--){var p=this.sceneLayers.at(d);-1!=p&&p.begin_render(n)}jXTempTo=iYTempTo=jXTempFrom=iYTempFrom=0;for(d=this.sceneCamera.length-1;0<=d;d--)if(GPE.currentCameraInView=d,n=this.sceneCamera[d],n.isVisible){a=
gpe.GPE_Current_Context=gpe.EXTRA_CONTEXTS[d];a.fillStyle=this.bgColor;gpe.set_render_alpha(255);a.fillRect(0,0,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT);iYTempFrom=n.cameraRect.get_y();jXTempFrom=n.cameraRect.get_x();iYTempTo=n.cameraRect.get_y()+n.cameraRect.get_height();jXTempTo=n.cameraRect.get_x()+n.cameraRect.get_width();gpe.CURRENT_VIEW=n;gpe.CURRENT_VIEW_BOX=n.cameraRect;for(b=0;b<this.sceneLayers.length;b++)if(p=this.sceneLayers.at(b),-1!=p){if(p.layerType==GPE_LAYER_TYPE_TILES){if(0<this.tileWidth&&
0<this.tileHeight)for(jXTempFrom=jXTempFrom/this.tileWidth|0,iYTempFrom=iYTempFrom/this.tileHeight|0,jXTempTo=(jXTempTo+this.tileWidth)/this.tileWidth|0,iYTempTo=(iYTempTo+this.tileHeight)/this.tileHeight|0,e=iYTempFrom;e<iYTempTo;e++)for(k=jXTempFrom;k<jXTempTo;k++){var m=p.get_tile_at(k,e);"undefined"!=typeof m&&-1!=m&&m.render_self(a,n.cameraRect)}}else if(p.layerType==GPE_LAYER_TYPE_BACKGROUND&&0<p.layerBackgrounds.length)for(e=0;e<p.layerBackgrounds.length;e++)p.layerBackgrounds[e].render_bg(a,
n.cameraRect,n.cameraRect,this.sceneWidth,this.sceneHeight);p.render_objects()}gpe.CURRENT_VIEW_BOX.xPos=0;for(b=gpe.CURRENT_VIEW_BOX.yPos=0;b<this.sceneLayers.length;b++)p=this.sceneLayers.at(b),-1!=p&&p.render_hud_objects();"undefined"!=typeof h&&h.drawImage(gpe.EXTRA_CANVASES[d],n.renderRect.get_x(),n.renderRect.get_y(),n.renderRect.get_width(),n.renderRect.get_height())}GPE.currentCameraInView=0;this.splitRenderMode+=1;a=h;a.font="bold 16pt Calibri";a.textAlign="right";a.fillStyle="#000";if(GPE_SETTINGS_IS_DEBUGGING){for(d=
0;d<this.sceneCamera.length;d++)if(GPE.currentCameraInView=d,n=this.sceneCamera[d],n.isVisible)for(p=c.COLLISION_AREA_SPACES.length-1;-0<=p;p--)m=c.COLLISION_AREA_SPACES[p],m=m.boxArea,h.beginPath(),h.rect(m.get_x()-n.cameraRect.get_x(),m.get_y()-n.cameraRect.get_y(),m.get_width(),m.get_height()),h.lineWidth=1,0<=GPR.collisionSpacesInView.indexOf(p)?h.strokeStyle="red":h.strokeStyle="blue",h.stroke(),h.font="bold 16pt Calibri",h.textAlign="center",h.fillStyle="blue",h.fillText(p,m.get_x()-n.cameraRect.get_x()+
32,m.get_y()-n.cameraRect.get_y()+32);a.font="bold 16pt Calibri";a.textAlign="left";a.fillStyle="maroon";a.fillText("Scene Info || Version: "+this.sceneVersion+" | "+this.sceneWidth+" | "+this.sceneHeight,32,300);a.fillText("Collision Grids: "+c.COLLISION_AREA_SPACES.length+" ("+c.spatialGridWidthAmount+" X "+c.spatialGridHeightAmount+") for "+c.OBJECT_COUNT+" objects",32,364);a.textAlign="left";a.fillText("Scene Name: "+this.sceneName,32,gpe.SCREEN2_HEIGHT-64)}}else gpe.context.fillStyle=this.bgColor,
gpe.context.fillRect(0,0,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT)}}var C=0,v=0,z=GPE_PreloadImageResource.length,B=window.location;B=""+B;B=B.substring(0,B.lastIndexOf("/"));var t={STATE_NULL:0,STATE_LOAD_RESOURCES:1,STATE_LOGO_DISPLAY:2,STATE_INTRO:3,STATE_TITLE:4,STATE_MAINMENU:5,STATE_GAME_LOADING:6,STATE_MAINGAME:7,STATE_LEVEL_EDITOR:8,STATE_CREDITS:9,STATE_CUTSCENE:10,STATE_FLASHBACK:11,STATE_OPTIONS:12,STATE_EXIT:13},y=0,E;y=t.STATE_NULL;window.onload=function(){gpe=GPE=new T(GPE_SETTINGS_SCREEN_WIDTH,
GPE_SETTINGS_SCREEN_HEIGHT,854,480,GPE_SETTINGS_SYSTEM_OS);gpe.canvas=document.getElementById("gpeCanvas");gpe.masterScaleX=1;gpe.masterScaleY=1;window.addEventListener("resize",gpe.handle_canvas_size,!0);document.addEventListener("keydown",gpe.handle_key_down,!1);document.addEventListener("keypress",gpe.handle_key_press,!1);document.addEventListener("keyup",gpe.handle_key_up,!1);gpe.canvas.addEventListener("mousedown",gpe.update_mouse_down,!1);gpe.canvas.addEventListener("mouseup",gpe.update_mouse_up,
!1);gpe.canvas.addEventListener("mousemove",gpe.update_game_mouse,!1);gpe.canvas.addEventListener("mouseout",gpe.reset_game_mouse,!1);gpe.canvas.addEventListener("mouseleave",gpe.reset_game_mouse,!1);gpe.context=gpe.canvas.getContext("2d",{antialias:"2x",stencil:!1,format:"rgba8888",graphicsMemory:!0,dirty:!0});gpe.GPE_Current_Context=gpe.context;gpe.context.rect(0,0,gpe.context.width,gpe.context.height);gpe.context.save();gpe.inputController=new I;gpe.rsm=new N;for(var e=0;e<gpe.maxCameras;e++)gpe.EXTRA_CANVASES[e]=
gpe.add_canvas("exCamera"+e,gpe.SCREEN_WIDTH,gpe.SCREEN_HEIGHT),gpe.EXTRA_CANVASES[e].style.visibility="hidden",gpe.EXTRA_CANVASES[e].style.display="none",gpe.EXTRA_CONTEXTS[e]=gpe.EXTRA_CANVASES[e].getContext("2d",{antialias:"2x",stencil:!1,format:"rgba8888",graphicsMemory:!0,dirty:!0});gpe.mapCanvas=gpe.add_canvas("gameMap",GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT);gpe.mapCanvas.className="hide";gpe.preGuiCanvas=gpe.add_canvas("preGuiCanvas",GPE_SETTINGS_SCREEN_WIDTH,GPE_SETTINGS_SCREEN_HEIGHT);
gpe.preGuiCanvas.className="hide";gpe.fileReader=new A;E=t.STATE_LOGO_DISPLAY;gpe.currentState=new F;GPR=gpe.currentState;gpe.handle_canvas_size();window.requestAnimationFrame(gpe.gameloop)};window.countFPS=function(){var e=(new Date).getMilliseconds(),a=1,d=0;return function(){var c=(new Date).getMilliseconds();e>c?(d=a,a=1):a+=1;e=c;return d}}()})();